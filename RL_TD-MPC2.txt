Can you run the following experiment using synthetic data? I will bring my own data later.


1. Data Pre-processing / preparation:
40 surgical videos
40 outcomes: survival time in weeks after the surgery.
100 possible actions classes per frame in the video.
1024 as the pre-extracted frame embeddings.
1-5: risk scores associated to each frame calculated based on prior knowledge from expert surgeons.

2. Pre-training:
train a gpt2 model to predict the next frame embeddings autogregressively in a causal manner using teacher forcing (z_t predicts z_t+1).

3. Train a Reward prediction model that estimates the outcome of the surgery (the survival value) at each frame embedding z_t.

4. Estimate the difference between the expected reward model at time t with z_t-c_a:t embeddings and the next expected reward value with the concatencated future generated frame embeddings z_t+1:t+la


5. Use RL if necessary e.g. TD-MPC2:

with:
- l_a: anticipation length
- c_a: context length



