{
  "experiment_name": "2025-07-04_16-37-57",
  "config": {
    "debug": false,
    "experiment": {
      "train": {
        "max_videos": 40
      },
      "test": {
        "max_videos": 1,
        "test_on_train": false
      },
      "autoregressive_il": {
        "enabled": true,
        "train": false,
        "evaluate": true,
        "visualization": true,
        "model_type_preference": "combined",
        "save_all_best_models": true,
        "il_model_path": "best_checkpoints/autoregressive_il_best_combined_epoch_8.pt",
        "ivt_saving": {
          "enabled": true,
          "current_weight": 0.4,
          "next_weight": 0.6,
          "save_frequency": 1,
          "keep_top_k": 3
        },
        "evaluation_model": "combined",
        "recognition": {
          "enabled": false,
          "ivt_map": 36.1
        }
      },
      "world_model": {
        "enabled": false,
        "wm_model_path": "results/fixed_rl_2025-06-13_19-22-25/logs/checkpoints/world_model_best_epoch_1.pt"
      },
      "rl_experiments": {
        "enabled": false,
        "eval_episodes": 10
      },
      "irl_enhancement": {
        "enabled": false,
        "train": false,
        "evaluate": true,
        "irl_model_path": null,
        "num_epochs": 25,
        "task_focus": "next_action_prediction",
        "match_il_temporal_structure": true,
        "scenarios_to_train": [
          "high_complexity",
          "rare_actions",
          "critical_moments",
          "phase_transitions"
        ],
        "policy_adjustment": {
          "num_epochs": 15
        },
        "learning_rate": "5e-5",
        "early_stopping": {
          "patience": 5,
          "min_delta": 0.001
        },
        "maxent_irl": {
          "num_iterations": 10,
          "learning_rate": "5e-5"
        },
        "lightweight_gail": {
          "num_epochs": 5,
          "learning_rate": "1e-4",
          "adjustment_strength": 0.1
        },
        "evaluation": {
          "min_improvement_threshold": 0.02
        }
      }
    },
    "training": {
      "epochs": 15,
      "batch_size": 16,
      "learning_rate": "8e-5",
      "log_every_n_steps": 20,
      "optimizer_type": "adamw",
      "weight_decay": 0.025,
      "gradient_clip_val": 0.8,
      "scheduler": {
        "type": "cosine_with_warmup",
        "warmup_epochs": 3,
        "eta_min": "8e-6"
      },
      "parameter_groups": {
        "bilstm_recognition": {
          "lr_multiplier": 1.0,
          "weight_decay_multiplier": 0.3
        },
        "gpt2_backbone": {
          "lr_multiplier": 0.3,
          "weight_decay_multiplier": 0.8
        },
        "frame_processing": {
          "lr_multiplier": 0.5,
          "weight_decay_multiplier": 1.5
        },
        "action_prediction": {
          "lr_multiplier": 1.5,
          "weight_decay_multiplier": 0.2
        },
        "auxiliary_heads": {
          "lr_multiplier": 0.8,
          "weight_decay_multiplier": 1.0
        }
      },
      "lr_monitoring": {
        "track_gradients": true,
        "track_parameters": true,
        "log_frequency": 50,
        "save_plots": true,
        "generate_recommendations": true
      },
      "augmentation": {
        "temporal_crop_ratio": 0.85,
        "temporal_jitter_std": 0.02,
        "sequence_shuffle_prob": 0.1,
        "frame_dropout_prob": 0.05
      },
      "early_stopping": {
        "patience": 8,
        "min_delta": 0.001,
        "monitor": "ivt_next_mAP",
        "mode": "max"
      },
      "monitor_ivt_metrics": true,
      "log_ivt_components": true,
      "tensorboard_ivt_tracking": true,
      "num_workers": 2,
      "pin_memory": true,
      "log_dir": "logs",
      "checkpoint_dir": "checkpoints",
      "eval_epoch_interval": 1,
      "save_model": true,
      "checkpointing": {
        "save_best_only": false,
        "save_top_k": 5,
        "monitor": "ivt_next_mAP",
        "mode": "max",
        "save_every_n_epochs": 5,
        "save_ivt_milestones": true,
        "ivt_milestones": [
          0.34,
          0.35,
          0.36,
          0.37
        ]
      },
      "min_current_map_threshold": 0.34,
      "min_next_map_threshold": 0.34,
      "min_combined_threshold": 0.34
    },
    "evaluation": {
      "prediction_horizon": 8,
      "comprehensive_evaluation": {
        "per_video_analysis": true,
        "statistical_significance": true,
        "confidence_intervals": true,
        "baseline_comparison": 36.1,
        "evaluate_ivt_components": true,
        "ivt_video_wise": true,
        "report_both_tasks": true
      },
      "supervised": {
        "action_prediction": true
      },
      "rl": {
        "rollout_horizon": 15,
        "use_best_actions": true
      },
      "comparison": {
        "statistical_tests": true,
        "effect_size_threshold": 0.15,
        "compare_all_saved_models": true
      },
      "planning_evaluation": {
        "enabled": true,
        "planning_horizons": [
          1,
          2,
          3,
          5,
          10,
          20
        ],
        "use_best_next_model": true
      },
      "world_model": {
        "use_memory": false,
        "overall_horizon": 1
      }
    },
    "visualization": {
      "enhanced_planning_analysis": true,
      "simple_planning_analysis": true,
      "sparsity_analysis": true,
      "qualitative_evaluation": true
    },
    "rl_training": {
      "action_space_type": "continuous",
      "outcome_based_rewards": true,
      "rl_horizon": 30,
      "reward_mode": "dense",
      "normalize_rewards": true,
      "early_termination": true,
      "timesteps": 50000,
      "reward_weights": {
        "expert_matching": 10.0,
        "action_sparsity": 1.0,
        "world_model_rewards": 0.5,
        "completion_bonus": 5.0,
        "consistency_bonus": 1.0,
        "phase_completion": 1.0,
        "risk_penalty": -0.5
      },
      "ppo": {
        "learning_rate": "5e-5",
        "n_steps": 512,
        "batch_size": 64,
        "n_epochs": 10,
        "gamma": 0.95,
        "gae_lambda": 0.9,
        "clip_range": 0.1,
        "ent_coef": 0.05,
        "vf_coef": 0.5,
        "max_grad_norm": 0.5
      },
      "a2c": {
        "learning_rate": "1e-4",
        "n_steps": 32,
        "gamma": 0.95,
        "gae_lambda": 0.9,
        "ent_coef": 0.05,
        "vf_coef": 0.25,
        "max_grad_norm": 0.5
      }
    },
    "data": {
      "context_length": 20,
      "future_length": 20,
      "train_shift": 1,
      "padding_value": 0.0,
      "max_horizon": 20,
      "normalize_embeddings": true,
      "embedding_noise": 0.01,
      "ivt_evaluation_mode": true,
      "preserve_video_structure": true,
      "paths": {
        "data_dir": "/home/maxboels/datasets/CholecT50",
        "class_labels_file_path": "./data/labels.json",
        "fold": 0,
        "metadata_file": "embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv",
        "video_global_outcome_file": "embeddings_f1_swin_bas_129_with_enhanced_global_metrics.csv"
      },
      "frame_risk_agg": "max"
    },
    "training_mode": "rl",
    "preprocess": {
      "extract_rewards": false,
      "analyze_rewards": false,
      "rewards": {
        "grounded": {
          "phase_completion": true,
          "phase_transition": true,
          "phase_progression": true,
          "global_progression": true
        },
        "imitation": {
          "action_distribution": true
        },
        "expert_knowledge": {
          "risk_score": true,
          "frame_risk_agg": "max"
        }
      }
    },
    "models": {
      "autoregressive_il": {
        "hidden_dim": 384,
        "embedding_dim": 1024,
        "n_layer": 3,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.3,
        "max_length": 256,
        "layer_dropout": 0.15,
        "attention_dropout": 0.2,
        "frame_projection_dropout": 0.2,
        "bilstm_layers": 1,
        "bilstm_dropout": 0.25,
        "bilstm_bidirectional": true,
        "current_task_weight": 2.0,
        "next_task_weight": 1.5,
        "consistency_weight": 0.1
      },
      "conditional_world_model": {
        "hidden_dim": 512,
        "embedding_dim": 1024,
        "action_embedding_dim": 128,
        "n_layer": 4,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.1,
        "max_sequence_length": 512
      }
    },
    "loss_weights": {
      "recognition": 2.0,
      "generation": 1.5,
      "frame_reconstruction": 0.2,
      "phase_prediction": 0.5,
      "consistency": 0.1
    },
    "fair_evaluation": {
      "enabled": true,
      "include_traditional_metrics": true,
      "include_clinical_metrics": true,
      "per_video_analysis": {
        "enabled": true,
        "save_individual_results": true,
        "statistical_aggregation": true,
        "baseline_comparison": 36.1
      },
      "clinical_outcome_weights": {
        "phase_progression": 2.0,
        "innovation": 0.5
      }
    },
    "supervised_learning": {
      "data_augmentation": true
    },
    "research_comparison": {
      "methods": [
        "autoregressive_il",
        "conditional_world_model",
        "direct_video_rl"
      ]
    },
    "advanced": {
      "mixed_precision": false
    },
    "hardware": {
      "persistent_workers": false,
      "mixed_precision": false
    },
    "rl_debugging": {
      "enabled": true,
      "save_training_curves": true,
      "monitor_expert_matching": true,
      "log_action_distributions": true,
      "convergence_analysis": true,
      "episode_log_frequency": 10,
      "eval_frequency": 1000,
      "reward_improvement_threshold": 0.1,
      "expert_matching_threshold": 0.5,
      "debug_dir": "rl_debug",
      "plot_dir": "rl_plots"
    },
    "il_debugging": {
      "enabled": true,
      "convergence_tracking": {
        "early_plateau_detection": true,
        "overfitting_detection": true,
        "feature_utilization_analysis": true
      },
      "baseline_comparison": {
        "swin_recognition_mAP": 36.1,
        "improvement_threshold": 1.0
      },
      "temporal_evaluation": {
        "short_term_prediction": true,
        "medium_term_prediction": true,
        "temporal_consistency": true,
        "sequence_modeling_analysis": true
      }
    },
    "logging": {
      "level": "INFO",
      "log_ivt_details": true,
      "save_ivt_plots": true,
      "ivt_component_analysis": true,
      "log_best_scores": true,
      "log_model_saves": true
    },
    "il_performance_targets": {
      "current_recognition_mAP_target": 35.0,
      "current_recognition_minimum": 30.0,
      "next_prediction_mAP_target": 32.0,
      "next_prediction_minimum": 25.0,
      "combined_score_target": 33.0,
      "improvement_over_baseline": 2.0,
      "convergence_epoch": 8,
      "maximum_overfitting": 5.0,
      "ivt_instrument_target": 85.0,
      "ivt_verb_target": 65.0,
      "ivt_target_target": 45.0
    }
  },
  "timestamp": "2025-07-04_16-37-57",
  "results_dir": "results/2025-07-04_16-37-57/fold0",
  "method_1_autoregressive_il": {
    "status": "success",
    "model_paths": {
      "loaded": "best_checkpoints/autoregressive_il_best_combined_epoch_8.pt"
    },
    "model_type": "AutoregressiveIL",
    "approach": "Enhanced: Causal frame generation \u2192 action anticipation with IVT-based saving",
    "evaluation": {
      "overall_metrics": {
        "ivt_current_mAP": 0.451459275993662,
        "ivt_current_AP_per_class": [
          NaN,
          NaN,
          NaN,
          0.029313442427170183,
          0.277543752798262,
          NaN,
          NaN,
          0.029155418993912587,
          0.001694315184031809,
          NaN,
          0.007604373963833856,
          NaN,
          0.8546898862489292,
          NaN,
          NaN,
          NaN,
          NaN,
          0.8182063835808686,
          0.14310631322701425,
          0.8289002074001314,
          0.650441853063169,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.6856148214077191,
          NaN,
          NaN,
          0.9130375635767882,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.0867435828792556,
          0.5271937683431936,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.01608187134502924,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.48600999385396737,
          0.42887910613315255,
          NaN,
          0.8928349604429218,
          0.8892535952998659,
          NaN,
          NaN,
          NaN,
          NaN,
          0.38437380666193066,
          NaN,
          0.9186955055605706,
          0.8893978385417414,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.7204610277115118,
          0.8050644348359396,
          NaN,
          NaN,
          0.8246739582927182,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.5888888888888888,
          NaN,
          0.241459747529256,
          NaN,
          0.13874899416277667,
          NaN,
          0.3601660360832542,
          0.1491833312173458,
          0.16477490427999902,
          0.07895672041317679,
          0.1614920104050539,
          0.35697296903112813
        ],
        "ivt_rec_i_mAP": 0.8767584735856663,
        "ivt_rec_v_mAP": 0.6521823051134196,
        "ivt_rec_t_mAP": 0.5307536154100301,
        "ivt_rec_iv_mAP": 0.42593694385882747,
        "ivt_rec_it_mAP": 0.5312641861712238,
        "ivt_next_mAP": 0.4242550218619623,
        "ivt_next_AP_per_class": [
          NaN,
          NaN,
          NaN,
          0.04030012349796769,
          0.06511905904759344,
          NaN,
          NaN,
          0.02024217447735279,
          0.002829797300603983,
          NaN,
          0.008032214305940661,
          NaN,
          0.7239547942285142,
          NaN,
          NaN,
          NaN,
          NaN,
          0.8160703514400777,
          0.19622973996181955,
          0.782736818699059,
          0.5702456666051792,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.7158271167010819,
          NaN,
          NaN,
          0.8937546601313627,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.13246563545268375,
          0.3364097887129389,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.011458878994237821,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.5390444360124889,
          0.5367421264152599,
          NaN,
          0.9179951120247204,
          0.970054259652955,
          NaN,
          NaN,
          NaN,
          NaN,
          0.4849218274465514,
          NaN,
          0.45394032768551745,
          0.8097807905197655,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.6573195294867142,
          0.7915741696721154,
          NaN,
          NaN,
          0.7305754815102671,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.557936507936508,
          NaN,
          0.2055774744365899,
          NaN,
          0.1681406827706432,
          NaN,
          0.4062539814233972,
          0.15044275471952986,
          0.21603703124442486,
          0.07025241306903321,
          0.08818249651582985,
          0.3542225212079929
        ],
        "ivt_i_mAP": 0.8517663679594542,
        "ivt_v_mAP": 0.6295850312267582,
        "ivt_t_mAP": 0.5168296925352448,
        "ivt_iv_mAP": 0.4253867410807541,
        "ivt_it_mAP": 0.4980169022262107,
        "total_loss": 0.42663335980156836,
        "frame_loss": 0.1906773406133223,
        "consistency_loss": 0.0020655098196891305,
        "action_loss": 0.03843316512955405,
        "action_rec_loss": 0.042419655316479385,
        "phase_loss": 0.8208294007897442,
        "action_mAP": 0.4242550218619622,
        "action_mAP_standard": 0.0,
        "action_mAP_freq_weighted": 0.0,
        "action_hamming_accuracy": 0.0,
        "action_precision": 0.0,
        "action_recall": 0.0,
        "action_f1": 0.0,
        "action_sparsity": 0.0,
        "num_actions_present": 0.0,
        "action_mAP_with_null_verb": 0.4242550218619622,
        "action_sparsity_with_null_verb": 0.6599999999999999,
        "num_actions_total": 0.0,
        "num_actions_total_with_null_verb": 100.0,
        "planning_1s_mAP": 0.4242550218619623,
        "planning_2s_mAP": 0.40253944455907514,
        "planning_3s_mAP": 0.3752883982546148,
        "planning_5s_mAP": 0.3442538787373423,
        "planning_10s_mAP": 0.29173048721736977,
        "planning_20s_mAP": 0.22487408365924272,
        "planning_available": true
      },
      "detailed_video_metrics": {
        "VID02": {
          "mAP": 0.4242550218619622,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "ignore_null_verbs": 6,
            "subset_size": 94,
            "present_actions_in_subset": "28",
            "subset_action_sparsity": 0.7021276595744681
          },
          "mAP_standard_with_null_verb": 0.7442467074330671,
          "mAP_present_only_with_null_verb": 0.4242550218619622,
          "mAP_freq_weighted_with_null_verb": 0.7155195349202362,
          "mAP_sample_wise_with_null_verb": 0.7249621149417182,
          "mAP_standard_all_actions": 0.7442467074330671,
          "mAP_present_only_all_actions": 0.4242550218619622,
          "mAP_freq_weighted_all_actions": 0.7155195349202362,
          "mAP_sample_wise_all_actions": 0.7249621149417182,
          "hamming_accuracy_with_null_verb": 0.9900774920746742,
          "precision_with_null_verb": 0.8463521745890401,
          "recall_with_null_verb": 0.7687473625840466,
          "f1_with_null_verb": 0.8024853335938904,
          "num_predictions": 2839,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": "34",
          "action_sparsity_with_null_verb": 0.6599999999999999,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID02_epoch_-1",
          "exclude_last_n": 6
        }
      },
      "video_loss_metrics": {
        "VID02": {
          "action_rec_loss": 0.042419655316479385,
          "frame_loss": 0.1906773406133223,
          "action_loss": 0.03843316512955405,
          "phase_loss": 0.8208294007897442,
          "consistency_loss": 0.0020655098196891305,
          "total_loss": 0.42663335980156836
        }
      },
      "planning_evaluation": {
        "aggregated_results": {
          "num_videos": 1,
          "horizon_aggregated": {
            "1s": {
              "num_videos_evaluated": 1,
              "planning_horizon_frames": 1,
              "planning_horizon_seconds": 1.0,
              "mean_ivt_mAP": 0.4242550218619623,
              "std_ivt_mAP": 0.0,
              "mean_hamming_accuracy": 0.9900774920746742,
              "std_hamming_accuracy": 0.0,
              "mean_action_consistency": 0.9964693446088795,
              "std_action_consistency": 0.0,
              "mean_temporal_smoothness": "0.9961476",
              "std_temporal_smoothness": "0.0",
              "mean_sparsity_similarity": 0.996748855230715,
              "std_sparsity_similarity": 0.0,
              "mean_ivt_i_mAP": 0.8517663679594542,
              "mean_ivt_v_mAP": 0.6295850312267582,
              "mean_ivt_t_mAP": 0.5168296925352448,
              "mean_ivt_iv_mAP": 0.4253867410807541,
              "mean_ivt_it_mAP": 0.4980169022262107
            },
            "2s": {
              "num_videos_evaluated": 1,
              "planning_horizon_frames": 2,
              "planning_horizon_seconds": 2.0,
              "mean_ivt_mAP": 0.40253944455907514,
              "std_ivt_mAP": 0.0,
              "mean_hamming_accuracy": 0.9898450158506517,
              "std_hamming_accuracy": 0.0,
              "mean_action_consistency": 0.9969133192389006,
              "std_action_consistency": 0.0,
              "mean_temporal_smoothness": "0.99677974",
              "std_temporal_smoothness": "0.0",
              "mean_sparsity_similarity": 0.9971574498062699,
              "std_sparsity_similarity": 0.0,
              "mean_ivt_i_mAP": 0.8097269028662005,
              "mean_ivt_v_mAP": 0.5802953150984799,
              "mean_ivt_t_mAP": 0.5168647720633816,
              "mean_ivt_iv_mAP": 0.39372295600993623,
              "mean_ivt_it_mAP": 0.4789034075819985
            },
            "3s": {
              "num_videos_evaluated": 1,
              "planning_horizon_frames": 3,
              "planning_horizon_seconds": 3.0,
              "mean_ivt_mAP": 0.3752883982546148,
              "std_ivt_mAP": 0.0,
              "mean_hamming_accuracy": 0.989513913349771,
              "std_hamming_accuracy": 0.0,
              "mean_action_consistency": 0.9971282593375617,
              "std_action_consistency": 0.0,
              "mean_temporal_smoothness": "0.9971727",
              "std_temporal_smoothness": "0.0",
              "mean_sparsity_similarity": 0.9975096865093342,
              "std_sparsity_similarity": 0.0,
              "mean_ivt_i_mAP": 0.7683114884917305,
              "mean_ivt_v_mAP": 0.53829392854935,
              "mean_ivt_t_mAP": 0.5043697267287403,
              "mean_ivt_iv_mAP": 0.35903473130931457,
              "mean_ivt_it_mAP": 0.44994433628784136
            },
            "5s": {
              "num_videos_evaluated": 1,
              "planning_horizon_frames": 5,
              "planning_horizon_seconds": 5.0,
              "mean_ivt_mAP": 0.3442538787373423,
              "std_ivt_mAP": 0.0,
              "mean_hamming_accuracy": 0.9890031701303276,
              "std_hamming_accuracy": 0.0,
              "mean_action_consistency": 0.9977343199436223,
              "std_action_consistency": 0.0,
              "mean_temporal_smoothness": "0.99760866",
              "std_temporal_smoothness": "0.0",
              "mean_sparsity_similarity": 0.9979711165903488,
              "std_sparsity_similarity": 0.0,
              "mean_ivt_i_mAP": 0.7222750342431205,
              "mean_ivt_v_mAP": 0.4903252400977278,
              "mean_ivt_t_mAP": 0.477055304809388,
              "mean_ivt_iv_mAP": 0.3403785964694145,
              "mean_ivt_it_mAP": 0.41309924596847064
            },
            "10s": {
              "num_videos_evaluated": 1,
              "planning_horizon_frames": 10,
              "planning_horizon_seconds": 10.0,
              "mean_ivt_mAP": 0.29173048721736977,
              "std_ivt_mAP": 0.0,
              "mean_hamming_accuracy": 0.9879006692497359,
              "std_hamming_accuracy": 0.0,
              "mean_action_consistency": 0.9980796335447498,
              "std_action_consistency": 0.0,
              "mean_temporal_smoothness": "0.9979268",
              "std_temporal_smoothness": "0.0",
              "mean_sparsity_similarity": 0.9982423388517083,
              "std_sparsity_similarity": 0.0,
              "mean_ivt_i_mAP": 0.6529048051783165,
              "mean_ivt_v_mAP": 0.4200126481750095,
              "mean_ivt_t_mAP": 0.4037084324477316,
              "mean_ivt_iv_mAP": 0.31140407779699614,
              "mean_ivt_it_mAP": 0.3470870304434124
            },
            "20s": {
              "num_videos_evaluated": 1,
              "planning_horizon_frames": 20,
              "planning_horizon_seconds": 20.0,
              "mean_ivt_mAP": 0.22487408365924272,
              "std_ivt_mAP": 0.0,
              "mean_hamming_accuracy": 0.9863543501232829,
              "std_hamming_accuracy": 0.0,
              "mean_action_consistency": 0.9976215644820295,
              "std_action_consistency": 0.0,
              "mean_temporal_smoothness": "0.99756575",
              "std_temporal_smoothness": "0.0",
              "mean_sparsity_similarity": 0.9989855582951743,
              "std_sparsity_similarity": 0.0,
              "mean_ivt_i_mAP": 0.5608972883437964,
              "mean_ivt_v_mAP": 0.34734091440851067,
              "mean_ivt_t_mAP": 0.3232500531207781,
              "mean_ivt_iv_mAP": 0.25443853402950223,
              "mean_ivt_it_mAP": 0.2679779509834349
            }
          }
        },
        "detailed_video_results": {
          "VID02": {
            "video_id": "VID02",
            "horizon_results": {
              "1s": {
                "num_sequences": 2839,
                "total_frames": 2839,
                "horizon_frames": 1,
                "avg_frames_per_sequence": 1.0,
                "ivt_mAP": 0.4242550218619623,
                "ivt_i_mAP": 0.8517663679594542,
                "ivt_v_mAP": 0.6295850312267582,
                "ivt_t_mAP": 0.5168296925352448,
                "ivt_iv_mAP": 0.4253867410807541,
                "ivt_it_mAP": 0.4980169022262107,
                "exact_match_rate": 0.4033110250088059,
                "hamming_accuracy": 0.9900774920746742,
                "action_consistency": 0.9964693446088795,
                "temporal_smoothness": "0.9961476",
                "pred_sparsity": 0.011095456146530468,
                "gt_sparsity": 0.014346600915815428,
                "sparsity_similarity": 0.996748855230715
              },
              "2s": {
                "num_sequences": 2839,
                "total_frames": 2839,
                "horizon_frames": 2,
                "avg_frames_per_sequence": 1.0,
                "ivt_mAP": 0.40253944455907514,
                "ivt_i_mAP": 0.8097269028662005,
                "ivt_v_mAP": 0.5802953150984799,
                "ivt_t_mAP": 0.5168647720633816,
                "ivt_iv_mAP": 0.39372295600993623,
                "ivt_it_mAP": 0.4789034075819985,
                "exact_match_rate": 0.38675589996477633,
                "hamming_accuracy": 0.9898450158506517,
                "action_consistency": 0.9969133192389006,
                "temporal_smoothness": "0.99677974",
                "pred_sparsity": 0.01150405072208524,
                "gt_sparsity": 0.014346600915815428,
                "sparsity_similarity": 0.9971574498062699
              },
              "3s": {
                "num_sequences": 2839,
                "total_frames": 2839,
                "horizon_frames": 3,
                "avg_frames_per_sequence": 1.0,
                "ivt_mAP": 0.3752883982546148,
                "ivt_i_mAP": 0.7683114884917305,
                "ivt_v_mAP": 0.53829392854935,
                "ivt_t_mAP": 0.5043697267287403,
                "ivt_iv_mAP": 0.35903473130931457,
                "ivt_it_mAP": 0.44994433628784136,
                "exact_match_rate": 0.3712574850299401,
                "hamming_accuracy": 0.989513913349771,
                "action_consistency": 0.9971282593375617,
                "temporal_smoothness": "0.9971727",
                "pred_sparsity": 0.0118562874251497,
                "gt_sparsity": 0.014346600915815428,
                "sparsity_similarity": 0.9975096865093342
              },
              "5s": {
                "num_sequences": 2839,
                "total_frames": 2839,
                "horizon_frames": 5,
                "avg_frames_per_sequence": 1.0,
                "ivt_mAP": 0.3442538787373423,
                "ivt_i_mAP": 0.7222750342431205,
                "ivt_v_mAP": 0.4903252400977278,
                "ivt_t_mAP": 0.477055304809388,
                "ivt_iv_mAP": 0.3403785964694145,
                "ivt_it_mAP": 0.41309924596847064,
                "exact_match_rate": 0.35258893976752376,
                "hamming_accuracy": 0.9890031701303276,
                "action_consistency": 0.9977343199436223,
                "temporal_smoothness": "0.99760866",
                "pred_sparsity": 0.012317717506164142,
                "gt_sparsity": 0.014346600915815428,
                "sparsity_similarity": 0.9979711165903488
              },
              "10s": {
                "num_sequences": 2839,
                "total_frames": 2839,
                "horizon_frames": 10,
                "avg_frames_per_sequence": 1.0,
                "ivt_mAP": 0.29173048721736977,
                "ivt_i_mAP": 0.6529048051783165,
                "ivt_v_mAP": 0.4200126481750095,
                "ivt_t_mAP": 0.4037084324477316,
                "ivt_iv_mAP": 0.31140407779699614,
                "ivt_it_mAP": 0.3470870304434124,
                "exact_match_rate": 0.3141951391334977,
                "hamming_accuracy": 0.9879006692497359,
                "action_consistency": 0.9980796335447498,
                "temporal_smoothness": "0.9979268",
                "pred_sparsity": 0.012588939767523776,
                "gt_sparsity": 0.014346600915815428,
                "sparsity_similarity": 0.9982423388517083
              },
              "20s": {
                "num_sequences": 2839,
                "total_frames": 2839,
                "horizon_frames": 20,
                "avg_frames_per_sequence": 1.0,
                "ivt_mAP": 0.22487408365924272,
                "ivt_i_mAP": 0.5608972883437964,
                "ivt_v_mAP": 0.34734091440851067,
                "ivt_t_mAP": 0.3232500531207781,
                "ivt_iv_mAP": 0.25443853402950223,
                "ivt_it_mAP": 0.2679779509834349,
                "exact_match_rate": 0.27932370553011626,
                "hamming_accuracy": 0.9863543501232829,
                "action_consistency": 0.9976215644820295,
                "temporal_smoothness": "0.99756575",
                "pred_sparsity": 0.013332159210989784,
                "gt_sparsity": 0.014346600915815428,
                "sparsity_similarity": 0.9989855582951743
              }
            }
          }
        },
        "evaluation_settings": {
          "context_length": 20,
          "temperature": 0.1,
          "planning_horizons": {
            "1s": 1,
            "2s": 2,
            "3s": 3,
            "5s": 5,
            "10s": 10,
            "20s": 20
          },
          "num_videos": 1
        }
      },
      "model_type": "AutoregressiveIL",
      "evaluation_approach": "comprehensive_with_planning",
      "num_videos_evaluated": 1,
      "publication_metrics": {
        "single_step_mAP": 0.4242550218619622,
        "single_step_ivt_mAP": 0.0,
        "planning_1s_mAP": 0.4242550218619623,
        "planning_2s_mAP": 0.40253944455907514,
        "planning_3s_mAP": 0.3752883982546148,
        "planning_5s_mAP": 0.3442538787373423,
        "planning_10s_mAP": 0.29173048721736977,
        "evaluation_types": [
          "single_step_recognition",
          "multi_step_planning"
        ],
        "planning_consistency": 0.9969133192389006
      },
      "evaluation_summary": {
        "single_step_performance": 0.4242550218619622,
        "short_term_planning": 0.40253944455907514,
        "medium_term_planning": 0.3442538787373423,
        "long_term_planning": 0.29173048721736977,
        "planning_degradation": 0.18856852365238364,
        "strength": "Autoregressive planning with causal generation",
        "architecture": "GPT-2 based autoregressive model",
        "planning_horizon_capability": "up_to_10_seconds",
        "target_prediction_type": "next_action_anticipation"
      },
      "performance_analysis": {
        "summary_stats": {
          "num_videos": 1,
          "mAP_stats": {
            "mean": 0.4242550218619622,
            "std": 0.0,
            "min": 0.4242550218619622,
            "max": 0.4242550218619622,
            "median": 0.4242550218619622,
            "q25": 0.4242550218619622,
            "q75": 0.4242550218619622
          },
          "sparsity_stats": {}
        },
        "performance_categories": {
          "high_performers": [],
          "low_performers": [],
          "consistent_performers": [
            "VID02"
          ]
        },
        "detailed_rankings": [
          [
            "VID02",
            0.4242550218619622
          ]
        ]
      }
    },
    "method_description": "Enhanced Autoregressive IL with IVT-optimized model saving",
    "capabilities": {
      "single_step_recognition": 0.4242550218619622,
      "short_term_planning_2s": 0.40253944455907514,
      "planning_degradation": 0.18856852365238364,
      "planning_horizon": "up_to_5_seconds"
    },
    "training_performance": {},
    "model_selection_strategy": "IVT-based (combined preference)",
    "target_type": "next_action_prediction",
    "planning_ready": true,
    "pretrained": true,
    "enhanced_saving": true
  },
  "method_4_irl_enhancement": {
    "status": "skipped",
    "reason": "IRL Enhancement disabled in config"
  },
  "comprehensive_evaluation": {
    "status": "failed",
    "error": "No models loaded",
    "fix_applied": "attempted_but_no_models"
  },
  "generated_plots": {
    "per_video_performance": "results/2025-07-04_16-37-57/fold0/publication_plots/per_video_performance_analysis.png",
    "performance_dashboard": "results/2025-07-04_16-37-57/fold0/publication_plots/performance_dashboard.png"
  }
}