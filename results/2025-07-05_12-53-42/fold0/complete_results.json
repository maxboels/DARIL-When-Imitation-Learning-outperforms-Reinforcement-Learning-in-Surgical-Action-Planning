{
  "experiment_name": "2025-07-05_12-53-42",
  "config": {
    "debug": false,
    "experiment": {
      "train": {
        "max_videos": 40
      },
      "test": {
        "max_videos": 2,
        "test_on_train": false
      },
      "autoregressive_il": {
        "enabled": true,
        "train": false,
        "evaluate": true,
        "visualization": true,
        "model_type_preference": "combined",
        "save_all_best_models": true,
        "il_model_path": "best_checkpoints/autoregressive_il_best_combined_epoch_8.pt",
        "ivt_saving": {
          "enabled": true,
          "current_weight": 0.4,
          "next_weight": 0.6,
          "save_frequency": 1,
          "keep_top_k": 3
        },
        "evaluation_model": "combined",
        "recognition": {
          "enabled": false,
          "ivt_map": 36.1
        }
      },
      "world_model": {
        "enabled": false,
        "wm_model_path": "results/fixed_rl_2025-06-13_19-22-25/logs/checkpoints/world_model_best_epoch_1.pt"
      },
      "rl_experiments": {
        "enabled": false,
        "eval_episodes": 10
      },
      "irl_enhancement": {
        "enabled": false,
        "train": false,
        "evaluate": true,
        "irl_model_path": null,
        "num_epochs": 25,
        "task_focus": "next_action_prediction",
        "match_il_temporal_structure": true,
        "scenarios_to_train": [
          "high_complexity",
          "rare_actions",
          "critical_moments",
          "phase_transitions"
        ],
        "policy_adjustment": {
          "num_epochs": 15
        },
        "learning_rate": "5e-5",
        "early_stopping": {
          "patience": 5,
          "min_delta": 0.001
        },
        "maxent_irl": {
          "num_iterations": 10,
          "learning_rate": "5e-5"
        },
        "lightweight_gail": {
          "num_epochs": 5,
          "learning_rate": "1e-4",
          "adjustment_strength": 0.1
        },
        "evaluation": {
          "min_improvement_threshold": 0.02
        }
      }
    },
    "training": {
      "epochs": 15,
      "batch_size": 16,
      "learning_rate": "8e-5",
      "log_every_n_steps": 20,
      "optimizer_type": "adamw",
      "weight_decay": 0.025,
      "gradient_clip_val": 0.8,
      "scheduler": {
        "type": "cosine_with_warmup",
        "warmup_epochs": 3,
        "eta_min": "8e-6"
      },
      "parameter_groups": {
        "bilstm_recognition": {
          "lr_multiplier": 1.0,
          "weight_decay_multiplier": 0.3
        },
        "gpt2_backbone": {
          "lr_multiplier": 0.3,
          "weight_decay_multiplier": 0.8
        },
        "frame_processing": {
          "lr_multiplier": 0.5,
          "weight_decay_multiplier": 1.5
        },
        "action_prediction": {
          "lr_multiplier": 1.5,
          "weight_decay_multiplier": 0.2
        },
        "auxiliary_heads": {
          "lr_multiplier": 0.8,
          "weight_decay_multiplier": 1.0
        }
      },
      "lr_monitoring": {
        "track_gradients": true,
        "track_parameters": true,
        "log_frequency": 50,
        "save_plots": true,
        "generate_recommendations": true
      },
      "augmentation": {
        "temporal_crop_ratio": 0.85,
        "temporal_jitter_std": 0.02,
        "sequence_shuffle_prob": 0.1,
        "frame_dropout_prob": 0.05
      },
      "early_stopping": {
        "patience": 8,
        "min_delta": 0.001,
        "monitor": "ivt_next_mAP",
        "mode": "max"
      },
      "monitor_ivt_metrics": true,
      "log_ivt_components": true,
      "tensorboard_ivt_tracking": true,
      "num_workers": 2,
      "pin_memory": true,
      "log_dir": "logs",
      "checkpoint_dir": "checkpoints",
      "eval_epoch_interval": 1,
      "save_model": true,
      "checkpointing": {
        "save_best_only": false,
        "save_top_k": 5,
        "monitor": "ivt_next_mAP",
        "mode": "max",
        "save_every_n_epochs": 5,
        "save_ivt_milestones": true,
        "ivt_milestones": [
          0.34,
          0.35,
          0.36,
          0.37
        ]
      },
      "min_current_map_threshold": 0.34,
      "min_next_map_threshold": 0.34,
      "min_combined_threshold": 0.34
    },
    "evaluation": {
      "prediction_horizon": 8,
      "comprehensive_evaluation": {
        "per_video_analysis": true,
        "statistical_significance": true,
        "confidence_intervals": true,
        "baseline_comparison": 36.1,
        "evaluate_ivt_components": true,
        "ivt_video_wise": true,
        "report_both_tasks": true
      },
      "supervised": {
        "action_prediction": true
      },
      "rl": {
        "rollout_horizon": 15,
        "use_best_actions": true
      },
      "comparison": {
        "statistical_tests": true,
        "effect_size_threshold": 0.15,
        "compare_all_saved_models": true
      },
      "planning_evaluation": {
        "enabled": true,
        "planning_horizons": [
          1,
          2,
          3,
          5,
          10,
          20
        ],
        "use_best_next_model": true
      },
      "world_model": {
        "use_memory": false,
        "overall_horizon": 1
      }
    },
    "visualization": {
      "plot_top": 5,
      "enhanced_planning_analysis": true,
      "simple_planning_analysis": true,
      "sparsity_analysis": true,
      "qualitative_evaluation": true
    },
    "rl_training": {
      "action_space_type": "continuous",
      "outcome_based_rewards": true,
      "rl_horizon": 30,
      "reward_mode": "dense",
      "normalize_rewards": true,
      "early_termination": true,
      "timesteps": 50000,
      "reward_weights": {
        "expert_matching": 10.0,
        "action_sparsity": 1.0,
        "world_model_rewards": 0.5,
        "completion_bonus": 5.0,
        "consistency_bonus": 1.0,
        "phase_completion": 1.0,
        "risk_penalty": -0.5
      },
      "ppo": {
        "learning_rate": "5e-5",
        "n_steps": 512,
        "batch_size": 64,
        "n_epochs": 10,
        "gamma": 0.95,
        "gae_lambda": 0.9,
        "clip_range": 0.1,
        "ent_coef": 0.05,
        "vf_coef": 0.5,
        "max_grad_norm": 0.5
      },
      "a2c": {
        "learning_rate": "1e-4",
        "n_steps": 32,
        "gamma": 0.95,
        "gae_lambda": 0.9,
        "ent_coef": 0.05,
        "vf_coef": 0.25,
        "max_grad_norm": 0.5
      }
    },
    "data": {
      "context_length": 20,
      "future_length": 20,
      "train_shift": 1,
      "padding_value": 0.0,
      "max_horizon": 20,
      "normalize_embeddings": true,
      "embedding_noise": 0.01,
      "ivt_evaluation_mode": true,
      "preserve_video_structure": true,
      "paths": {
        "data_dir": "/home/maxboels/datasets/CholecT50",
        "class_labels_file_path": "./data/labels.json",
        "fold": 0,
        "metadata_file": "embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv",
        "video_global_outcome_file": "embeddings_f1_swin_bas_129_with_enhanced_global_metrics.csv"
      },
      "frame_risk_agg": "max"
    },
    "training_mode": "rl",
    "preprocess": {
      "extract_rewards": false,
      "analyze_rewards": false,
      "rewards": {
        "grounded": {
          "phase_completion": true,
          "phase_transition": true,
          "phase_progression": true,
          "global_progression": true
        },
        "imitation": {
          "action_distribution": true
        },
        "expert_knowledge": {
          "risk_score": true,
          "frame_risk_agg": "max"
        }
      }
    },
    "models": {
      "autoregressive_il": {
        "hidden_dim": 384,
        "embedding_dim": 1024,
        "n_layer": 3,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.3,
        "max_length": 256,
        "layer_dropout": 0.15,
        "attention_dropout": 0.2,
        "frame_projection_dropout": 0.2,
        "bilstm_layers": 1,
        "bilstm_dropout": 0.25,
        "bilstm_bidirectional": true,
        "current_task_weight": 2.0,
        "next_task_weight": 1.5,
        "consistency_weight": 0.1
      },
      "conditional_world_model": {
        "hidden_dim": 512,
        "embedding_dim": 1024,
        "action_embedding_dim": 128,
        "n_layer": 4,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.1,
        "max_sequence_length": 512
      }
    },
    "loss_weights": {
      "recognition": 2.0,
      "generation": 1.5,
      "frame_reconstruction": 0.2,
      "phase_prediction": 0.5,
      "consistency": 0.1
    },
    "fair_evaluation": {
      "enabled": true,
      "include_traditional_metrics": true,
      "include_clinical_metrics": true,
      "per_video_analysis": {
        "enabled": true,
        "save_individual_results": true,
        "statistical_aggregation": true,
        "baseline_comparison": 36.1
      },
      "clinical_outcome_weights": {
        "phase_progression": 2.0,
        "innovation": 0.5
      }
    },
    "supervised_learning": {
      "data_augmentation": true
    },
    "research_comparison": {
      "methods": [
        "autoregressive_il",
        "conditional_world_model",
        "direct_video_rl"
      ]
    },
    "advanced": {
      "mixed_precision": false
    },
    "hardware": {
      "persistent_workers": false,
      "mixed_precision": false
    },
    "rl_debugging": {
      "enabled": true,
      "save_training_curves": true,
      "monitor_expert_matching": true,
      "log_action_distributions": true,
      "convergence_analysis": true,
      "episode_log_frequency": 10,
      "eval_frequency": 1000,
      "reward_improvement_threshold": 0.1,
      "expert_matching_threshold": 0.5,
      "debug_dir": "rl_debug",
      "plot_dir": "rl_plots"
    },
    "il_debugging": {
      "enabled": true,
      "convergence_tracking": {
        "early_plateau_detection": true,
        "overfitting_detection": true,
        "feature_utilization_analysis": true
      },
      "baseline_comparison": {
        "swin_recognition_mAP": 36.1,
        "improvement_threshold": 1.0
      },
      "temporal_evaluation": {
        "short_term_prediction": true,
        "medium_term_prediction": true,
        "temporal_consistency": true,
        "sequence_modeling_analysis": true
      }
    },
    "logging": {
      "level": "INFO",
      "log_ivt_details": true,
      "save_ivt_plots": true,
      "ivt_component_analysis": true,
      "log_best_scores": true,
      "log_model_saves": true
    },
    "il_performance_targets": {
      "current_recognition_mAP_target": 35.0,
      "current_recognition_minimum": 30.0,
      "next_prediction_mAP_target": 32.0,
      "next_prediction_minimum": 25.0,
      "combined_score_target": 33.0,
      "improvement_over_baseline": 2.0,
      "convergence_epoch": 8,
      "maximum_overfitting": 5.0,
      "ivt_instrument_target": 85.0,
      "ivt_verb_target": 65.0,
      "ivt_target_target": 45.0
    }
  },
  "timestamp": "2025-07-05_12-53-42",
  "results_dir": "results/2025-07-05_12-53-42/fold0",
  "method_1_autoregressive_il": {
    "overall_metrics": {
      "ivt_current_mAP": 0.4562162204262548,
      "ivt_current_AP_per_class": [
        NaN,
        NaN,
        NaN,
        0.029313442427170183,
        0.5493172255438771,
        NaN,
        NaN,
        0.062549588885924,
        0.001694315184031809,
        NaN,
        0.007604373963833856,
        NaN,
        0.864675254723134,
        0.5399843212343212,
        NaN,
        NaN,
        NaN,
        0.9077527310961984,
        0.11449123568360994,
        0.8674562762161304,
        0.650441853063169,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.7795654404394173,
        0.9614863426595947,
        NaN,
        0.7930254699670425,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.21139977261300574,
        0.5271937683431936,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.21989466902093327,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.6402162821279824,
        0.3721413546387725,
        0.5922368313100684,
        0.7459804728427492,
        0.8892535952998659,
        NaN,
        0.004315501876097589,
        NaN,
        NaN,
        0.38437380666193066,
        NaN,
        0.7600461334282471,
        0.7259454178703104,
        0.07759807855179038,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.817890315223597,
        0.7529522576245322,
        NaN,
        0.02024557775692014,
        0.79258599522392,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.541919375948414,
        NaN,
        0.241459747529256,
        NaN,
        0.33306638290679563,
        NaN,
        0.37011106222365864,
        0.3427421926577526,
        0.33281663412781914,
        0.07895672041317679,
        0.1614920104050539,
        0.18245698933689136
      ],
      "ivt_rec_i_mAP": 0.903117619715419,
      "ivt_rec_v_mAP": 0.6807543930000388,
      "ivt_rec_t_mAP": 0.5713434228456655,
      "ivt_rec_iv_mAP": 0.4566975834945793,
      "ivt_rec_it_mAP": 0.5321629748144802,
      "ivt_next_mAP": 0.4492495910740549,
      "ivt_next_AP_per_class": [
        NaN,
        NaN,
        NaN,
        0.04030012349796769,
        0.39671321326938697,
        NaN,
        NaN,
        0.14637220282421445,
        0.002829797300603983,
        NaN,
        0.008032214305940661,
        NaN,
        0.806293152919147,
        0.5813376678598831,
        NaN,
        NaN,
        NaN,
        0.9064908373956262,
        0.12407881242895724,
        0.8452577438702138,
        0.5702456666051792,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.7910650735020561,
        0.955275568535744,
        NaN,
        0.8438227803065473,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.25906217221624506,
        0.3364097887129389,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.05680432636022587,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.6039619686890767,
        0.42925971805233554,
        0.6853715484841963,
        0.7379652865406242,
        0.970054259652955,
        NaN,
        0.008152831379896423,
        NaN,
        NaN,
        0.4849218274465514,
        NaN,
        0.5788532807258756,
        0.5738344653978176,
        0.6000891801888859,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.7339760644494923,
        0.7407348792405091,
        NaN,
        0.3499682106138344,
        0.7118828379157491,
        NaN,
        NaN,
        NaN,
        NaN,
        NaN,
        0.40649562669408307,
        NaN,
        0.2055774744365899,
        NaN,
        0.27140198902033713,
        NaN,
        0.35486020801642737,
        0.2377848306990053,
        0.27378412753345416,
        0.07025241306903321,
        0.08818249651582985,
        0.18222697628875498
      ],
      "ivt_i_mAP": 0.8787798109386071,
      "ivt_v_mAP": 0.6508725351421026,
      "ivt_t_mAP": 0.5608231647144254,
      "ivt_iv_mAP": 0.42595893129539486,
      "ivt_it_mAP": 0.5224516296020836,
      "action_loss": 0.03485449217054061,
      "phase_loss": 0.6733139042304234,
      "frame_loss": 0.19032879068558667,
      "action_rec_loss": 0.041261143073082235,
      "total_loss": 0.3798937564949651,
      "consistency_loss": 0.002128960968991525,
      "action_mAP": 0.47143243549784175,
      "action_mAP_standard": 0.0,
      "action_mAP_freq_weighted": 0.0,
      "action_hamming_accuracy": 0.0,
      "action_precision": 0.0,
      "action_recall": 0.0,
      "action_f1": 0.0,
      "action_sparsity": 0.0,
      "num_actions_present": 0.0,
      "action_mAP_with_null_verb": 0.47143243549784175,
      "action_sparsity_with_null_verb": 0.6799999999999999,
      "num_actions_total": 0.0,
      "num_actions_total_with_null_verb": 100.0,
      "action_mAP_std": 0.04717741363587957,
      "action_sparsity_std": 0.0,
      "planning_1s_mAP": 0.4714324354978418,
      "planning_2s_mAP": 0.4273183213757384,
      "planning_3s_mAP": 0.3909136398094878,
      "planning_5s_mAP": 0.3453404031372169,
      "planning_10s_mAP": 0.2909908445147952,
      "planning_20s_mAP": 0.2276636425300192,
      "planning_available": true
    },
    "detailed_results": {
      "epoch": -1,
      "video_loss_metrics": {
        "VID02": {
          "action_rec_loss": 0.042419655316479385,
          "frame_loss": 0.1906773406133223,
          "action_loss": 0.03843316512955405,
          "phase_loss": 0.8208294007897442,
          "consistency_loss": 0.0020655098196891305,
          "total_loss": 0.42663335980156836
        },
        "VID06": {
          "action_rec_loss": 0.04010263082968509,
          "frame_loss": 0.18998024075785103,
          "action_loss": 0.03127581921152716,
          "phase_loss": 0.5257984076711025,
          "consistency_loss": 0.00219241211829392,
          "total_loss": 0.33315415318836183
        }
      },
      "video_action_metrics": {
        "VID02": {
          "mAP": 0.4242550218619622,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "ignore_null_verbs": 6,
            "subset_size": 94,
            "present_actions_in_subset": "28",
            "subset_action_sparsity": 0.7021276595744681
          },
          "mAP_standard_with_null_verb": 0.7442467074330671,
          "mAP_present_only_with_null_verb": 0.4242550218619622,
          "mAP_freq_weighted_with_null_verb": 0.7155195349202362,
          "mAP_sample_wise_with_null_verb": 0.7249621149417182,
          "mAP_standard_all_actions": 0.7442467074330671,
          "mAP_present_only_all_actions": 0.4242550218619622,
          "mAP_freq_weighted_all_actions": 0.7155195349202362,
          "mAP_sample_wise_all_actions": 0.7249621149417182,
          "hamming_accuracy_with_null_verb": 0.9900774920746742,
          "precision_with_null_verb": 0.8463521745890401,
          "recall_with_null_verb": 0.7687473625840466,
          "f1_with_null_verb": 0.8024853335938904,
          "num_predictions": 2839,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": "34",
          "action_sparsity_with_null_verb": 0.6599999999999999,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID02_epoch_-1",
          "exclude_last_n": 6
        },
        "VID06": {
          "mAP": 0.5186098491337213,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "ignore_null_verbs": 6,
            "subset_size": 94,
            "present_actions_in_subset": "26",
            "subset_action_sparsity": 0.7234042553191489
          },
          "mAP_standard_with_null_verb": 0.8355829547401165,
          "mAP_present_only_with_null_verb": 0.5186098491337213,
          "mAP_freq_weighted_with_null_verb": 0.7652085136177103,
          "mAP_sample_wise_with_null_verb": 0.8385355044939475,
          "mAP_standard_all_actions": 0.8355829547401165,
          "mAP_present_only_all_actions": 0.5186098491337213,
          "mAP_freq_weighted_all_actions": 0.7652085136177103,
          "mAP_sample_wise_all_actions": 0.8385355044939475,
          "hamming_accuracy_with_null_verb": 0.9906177426846261,
          "precision_with_null_verb": 0.8855656207377981,
          "recall_with_null_verb": 0.8212871192395406,
          "f1_with_null_verb": 0.8503861422256703,
          "num_predictions": 2153,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": "30",
          "action_sparsity_with_null_verb": 0.7,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID06_epoch_-1",
          "exclude_last_n": 6
        }
      },
      "aggregated_metrics": {
        "ivt_current_mAP": 0.4562162204262548,
        "ivt_current_AP_per_class": [
          NaN,
          NaN,
          NaN,
          0.029313442427170183,
          0.5493172255438771,
          NaN,
          NaN,
          0.062549588885924,
          0.001694315184031809,
          NaN,
          0.007604373963833856,
          NaN,
          0.864675254723134,
          0.5399843212343212,
          NaN,
          NaN,
          NaN,
          0.9077527310961984,
          0.11449123568360994,
          0.8674562762161304,
          0.650441853063169,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.7795654404394173,
          0.9614863426595947,
          NaN,
          0.7930254699670425,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.21139977261300574,
          0.5271937683431936,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.21989466902093327,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.6402162821279824,
          0.3721413546387725,
          0.5922368313100684,
          0.7459804728427492,
          0.8892535952998659,
          NaN,
          0.004315501876097589,
          NaN,
          NaN,
          0.38437380666193066,
          NaN,
          0.7600461334282471,
          0.7259454178703104,
          0.07759807855179038,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.817890315223597,
          0.7529522576245322,
          NaN,
          0.02024557775692014,
          0.79258599522392,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.541919375948414,
          NaN,
          0.241459747529256,
          NaN,
          0.33306638290679563,
          NaN,
          0.37011106222365864,
          0.3427421926577526,
          0.33281663412781914,
          0.07895672041317679,
          0.1614920104050539,
          0.18245698933689136
        ],
        "ivt_rec_i_mAP": 0.903117619715419,
        "ivt_rec_v_mAP": 0.6807543930000388,
        "ivt_rec_t_mAP": 0.5713434228456655,
        "ivt_rec_iv_mAP": 0.4566975834945793,
        "ivt_rec_it_mAP": 0.5321629748144802,
        "ivt_next_mAP": 0.4492495910740549,
        "ivt_next_AP_per_class": [
          NaN,
          NaN,
          NaN,
          0.04030012349796769,
          0.39671321326938697,
          NaN,
          NaN,
          0.14637220282421445,
          0.002829797300603983,
          NaN,
          0.008032214305940661,
          NaN,
          0.806293152919147,
          0.5813376678598831,
          NaN,
          NaN,
          NaN,
          0.9064908373956262,
          0.12407881242895724,
          0.8452577438702138,
          0.5702456666051792,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.7910650735020561,
          0.955275568535744,
          NaN,
          0.8438227803065473,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.25906217221624506,
          0.3364097887129389,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.05680432636022587,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.6039619686890767,
          0.42925971805233554,
          0.6853715484841963,
          0.7379652865406242,
          0.970054259652955,
          NaN,
          0.008152831379896423,
          NaN,
          NaN,
          0.4849218274465514,
          NaN,
          0.5788532807258756,
          0.5738344653978176,
          0.6000891801888859,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.7339760644494923,
          0.7407348792405091,
          NaN,
          0.3499682106138344,
          0.7118828379157491,
          NaN,
          NaN,
          NaN,
          NaN,
          NaN,
          0.40649562669408307,
          NaN,
          0.2055774744365899,
          NaN,
          0.27140198902033713,
          NaN,
          0.35486020801642737,
          0.2377848306990053,
          0.27378412753345416,
          0.07025241306903321,
          0.08818249651582985,
          0.18222697628875498
        ],
        "ivt_i_mAP": 0.8787798109386071,
        "ivt_v_mAP": 0.6508725351421026,
        "ivt_t_mAP": 0.5608231647144254,
        "ivt_iv_mAP": 0.42595893129539486,
        "ivt_it_mAP": 0.5224516296020836,
        "action_loss": 0.03485449217054061,
        "phase_loss": 0.6733139042304234,
        "frame_loss": 0.19032879068558667,
        "action_rec_loss": 0.041261143073082235,
        "total_loss": 0.3798937564949651,
        "consistency_loss": 0.002128960968991525,
        "action_mAP": 0.47143243549784175,
        "action_mAP_standard": 0.0,
        "action_mAP_freq_weighted": 0.0,
        "action_hamming_accuracy": 0.0,
        "action_precision": 0.0,
        "action_recall": 0.0,
        "action_f1": 0.0,
        "action_sparsity": 0.0,
        "num_actions_present": 0.0,
        "action_mAP_with_null_verb": 0.47143243549784175,
        "action_sparsity_with_null_verb": 0.6799999999999999,
        "num_actions_total": 0.0,
        "num_actions_total_with_null_verb": 100.0,
        "action_mAP_std": 0.04717741363587957,
        "action_sparsity_std": 0.0,
        "planning_1s_mAP": 0.4714324354978418,
        "planning_2s_mAP": 0.4273183213757384,
        "planning_3s_mAP": 0.3909136398094878,
        "planning_5s_mAP": 0.3453404031372169,
        "planning_10s_mAP": 0.2909908445147952,
        "planning_20s_mAP": 0.2276636425300192,
        "planning_available": true
      },
      "num_videos": 2
    },
    "last_planning_results": {
      "aggregated_results": {
        "num_videos": 2,
        "horizon_aggregated": {
          "1s": {
            "num_videos_evaluated": 2,
            "planning_horizon_frames": 1,
            "planning_horizon_seconds": 1.0,
            "mean_ivt_mAP": 0.4714324354978418,
            "std_ivt_mAP": 0.04717741363587952,
            "mean_hamming_accuracy": 0.9903476173796502,
            "std_hamming_accuracy": 0.00027012530497594334,
            "mean_action_consistency": 0.996640806133436,
            "std_action_consistency": 0.00017146152455654873,
            "mean_temporal_smoothness": "0.99626875",
            "std_temporal_smoothness": "0.00012120605",
            "mean_sparsity_similarity": 0.9969020634723014,
            "std_sparsity_similarity": 0.0001532082415863223,
            "mean_ivt_i_mAP": 0.8787798109386071,
            "mean_ivt_v_mAP": 0.6532849033104463,
            "mean_ivt_t_mAP": 0.5619088750478469,
            "mean_ivt_iv_mAP": 0.45409451626005076,
            "mean_ivt_it_mAP": 0.5358238004650706
          },
          "2s": {
            "num_videos_evaluated": 2,
            "planning_horizon_frames": 2,
            "planning_horizon_seconds": 2.0,
            "mean_ivt_mAP": 0.4273183213757384,
            "std_ivt_mAP": 0.024778876816663242,
            "mean_hamming_accuracy": 0.9900177239030313,
            "std_hamming_accuracy": 0.00017270805237967757,
            "mean_action_consistency": 0.9971462506975173,
            "std_action_consistency": 0.00023293145861663644,
            "mean_temporal_smoothness": "0.9969673",
            "std_temporal_smoothness": "0.00018754601",
            "mean_sparsity_similarity": 0.9974965140345795,
            "std_sparsity_similarity": 0.0003390642283095935,
            "mean_ivt_i_mAP": 0.8495709008709709,
            "mean_ivt_v_mAP": 0.6066802937385717,
            "mean_ivt_t_mAP": 0.5418518276295261,
            "mean_ivt_iv_mAP": 0.4116130761264968,
            "mean_ivt_it_mAP": 0.49168800285019687
          },
          "3s": {
            "num_videos_evaluated": 2,
            "planning_horizon_frames": 3,
            "planning_horizon_seconds": 3.0,
            "mean_ivt_mAP": 0.3909136398094878,
            "std_ivt_mAP": 0.01562524155487302,
            "mean_hamming_accuracy": 0.9896663853790193,
            "std_hamming_accuracy": 0.00015247202924828507,
            "mean_action_consistency": 0.9974697988137622,
            "std_action_consistency": 0.0003415394762005808,
            "mean_temporal_smoothness": "0.997416",
            "std_temporal_smoothness": "0.00024333596",
            "mean_sparsity_similarity": 0.9978305515686476,
            "std_sparsity_similarity": 0.00032086505931339104,
            "mean_ivt_i_mAP": 0.8178404141331587,
            "mean_ivt_v_mAP": 0.5631849464450207,
            "mean_ivt_t_mAP": 0.5203753237924138,
            "mean_ivt_iv_mAP": 0.37789628314367923,
            "mean_ivt_it_mAP": 0.45754749372017745
          },
          "5s": {
            "num_videos_evaluated": 2,
            "planning_horizon_frames": 5,
            "planning_horizon_seconds": 5.0,
            "mean_ivt_mAP": 0.3453404031372169,
            "std_ivt_mAP": 0.0010865243998746388,
            "mean_hamming_accuracy": 0.9891044647679041,
            "std_hamming_accuracy": 0.00010129463757657664,
            "mean_action_consistency": 0.9981027547673502,
            "std_action_consistency": 0.00036843482372789227,
            "mean_temporal_smoothness": "0.9979024",
            "std_temporal_smoothness": "0.0002937019",
            "mean_sparsity_similarity": 0.998205251746173,
            "std_sparsity_similarity": 0.00023413515582421107,
            "mean_ivt_i_mAP": 0.7723304948225848,
            "mean_ivt_v_mAP": 0.5194328106849669,
            "mean_ivt_t_mAP": 0.4791131994707316,
            "mean_ivt_iv_mAP": 0.35214357948627034,
            "mean_ivt_it_mAP": 0.40686680314248325
          },
          "10s": {
            "num_videos_evaluated": 2,
            "planning_horizon_frames": 10,
            "planning_horizon_seconds": 10.0,
            "mean_ivt_mAP": 0.2909908445147952,
            "std_ivt_mAP": 0.0007396427025745944,
            "mean_hamming_accuracy": 0.9878588343926338,
            "std_hamming_accuracy": 4.183485710201884e-05,
            "mean_action_consistency": 0.9982870286682857,
            "std_action_consistency": 0.00020739512353584733,
            "mean_temporal_smoothness": "0.9981816",
            "std_temporal_smoothness": "0.00025480986",
            "mean_sparsity_similarity": 0.9984593022637548,
            "std_sparsity_similarity": 0.00021696341204646696,
            "mean_ivt_i_mAP": 0.6914251812023082,
            "mean_ivt_v_mAP": 0.46198445073940797,
            "mean_ivt_t_mAP": 0.4021830272574739,
            "mean_ivt_iv_mAP": 0.3223572576954386,
            "mean_ivt_it_mAP": 0.3373975688201811
          },
          "20s": {
            "num_videos_evaluated": 2,
            "planning_horizon_frames": 20,
            "planning_horizon_seconds": 20.0,
            "mean_ivt_mAP": 0.2276636425300192,
            "std_ivt_mAP": 0.0027895588707764762,
            "mean_hamming_accuracy": 0.9862380203937362,
            "std_hamming_accuracy": 0.00011632972954667142,
            "mean_action_consistency": 0.9979743510142489,
            "std_action_consistency": 0.000352786532219429,
            "mean_temporal_smoothness": "0.9978528",
            "std_temporal_smoothness": "0.00028705597",
            "mean_sparsity_similarity": 0.9989307726450326,
            "std_sparsity_similarity": 5.478565014171988e-05,
            "mean_ivt_i_mAP": 0.5904204787094214,
            "mean_ivt_v_mAP": 0.4023212634440791,
            "mean_ivt_t_mAP": 0.33132990802089834,
            "mean_ivt_iv_mAP": 0.2813504483904773,
            "mean_ivt_it_mAP": 0.261264686880044
          }
        }
      },
      "detailed_video_results": {
        "VID02": {
          "video_id": "VID02",
          "horizon_results": {
            "1s": {
              "num_sequences": 2839,
              "total_frames": 2839,
              "horizon_frames": 1,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.4242550218619623,
              "ivt_i_mAP": 0.8517663679594542,
              "ivt_v_mAP": 0.6295850312267582,
              "ivt_t_mAP": 0.5168296925352448,
              "ivt_iv_mAP": 0.4253867410807541,
              "ivt_it_mAP": 0.4980169022262107,
              "exact_match_rate": 0.4033110250088059,
              "hamming_accuracy": 0.9900774920746742,
              "action_consistency": 0.9964693446088795,
              "temporal_smoothness": "0.9961476",
              "pred_sparsity": 0.011095456146530468,
              "gt_sparsity": 0.014346600915815428,
              "sparsity_similarity": 0.996748855230715
            },
            "2s": {
              "num_sequences": 2839,
              "total_frames": 2839,
              "horizon_frames": 2,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.40253944455907514,
              "ivt_i_mAP": 0.8097269028662005,
              "ivt_v_mAP": 0.5802953150984799,
              "ivt_t_mAP": 0.5168647720633816,
              "ivt_iv_mAP": 0.39372295600993623,
              "ivt_it_mAP": 0.4789034075819985,
              "exact_match_rate": 0.38675589996477633,
              "hamming_accuracy": 0.9898450158506517,
              "action_consistency": 0.9969133192389006,
              "temporal_smoothness": "0.99677974",
              "pred_sparsity": 0.01150405072208524,
              "gt_sparsity": 0.014346600915815428,
              "sparsity_similarity": 0.9971574498062699
            },
            "3s": {
              "num_sequences": 2839,
              "total_frames": 2839,
              "horizon_frames": 3,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.3752883982546148,
              "ivt_i_mAP": 0.7683114884917305,
              "ivt_v_mAP": 0.53829392854935,
              "ivt_t_mAP": 0.5043697267287403,
              "ivt_iv_mAP": 0.35903473130931457,
              "ivt_it_mAP": 0.44994433628784136,
              "exact_match_rate": 0.3712574850299401,
              "hamming_accuracy": 0.989513913349771,
              "action_consistency": 0.9971282593375617,
              "temporal_smoothness": "0.9971727",
              "pred_sparsity": 0.0118562874251497,
              "gt_sparsity": 0.014346600915815428,
              "sparsity_similarity": 0.9975096865093342
            },
            "5s": {
              "num_sequences": 2839,
              "total_frames": 2839,
              "horizon_frames": 5,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.3442538787373423,
              "ivt_i_mAP": 0.7222750342431205,
              "ivt_v_mAP": 0.4903252400977278,
              "ivt_t_mAP": 0.477055304809388,
              "ivt_iv_mAP": 0.3403785964694145,
              "ivt_it_mAP": 0.41309924596847064,
              "exact_match_rate": 0.35258893976752376,
              "hamming_accuracy": 0.9890031701303276,
              "action_consistency": 0.9977343199436223,
              "temporal_smoothness": "0.99760866",
              "pred_sparsity": 0.012317717506164142,
              "gt_sparsity": 0.014346600915815428,
              "sparsity_similarity": 0.9979711165903488
            },
            "10s": {
              "num_sequences": 2839,
              "total_frames": 2839,
              "horizon_frames": 10,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.29173048721736977,
              "ivt_i_mAP": 0.6529048051783165,
              "ivt_v_mAP": 0.4200126481750095,
              "ivt_t_mAP": 0.4037084324477316,
              "ivt_iv_mAP": 0.31140407779699614,
              "ivt_it_mAP": 0.3470870304434124,
              "exact_match_rate": 0.3141951391334977,
              "hamming_accuracy": 0.9879006692497359,
              "action_consistency": 0.9980796335447498,
              "temporal_smoothness": "0.9979268",
              "pred_sparsity": 0.012588939767523776,
              "gt_sparsity": 0.014346600915815428,
              "sparsity_similarity": 0.9982423388517083
            },
            "20s": {
              "num_sequences": 2839,
              "total_frames": 2839,
              "horizon_frames": 20,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.22487408365924272,
              "ivt_i_mAP": 0.5608972883437964,
              "ivt_v_mAP": 0.34734091440851067,
              "ivt_t_mAP": 0.3232500531207781,
              "ivt_iv_mAP": 0.25443853402950223,
              "ivt_it_mAP": 0.2679779509834349,
              "exact_match_rate": 0.27932370553011626,
              "hamming_accuracy": 0.9863543501232829,
              "action_consistency": 0.9976215644820295,
              "temporal_smoothness": "0.99756575",
              "pred_sparsity": 0.013332159210989784,
              "gt_sparsity": 0.014346600915815428,
              "sparsity_similarity": 0.9989855582951743
            }
          }
        },
        "VID06": {
          "video_id": "VID06",
          "horizon_results": {
            "1s": {
              "num_sequences": 2153,
              "total_frames": 2153,
              "horizon_frames": 1,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.5186098491337213,
              "ivt_i_mAP": 0.9057932539177602,
              "ivt_v_mAP": 0.6769847753941344,
              "ivt_t_mAP": 0.606988057560449,
              "ivt_iv_mAP": 0.48280229143934744,
              "ivt_it_mAP": 0.5736306987039306,
              "exact_match_rate": 0.3947979563399907,
              "hamming_accuracy": 0.9906177426846261,
              "action_consistency": 0.9968122676579926,
              "temporal_smoothness": "0.99639",
              "pred_sparsity": 0.014458894565722248,
              "gt_sparsity": 0.01740362285183465,
              "sparsity_similarity": 0.9970552717138876
            },
            "2s": {
              "num_sequences": 2153,
              "total_frames": 2153,
              "horizon_frames": 2,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.45209719819240163,
              "ivt_i_mAP": 0.8894148988757412,
              "ivt_v_mAP": 0.6330652723786635,
              "ivt_t_mAP": 0.5668388831956708,
              "ivt_iv_mAP": 0.42950319624305733,
              "ivt_it_mAP": 0.5044725981183952,
              "exact_match_rate": 0.3892243381328379,
              "hamming_accuracy": 0.990190431955411,
              "action_consistency": 0.9973791821561339,
              "temporal_smoothness": "0.99715483",
              "pred_sparsity": 0.015239201114723641,
              "gt_sparsity": 0.01740362285183465,
              "sparsity_similarity": 0.997835578262889
            },
            "3s": {
              "num_sequences": 2153,
              "total_frames": 2153,
              "horizon_frames": 3,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.40653888136436084,
              "ivt_i_mAP": 0.8673693397745869,
              "ivt_v_mAP": 0.5880759643406914,
              "ivt_t_mAP": 0.5363809208560875,
              "ivt_iv_mAP": 0.3967578349780439,
              "ivt_it_mAP": 0.46515065115251353,
              "exact_match_rate": 0.37807710171853226,
              "hamming_accuracy": 0.9898188574082676,
              "action_consistency": 0.9978113382899628,
              "temporal_smoothness": "0.9976594",
              "pred_sparsity": 0.015555039479795633,
              "gt_sparsity": 0.01740362285183465,
              "sparsity_similarity": 0.998151416627961
            },
            "5s": {
              "num_sequences": 2153,
              "total_frames": 2153,
              "horizon_frames": 5,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.3464269275370916,
              "ivt_i_mAP": 0.8223859554020491,
              "ivt_v_mAP": 0.5485403812722061,
              "ivt_t_mAP": 0.48117109413207526,
              "ivt_iv_mAP": 0.3639085625031262,
              "ivt_it_mAP": 0.40063436031649585,
              "exact_match_rate": 0.35438922433813286,
              "hamming_accuracy": 0.9892057594054807,
              "action_consistency": 0.9984711895910781,
              "temporal_smoothness": "0.99819607",
              "pred_sparsity": 0.015843009753831863,
              "gt_sparsity": 0.01740362285183465,
              "sparsity_similarity": 0.9984393869019972
            },
            "10s": {
              "num_sequences": 2153,
              "total_frames": 2153,
              "horizon_frames": 10,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.2902512018122206,
              "ivt_i_mAP": 0.7299455572263,
              "ivt_v_mAP": 0.5039562533038064,
              "ivt_t_mAP": 0.4006576220672162,
              "ivt_iv_mAP": 0.33331043759388107,
              "ivt_it_mAP": 0.3277081071969499,
              "exact_match_rate": 0.2916860195076637,
              "hamming_accuracy": 0.9878169995355318,
              "action_consistency": 0.9984944237918215,
              "temporal_smoothness": "0.9984364",
              "pred_sparsity": 0.016079888527635856,
              "gt_sparsity": 0.01740362285183465,
              "sparsity_similarity": 0.9986762656758013
            },
            "20s": {
              "num_sequences": 2153,
              "total_frames": 2153,
              "horizon_frames": 20,
              "avg_frames_per_sequence": 1.0,
              "ivt_mAP": 0.23045320140079567,
              "ivt_i_mAP": 0.6199436690750465,
              "ivt_v_mAP": 0.4573016124796475,
              "ivt_t_mAP": 0.3394097629210186,
              "ivt_iv_mAP": 0.3082623627514523,
              "ivt_it_mAP": 0.25455142277665305,
              "exact_match_rate": 0.2215513237343242,
              "hamming_accuracy": 0.9861216906641895,
              "action_consistency": 0.9983271375464684,
              "temporal_smoothness": "0.99813986",
              "pred_sparsity": 0.016256386437529028,
              "gt_sparsity": 0.01738039944263818,
              "sparsity_similarity": 0.9988759869948909
            }
          }
        }
      },
      "evaluation_settings": {
        "context_length": 20,
        "temperature": 0.1,
        "planning_horizons": {
          "1s": 1,
          "2s": 2,
          "3s": 3,
          "5s": 5,
          "10s": 10,
          "20s": 20
        },
        "num_videos": 2
      }
    },
    "best_model_paths": {}
  },
  "method_4_irl_enhancement": {
    "status": "skipped",
    "reason": "IRL Enhancement disabled in config"
  },
  "comprehensive_evaluation": {
    "status": "failed",
    "error": "No models loaded",
    "fix_applied": "attempted_but_no_models"
  },
  "generated_plots": {
    "performance_dashboard": "results/2025-07-05_12-53-42/fold0/publication_plots/performance_dashboard.png"
  }
}