{
  "experiment_name": "debug_rl_2025-06-17_17-59-26",
  "experiment_type": "rl_debugging_and_optimization",
  "config": {
    "debug": false,
    "experiment": {
      "train": {
        "max_videos": 40
      },
      "test": {
        "max_videos": 10,
        "test_on_train": false
      },
      "autoregressive_il": {
        "enabled": true,
        "il_model_path": null
      },
      "world_model": {
        "enabled": true,
        "wm_model_path": null
      },
      "rl_experiments": {
        "enabled": true,
        "eval_episodes": 10,
        "debugging_enabled": true,
        "simplified_rewards": true
      }
    },
    "training": {
      "epochs": 3,
      "batch_size": 16,
      "learning_rate": 0.0001,
      "log_every_n_steps": 50,
      "scheduler": {
        "type": "cosine",
        "warmup_steps": 100
      },
      "weight_decay": 0.01,
      "gradient_clip_val": 1.0,
      "dropout": 0.1,
      "num_workers": 4,
      "pin_memory": true,
      "log_dir": "logs",
      "checkpoint_dir": "checkpoints",
      "eval_epoch_interval": 1,
      "save_model": true
    },
    "evaluation": {
      "prediction_horizon": 15,
      "supervised": {
        "action_prediction": true
      },
      "rl": {
        "rollout_horizon": 15,
        "use_best_actions": true,
        "debug_action_thresholds": true
      },
      "comparison": {
        "statistical_tests": true,
        "effect_size_threshold": 0.2
      },
      "world_model": {
        "use_memory": false,
        "overall_horizon": 1
      }
    },
    "rl_training": {
      "action_space_type": "continuous",
      "outcome_based_rewards": false,
      "rl_horizon": 20,
      "reward_mode": "simplified_expert_matching",
      "normalize_rewards": true,
      "early_termination": true,
      "timesteps": 30000,
      "reward_weights": {
        "expert_f1_score": 100.0,
        "action_sparsity_matching": 5.0,
        "completion_bonus": 2.0,
        "world_model_rewards": 0.0,
        "phase_completion": 0.0,
        "risk_penalty": 0.0,
        "consistency_bonus": 0.0
      },
      "ppo": {
        "learning_rate": "3e-5",
        "n_steps": 256,
        "batch_size": 64,
        "n_epochs": 10,
        "gamma": 0.99,
        "gae_lambda": 0.95,
        "clip_range": 0.2,
        "ent_coef": 0.01,
        "vf_coef": 0.5,
        "max_grad_norm": 0.5
      },
      "a2c": {
        "learning_rate": "1e-4",
        "n_steps": 128,
        "gamma": 0.99,
        "gae_lambda": 0.95,
        "ent_coef": 0.01,
        "vf_coef": 0.25,
        "max_grad_norm": 0.5
      }
    },
    "data": {
      "context_length": 20,
      "train_shift": 1,
      "padding_value": 0.0,
      "max_horizon": 15,
      "paths": {
        "data_dir": "/home/maxboels/datasets/CholecT50",
        "class_labels_file_path": "./data/labels.json",
        "fold": 0,
        "metadata_file": "embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv",
        "video_global_outcome_file": "embeddings_f0_swin_bas_129_with_enhanced_global_metrics.csv"
      },
      "frame_risk_agg": "max"
    },
    "training_mode": "rl_debugging",
    "preprocess": {
      "extract_rewards": false,
      "analyze_rewards": false,
      "rewards": {
        "grounded": {
          "phase_completion": false,
          "phase_transition": false,
          "phase_progression": false,
          "global_progression": false
        },
        "imitation": {
          "action_distribution": true
        },
        "expert_knowledge": {
          "risk_score": false,
          "frame_risk_agg": "max"
        }
      }
    },
    "models": {
      "autoregressive_il": {
        "hidden_dim": 768,
        "embedding_dim": 1024,
        "n_layer": 6,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.1,
        "max_length": 1024
      },
      "conditional_world_model": {
        "hidden_dim": 512,
        "embedding_dim": 1024,
        "action_embedding_dim": 128,
        "n_layer": 4,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.1,
        "max_sequence_length": 512
      }
    },
    "fair_evaluation": {
      "enabled": true,
      "include_traditional_metrics": true,
      "include_clinical_metrics": false,
      "clinical_outcome_weights": {
        "phase_progression": 0.0,
        "innovation": 0.0
      }
    },
    "supervised_learning": {
      "data_augmentation": false
    },
    "research_comparison": {
      "methods": [
        "autoregressive_il",
        "simplified_world_model_rl",
        "simplified_direct_video_rl"
      ]
    },
    "advanced": {
      "mixed_precision": false
    },
    "hardware": {
      "persistent_workers": true
    },
    "rl_debugging": {
      "enabled": true,
      "save_training_curves": true,
      "monitor_expert_matching": true,
      "log_action_distributions": true,
      "convergence_analysis": true,
      "world_model_quality_evaluation": true,
      "action_space_analysis": true,
      "threshold_optimization": true,
      "episode_log_frequency": 10,
      "eval_frequency": 500,
      "detailed_action_logging": true,
      "reward_component_tracking": true,
      "reward_improvement_threshold": 0.05,
      "expert_matching_threshold": 0.3,
      "mAP_target_threshold": 0.05,
      "debug_dir": "rl_debug",
      "plot_dir": "rl_plots",
      "analysis_dir": "rl_analysis",
      "create_interactive_plots": true,
      "save_training_videos": false,
      "plot_update_frequency": 1000,
      "compare_with_supervised": true,
      "supervised_baseline_path": null,
      "test_action_thresholds": [
        0.3,
        0.4,
        0.5,
        0.6,
        0.7
      ],
      "action_density_target_range": [
        1,
        3
      ],
      "expert_matching_metrics": [
        "f1",
        "precision",
        "recall",
        "mAP"
      ],
      "focus_on_positive_actions": true,
      "early_stopping": {
        "enabled": true,
        "patience": 5000,
        "min_improvement": 0.01
      },
      "simplified_environment": {
        "use_simplified_rewards": true,
        "remove_complex_reward_components": true,
        "focus_only_expert_matching": true,
        "action_sparsity_enforcement": true
      }
    }
  },
  "timestamp": "2025-06-17_17-59-26",
  "results_dir": "results/debug_rl_2025-06-17_17-59-26",
  "method_1_supervised_baseline": {
    "status": "success",
    "model_path": "results/debug_rl_2025-06-17_17-59-26/logs/checkpoints/autoregressive_il_best_epoch_1.pt",
    "model_type": "AutoregressiveILModel",
    "approach": "Supervised IL baseline (trained)",
    "evaluation": {
      "overall_metrics": {
        "frame_loss": 0.16108230676514762,
        "total_loss": 0.6612100793175357,
        "action_loss": 0.039542350168644665,
        "phase_loss": 0.8420861472277192,
        "action_mAP": 0.4832534088922885,
        "action_mAP_standard": 0.8178338853083111,
        "action_mAP_freq_weighted": 0.7464597560064721,
        "action_exact_match": 0.4739990635821922,
        "action_hamming_accuracy": 0.991179879963737,
        "action_precision": 0.8690849104258136,
        "action_recall": 0.8162554396475554,
        "action_f1": 0.8402172142111649,
        "action_sparsity": 0.7308510638297873,
        "num_actions_present": 25.3,
        "action_mAP_with_null_verb": 0.4382424510709407,
        "action_exact_match_with_null_verb": 0.423839141560254,
        "action_sparsity_with_null_verb": 0.7030000000000001,
        "num_actions_total": 94.0,
        "num_actions_total_with_null_verb": 100.0,
        "action_mAP_std": 0.10235823224464627,
        "action_exact_match_std": 0.03572895015779896,
        "action_sparsity_std": 0.05729886387019247
      },
      "detailed_video_metrics": {
        "VID02": {
          "mAP": 0.4227273945544991,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 28,
            "subset_action_sparsity": 0.7021276595744681
          },
          "mAP_standard_with_null_verb": 0.7118385391937743,
          "mAP_present_only_with_null_verb": 0.3877604093934542,
          "mAP_freq_weighted_with_null_verb": 0.679534091328445,
          "mAP_sample_wise_with_null_verb": 0.7175236474992567,
          "mAP_standard_all_actions": 0.7118385391937743,
          "mAP_present_only_all_actions": 0.3877604093934542,
          "mAP_freq_weighted_all_actions": 0.679534091328445,
          "mAP_sample_wise_all_actions": 0.7175236474992567,
          "exact_match_with_null_verb": 0.39203945051074324,
          "hamming_accuracy_with_null_verb": 0.989940119760479,
          "precision_with_null_verb": 0.8423665821396078,
          "recall_with_null_verb": 0.768072812579228,
          "f1_with_null_verb": 0.800541296006448,
          "num_predictions": 2839,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 34,
          "action_sparsity_with_null_verb": 0.6599999999999999,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID02_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.7429400749736806,
          "mAP_present_only": 0.4227273945544991,
          "mAP_freq_weighted": 0.7013145868208173,
          "exact_match": 0.4216273335681578,
          "hamming_accuracy": 0.9905308282059161,
          "precision": 0.8554852857724133,
          "recall": 0.7796831315525448,
          "f1": 0.8129067508090295,
          "num_actions_total": 94,
          "num_actions_present": 28,
          "action_sparsity": 0.7021276595744681
        },
        "VID06": {
          "mAP": 0.5843569372169051,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 26,
            "subset_action_sparsity": 0.7234042553191489
          },
          "mAP_standard_with_null_verb": 0.849152206822453,
          "mAP_present_only_with_null_verb": 0.5305073560748436,
          "mAP_freq_weighted_with_null_verb": 0.7666261672386763,
          "mAP_sample_wise_with_null_verb": 0.8266640660372061,
          "mAP_standard_all_actions": 0.849152206822453,
          "mAP_present_only_all_actions": 0.5305073560748436,
          "mAP_freq_weighted_all_actions": 0.7666261672386763,
          "mAP_sample_wise_all_actions": 0.8266640660372061,
          "exact_match_with_null_verb": 0.3878309335810497,
          "hamming_accuracy_with_null_verb": 0.9905805852299118,
          "precision_with_null_verb": 0.8860461982342703,
          "recall_with_null_verb": 0.8190399090530691,
          "f1_with_null_verb": 0.8492314017770264,
          "num_predictions": 2153,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 30,
          "action_sparsity_with_null_verb": 0.7,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID06_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.8743965996557396,
          "mAP_present_only": 0.5843569372169051,
          "mAP_freq_weighted": 0.8061547342532853,
          "exact_match": 0.45935903390617744,
          "hamming_accuracy": 0.9914122797481989,
          "precision": 0.8907042675542542,
          "recall": 0.8408350944676135,
          "f1": 0.8640022331260868,
          "num_actions_total": 94,
          "num_actions_present": 26,
          "action_sparsity": 0.7234042553191489
        },
        "VID111": {
          "mAP": 0.4534369500850264,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 25,
            "subset_action_sparsity": 0.7340425531914894
          },
          "mAP_standard_with_null_verb": 0.8002170726593522,
          "mAP_present_only_with_null_verb": 0.41454162985983484,
          "mAP_freq_weighted_with_null_verb": 0.5819039811219429,
          "mAP_sample_wise_with_null_verb": 0.685829298419381,
          "mAP_standard_all_actions": 0.8002170726593522,
          "mAP_present_only_all_actions": 0.41454162985983484,
          "mAP_freq_weighted_all_actions": 0.5819039811219429,
          "mAP_sample_wise_all_actions": 0.685829298419381,
          "exact_match_with_null_verb": 0.4386946386946387,
          "hamming_accuracy_with_null_verb": 0.989030303030303,
          "precision_with_null_verb": 0.7779101023107846,
          "recall_with_null_verb": 0.7336435339782993,
          "f1_with_null_verb": 0.7537957468899605,
          "num_predictions": 2145,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 29,
          "action_sparsity_with_null_verb": 0.71,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID111_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.8227225931077199,
          "mAP_present_only": 0.4534369500850264,
          "mAP_freq_weighted": 0.6298220725772506,
          "exact_match": 0.5039627039627039,
          "hamming_accuracy": 0.990641273619997,
          "precision": 0.786429003416862,
          "recall": 0.77403015808095,
          "f1": 0.7800881906583279,
          "num_actions_total": 94,
          "num_actions_present": 25,
          "action_sparsity": 0.7340425531914894
        },
        "VID14": {
          "mAP": 0.300790757470945,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 36,
            "subset_action_sparsity": 0.6170212765957447
          },
          "mAP_standard_with_null_verb": 0.6967892754302281,
          "mAP_present_only_with_null_verb": 0.28485189129323907,
          "mAP_freq_weighted_with_null_verb": 0.6672444382900924,
          "mAP_sample_wise_with_null_verb": 0.7451543812736335,
          "mAP_standard_all_actions": 0.6967892754302281,
          "mAP_present_only_all_actions": 0.28485189129323907,
          "mAP_freq_weighted_all_actions": 0.6672444382900924,
          "mAP_sample_wise_all_actions": 0.7451543812736335,
          "exact_match_with_null_verb": 0.4098360655737705,
          "hamming_accuracy_with_null_verb": 0.9902049180327869,
          "precision_with_null_verb": 0.8712953090446854,
          "recall_with_null_verb": 0.7742705480348033,
          "f1_with_null_verb": 0.8152341632291089,
          "num_predictions": 1708,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 41,
          "action_sparsity_with_null_verb": 0.5900000000000001,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID14_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.7322177369037661,
          "mAP_present_only": 0.300790757470945,
          "mAP_freq_weighted": 0.692121122894369,
          "exact_match": 0.4601873536299766,
          "hamming_accuracy": 0.9907755742687727,
          "precision": 0.8792846512356689,
          "recall": 0.7894088881446957,
          "f1": 0.8280948895976314,
          "num_actions_total": 94,
          "num_actions_present": 36,
          "action_sparsity": 0.6170212765957447
        },
        "VID23": {
          "mAP": 0.4433903171266928,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 26,
            "subset_action_sparsity": 0.7234042553191489
          },
          "mAP_standard_with_null_verb": 0.7414711109268687,
          "mAP_present_only_with_null_verb": 0.3918422933124801,
          "mAP_freq_weighted_with_null_verb": 0.6442007205608824,
          "mAP_sample_wise_with_null_verb": 0.7232448477686693,
          "mAP_standard_all_actions": 0.7414711109268687,
          "mAP_present_only_all_actions": 0.3918422933124801,
          "mAP_freq_weighted_all_actions": 0.6442007205608824,
          "mAP_sample_wise_all_actions": 0.7232448477686693,
          "exact_match_with_null_verb": 0.37370030581039754,
          "hamming_accuracy_with_null_verb": 0.9889174311926605,
          "precision_with_null_verb": 0.8432673874443171,
          "recall_with_null_verb": 0.7665386347849257,
          "f1_with_null_verb": 0.7998902444644123,
          "num_predictions": 1635,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 31,
          "action_sparsity_with_null_verb": 0.69,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID23_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.7822143430350428,
          "mAP_present_only": 0.4433903171266928,
          "mAP_freq_weighted": 0.679180889451118,
          "exact_match": 0.45932721712538227,
          "hamming_accuracy": 0.9900123625479862,
          "precision": 0.8551782382426062,
          "recall": 0.7886578736339738,
          "f1": 0.8183546050957794,
          "num_actions_total": 94,
          "num_actions_present": 26,
          "action_sparsity": 0.7234042553191489
        },
        "VID25": {
          "mAP": 0.6329290941446859,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 21,
            "subset_action_sparsity": 0.7765957446808511
          },
          "mAP_standard_with_null_verb": 0.8396452612586874,
          "mAP_present_only_with_null_verb": 0.5370971586872586,
          "mAP_freq_weighted_with_null_verb": 0.7640455316401673,
          "mAP_sample_wise_with_null_verb": 0.8036128051056965,
          "mAP_standard_all_actions": 0.8396452612586874,
          "mAP_present_only_all_actions": 0.5370971586872586,
          "mAP_freq_weighted_all_actions": 0.7640455316401673,
          "mAP_sample_wise_all_actions": 0.8036128051056965,
          "exact_match_with_null_verb": 0.4199154532644434,
          "hamming_accuracy_with_null_verb": 0.9908783466416158,
          "precision_with_null_verb": 0.8851525042235711,
          "recall_with_null_verb": 0.8140871456301477,
          "f1_with_null_verb": 0.8458711763521074,
          "num_predictions": 2129,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 26,
          "action_sparsity_with_null_verb": 0.74,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID25_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.886079904011047,
          "mAP_present_only": 0.6329290941446859,
          "mAP_freq_weighted": 0.8042985713134121,
          "exact_match": 0.46312822921559416,
          "hamming_accuracy": 0.9915353327403735,
          "precision": 0.8901233179784618,
          "recall": 0.8324667451366292,
          "f1": 0.8589075350849666,
          "num_actions_total": 94,
          "num_actions_present": 21,
          "action_sparsity": 0.7765957446808511
        },
        "VID50": {
          "mAP": 0.5316354111948748,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 16,
            "subset_action_sparsity": 0.8297872340425532
          },
          "mAP_standard_with_null_verb": 0.8976592220297028,
          "mAP_present_only_with_null_verb": 0.4869956779427945,
          "mAP_freq_weighted_with_null_verb": 0.7494715843478659,
          "mAP_sample_wise_with_null_verb": 0.8326600369323477,
          "mAP_standard_all_actions": 0.8976592220297028,
          "mAP_present_only_all_actions": 0.4869956779427945,
          "mAP_freq_weighted_all_actions": 0.7494715843478659,
          "mAP_sample_wise_all_actions": 0.8326600369323477,
          "exact_match_with_null_verb": 0.4716636197440585,
          "hamming_accuracy_with_null_verb": 0.9915265082266911,
          "precision_with_null_verb": 0.8845435871324896,
          "recall_with_null_verb": 0.8405540066088393,
          "f1_with_null_verb": 0.8611629357633326,
          "num_predictions": 1094,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 18,
          "action_sparsity_with_null_verb": 0.8200000000000001,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID50_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.9096400699906171,
          "mAP_present_only": 0.5316354111948748,
          "mAP_freq_weighted": 0.7821104620185436,
          "exact_match": 0.5146252285191956,
          "hamming_accuracy": 0.9921914504648177,
          "precision": 0.892008034832438,
          "recall": 0.8591255015364312,
          "f1": 0.8748191319657148,
          "num_actions_total": 94,
          "num_actions_present": 16,
          "action_sparsity": 0.8297872340425532
        },
        "VID51": {
          "mAP": 0.47861895144205713,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 24,
            "subset_action_sparsity": 0.7446808510638299
          },
          "mAP_standard_with_null_verb": 0.7793055043448471,
          "mAP_present_only_with_null_verb": 0.4458810494649899,
          "mAP_freq_weighted_with_null_verb": 0.6920613213452977,
          "mAP_sample_wise_with_null_verb": 0.745399609507429,
          "mAP_standard_all_actions": 0.7793055043448471,
          "mAP_present_only_all_actions": 0.4458810494649899,
          "mAP_freq_weighted_all_actions": 0.6920613213452977,
          "mAP_sample_wise_all_actions": 0.745399609507429,
          "exact_match_with_null_verb": 0.37839673913043476,
          "hamming_accuracy_with_null_verb": 0.989296875,
          "precision_with_null_verb": 0.8316150660508118,
          "recall_with_null_verb": 0.7872193927547272,
          "f1_with_null_verb": 0.8077634648573286,
          "num_predictions": 2944,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 29,
          "action_sparsity_with_null_verb": 0.71,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID51_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.8136899450490359,
          "mAP_present_only": 0.47861895144205713,
          "mAP_freq_weighted": 0.7297244545017757,
          "exact_match": 0.43240489130434784,
          "hamming_accuracy": 0.9906806487049029,
          "precision": 0.8513792118895265,
          "recall": 0.8037534270098019,
          "f1": 0.8257735567919096,
          "num_actions_total": 94,
          "num_actions_present": 24,
          "action_sparsity": 0.7446808510638299
        },
        "VID66": {
          "mAP": 0.6151784935268716,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 20,
            "subset_action_sparsity": 0.7872340425531915
          },
          "mAP_standard_with_null_verb": 0.8281694895641567,
          "mAP_present_only_with_null_verb": 0.5572586502789415,
          "mAP_freq_weighted_with_null_verb": 0.8423975106263881,
          "mAP_sample_wise_with_null_verb": 0.8434871151946671,
          "mAP_standard_all_actions": 0.8281694895641567,
          "mAP_present_only_all_actions": 0.5572586502789415,
          "mAP_freq_weighted_all_actions": 0.8423975106263881,
          "mAP_sample_wise_all_actions": 0.8434871151946671,
          "exact_match_with_null_verb": 0.5213815789473685,
          "hamming_accuracy_with_null_verb": 0.9927850877192983,
          "precision_with_null_verb": 0.9035283239557073,
          "recall_with_null_verb": 0.8531248671501968,
          "f1_with_null_verb": 0.8765874393465689,
          "num_predictions": 1824,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 23,
          "action_sparsity_with_null_verb": 0.77,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID66_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.8755698922397599,
          "mAP_present_only": 0.6151784935268716,
          "mAP_freq_weighted": 0.8650381550785496,
          "exact_match": 0.5444078947368421,
          "hamming_accuracy": 0.9932052538260545,
          "precision": 0.9137978819190341,
          "recall": 0.8643939275720962,
          "f1": 0.8874702249271991,
          "num_actions_total": 94,
          "num_actions_present": 20,
          "action_sparsity": 0.7872340425531915
        },
        "VID79": {
          "mAP": 0.369469782160327,
          "mAP_info": {
            "calculated_from": "subset_excluding_last_classes_present_actions_only",
            "excluded_classes": 6,
            "subset_size": 94,
            "present_actions_in_subset": 31,
            "subset_action_sparsity": 0.6702127659574468
          },
          "mAP_standard_with_null_verb": 0.7144478219845651,
          "mAP_present_only_with_null_verb": 0.34568839440157023,
          "mAP_freq_weighted_with_null_verb": 0.7484636322995448,
          "mAP_sample_wise_with_null_verb": 0.7709494029955233,
          "mAP_standard_all_actions": 0.7144478219845651,
          "mAP_present_only_all_actions": 0.34568839440157023,
          "mAP_freq_weighted_all_actions": 0.7484636322995448,
          "mAP_sample_wise_all_actions": 0.7709494029955233,
          "exact_match_with_null_verb": 0.4449326303456356,
          "hamming_accuracy_with_null_verb": 0.9903661394258934,
          "precision_with_null_verb": 0.8684659143410915,
          "recall_with_null_verb": 0.820096185531789,
          "f1_with_null_verb": 0.8425144049068956,
          "num_predictions": 3414,
          "num_actions_total_with_null_verb": 100,
          "num_actions_present_with_null_verb": 36,
          "action_sparsity_with_null_verb": 0.64,
          "task": "single_step_action_prediction",
          "method_name": "AutoregressiveIL_video_VID79_epoch_-1",
          "exclude_last_n": 6,
          "mAP_standard": 0.7388676941167035,
          "mAP_present_only": 0.369469782160327,
          "mAP_freq_weighted": 0.7748325111556003,
          "exact_match": 0.48096074985354426,
          "hamming_accuracy": 0.9908137955103516,
          "precision": 0.8764592114168706,
          "recall": 0.8301996493408184,
          "f1": 0.8517550240550047,
          "num_actions_total": 94,
          "num_actions_present": 31,
          "action_sparsity": 0.6702127659574468
        }
      },
      "video_loss_metrics": {
        "VID02": {
          "frame_loss": 0.16291662732536874,
          "action_loss": 0.043726734694767434,
          "phase_loss": 0.6448742613720866,
          "total_loss": 0.5728072269578998
        },
        "VID06": {
          "frame_loss": 0.1609211144072038,
          "action_loss": 0.03561532794954945,
          "phase_loss": 0.5722418356702688,
          "total_loss": 0.5182726869428599
        },
        "VID111": {
          "frame_loss": 0.1540702751242659,
          "action_loss": 0.03652721883241881,
          "phase_loss": 1.612416477860124,
          "total_loss": 1.0333329507322222
        },
        "VID14": {
          "frame_loss": 0.17073413867081264,
          "action_loss": 0.04454913756931984,
          "phase_loss": 1.5145566619633408,
          "total_loss": 1.0171107449960486
        },
        "VID23": {
          "frame_loss": 0.1794086606106133,
          "action_loss": 0.05488936562606504,
          "phase_loss": 1.3030923642567358,
          "total_loss": 0.9407335645293148
        },
        "VID25": {
          "frame_loss": 0.1584530435780536,
          "action_loss": 0.03619675800628237,
          "phase_loss": 0.9735064674523723,
          "total_loss": 0.7175997926005676
        },
        "VID50": {
          "frame_loss": 0.14822682651920596,
          "action_loss": 0.03399002184227541,
          "phase_loss": 0.24439853096282332,
          "total_loss": 0.33840613617845205
        },
        "VID51": {
          "frame_loss": 0.145768395928747,
          "action_loss": 0.04487680803693998,
          "phase_loss": 0.9284287470257825,
          "total_loss": 0.6997363866185364
        },
        "VID66": {
          "frame_loss": 0.16032470102634347,
          "action_loss": 0.024194472122951737,
          "phase_loss": 0.25573705112674977,
          "total_loss": 0.33658216802174584
        },
        "VID79": {
          "frame_loss": 0.1699992844608621,
          "action_loss": 0.04085765700587659,
          "phase_loss": 0.37160907458690806,
          "total_loss": 0.4375191355977103
        }
      },
      "generation_quality": {
        "frame_smoothness": 0.8908082445462545,
        "action_diversity": 0.0007027284009382129
      },
      "model_type": "AutoregressiveIL",
      "evaluation_approach": "per_video_aggregation",
      "num_videos_evaluated": 10,
      "evaluation_summary": {
        "best_metric": "action_mAP",
        "best_value": 0.4832534088922885,
        "best_value_std": 0.0,
        "strength": "Causal frame generation and action prediction",
        "architecture": "Autoregressive (no action conditioning)",
        "aggregation_method": "per_video_then_average"
      },
      "performance_analysis": {
        "summary_stats": {
          "num_videos": 10,
          "mAP_stats": {
            "mean": 0.4832534088922885,
            "std": 0.10235823224464627,
            "min": 0.300790757470945,
            "max": 0.6329290941446859,
            "median": 0.46602795076354175,
            "q25": 0.4278931251975475,
            "q75": 0.5711765557113975
          },
          "sparsity_stats": {
            "mean": 0.7308510638297873,
            "std": 0.05729886387019247,
            "correlation_with_mAP": 0.8161020605330047
          }
        },
        "performance_categories": {
          "high_performers": [
            "VID25",
            "VID66"
          ],
          "low_performers": [
            "VID14",
            "VID79"
          ],
          "consistent_performers": [
            "VID02",
            "VID06",
            "VID111",
            "VID23",
            "VID50",
            "VID51"
          ]
        },
        "detailed_rankings": [
          [
            "VID25",
            0.6329290941446859
          ],
          [
            "VID66",
            0.6151784935268716
          ],
          [
            "VID06",
            0.5843569372169051
          ],
          [
            "VID50",
            0.5316354111948748
          ],
          [
            "VID51",
            0.47861895144205713
          ],
          [
            "VID111",
            0.4534369500850264
          ],
          [
            "VID23",
            0.4433903171266928
          ],
          [
            "VID02",
            0.4227273945544991
          ],
          [
            "VID79",
            0.369469782160327
          ],
          [
            "VID14",
            0.300790757470945
          ]
        ]
      }
    },
    "baseline_mAP": 0.4832534088922885,
    "method_description": "Supervised imitation learning baseline for comparison"
  },
  "method_2_world_model_debug": {
    "status": "success",
    "world_model_path": "results/debug_rl_2025-06-17_17-59-26/logs/checkpoints/world_model_best_epoch_2.pt",
    "world_model_evaluation": {
      "overall_metrics": {
        "state_loss": 0.14214506833514748,
        "reward_risk_penalty_loss": 0.18755190026658777,
        "reward_phase_completion_loss": 0.011133313870210586,
        "reward_phase_initiation_loss": 0.015768395986452022,
        "reward_phase_progression_loss": 0.06564051642552579,
        "reward_action_probability_loss": 0.017105545790489764,
        "total_reward_loss": 0.05943993503138032,
        "phase_loss": 0.7998731144029023,
        "total_loss": 0.9452516286669969
      },
      "model_type": "ConditionalWorldModel",
      "evaluation_summary": {
        "best_metric": "state_loss",
        "best_value": 0.14214506833514748,
        "strength": "Action-conditioned state-reward prediction",
        "architecture": "ConditionalWorldModel with action conditioning"
      }
    },
    "world_model_analysis": {
      "state_prediction_accuracy": [
        Infinity,
        Infinity,
        Infinity
      ],
      "reward_prediction_accuracy": [
        0.0,
        0.0,
        0.0
      ],
      "action_conditioning_quality": [
        0.0,
        0.0,
        0.0
      ],
      "temporal_consistency": [
        0.0,
        0.0,
        0.0
      ],
      "per_video_analysis": {
        "VID02": {
          "state_mse": Infinity,
          "reward_accuracy": 0.0,
          "action_conditioning": 0.0,
          "temporal_consistency": 0.0,
          "num_test_frames": 0
        },
        "VID06": {
          "state_mse": Infinity,
          "reward_accuracy": 0.0,
          "action_conditioning": 0.0,
          "temporal_consistency": 0.0,
          "num_test_frames": 0
        },
        "VID111": {
          "state_mse": Infinity,
          "reward_accuracy": 0.0,
          "action_conditioning": 0.0,
          "temporal_consistency": 0.0,
          "num_test_frames": 0
        }
      },
      "summary": {
        "avg_state_mse": Infinity,
        "avg_reward_accuracy": 0.0,
        "avg_action_conditioning": 0.0,
        "avg_temporal_consistency": 0.0,
        "world_model_quality_score": 0.0
      }
    },
    "simplified_rl_results": {
      "status": "failed",
      "error": "Expected env to be a `gymnasium.Env` but got <class 'rl_debugging_system.simplified_rl_trainer.SimplifiedExpertMatchingEnv'>"
    },
    "model_type": "ConditionalWorldModel + SimplifiedRL",
    "approach": "World model with comprehensive RL debugging",
    "method_description": "World model + simplified expert matching RL",
    "debugging_applied": true,
    "world_model_quality_score": 0.0
  },
  "method_3_simplified_rl": {
    "status": "failed",
    "error": "'NoneType' object has no attribute 'eval'"
  },
  "debugging_analysis": {
    "performance_comparison": {
      "supervised_baseline_mAP": 0.4832534088922885,
      "world_model_rl_mAP": 0.0,
      "direct_video_rl_mAP": 0.0,
      "supervised_vs_wm_rl_gap": 0.4832534088922885,
      "supervised_vs_direct_rl_gap": 0.4832534088922885,
      "rl_performance_relative_to_supervised": {
        "world_model_rl": 0.0,
        "direct_video_rl": 0.0
      }
    },
    "debugging_insights": {
      "main_issue": "large_rl_vs_supervised_gap"
    },
    "recommendations": [
      "Focus on reward function alignment with mAP",
      "Consider behavioral cloning warm-start for RL",
      "Validate action space conversion and thresholding",
      "Increase expert demonstration matching weight",
      "World model quality is poor - consider retraining or using direct video RL"
    ],
    "next_steps": [
      "Implement behavioral cloning initialization",
      "Simplify action space or use different action representation",
      "Validate that expert demonstrations are learnable"
    ]
  }
}