2025-06-17 17:59:26,825 - INFO - RL_Debug_Experiment_126285051913632 - Shared experiment log directory: results/debug_rl_2025-06-17_17-59-26/logs
2025-06-17 17:59:26,825 - INFO - RL_Debug_Experiment_126285051913632 - üîç RL Debugging Experiment: debug_rl_2025-06-17_17-59-26
2025-06-17 17:59:26,825 - INFO - RL_Debug_Experiment_126285051913632 - üìÅ Results dir: results/debug_rl_2025-06-17_17-59-26
2025-06-17 17:59:26,825 - INFO - RL_Debug_Experiment_126285051913632 - üéØ Focus: Understanding RL vs supervised performance gap
2025-06-17 18:00:23,010 - INFO - RL_Debug_Experiment_126285051913632 - üöÄ Starting RL Debugging Comparison
2025-06-17 18:00:23,010 - INFO - RL_Debug_Experiment_126285051913632 - ============================================================
2025-06-17 18:00:23,011 - INFO - RL_Debug_Experiment_126285051913632 - üìÇ Loading CholecT50 data for debugging...
2025-06-17 18:00:23,011 - INFO - RL_Debug_Experiment_126285051913632 -    Training videos: 40
2025-06-17 18:00:23,011 - INFO - RL_Debug_Experiment_126285051913632 -    Test videos: 10
2025-06-17 18:00:23,012 - INFO - RL_Debug_Experiment_126285051913632 - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-17 18:00:23,432 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (78968, 156)
2025-06-17 18:00:23,432 - INFO - RL_Debug_Experiment_126285051913632 - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-17 18:00:23,432 - INFO - RL_Debug_Experiment_126285051913632 - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-17 18:00:23,437 - INFO - RL_Debug_Experiment_126285051913632 - [Train] Found 40 videos in metadata file
2025-06-17 18:00:23,437 - INFO - RL_Debug_Experiment_126285051913632 - [Train] Loading data for 40 videos
2025-06-17 18:00:23,588 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID01: 1734 frames, 1024-dims embeddings
2025-06-17 18:00:23,712 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID04: 1523 frames, 1024-dims embeddings
2025-06-17 18:00:23,898 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID05: 2345 frames, 1024-dims embeddings
2025-06-17 18:00:24,089 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID08: 1520 frames, 1024-dims embeddings
2025-06-17 18:00:24,238 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID10: 1750 frames, 1024-dims embeddings
2025-06-17 18:00:24,403 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID103: 2220 frames, 1024-dims embeddings
2025-06-17 18:00:24,573 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID110: 2177 frames, 1024-dims embeddings
2025-06-17 18:00:24,668 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID12: 1091 frames, 1024-dims embeddings
2025-06-17 18:00:24,743 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID13: 982 frames, 1024-dims embeddings
2025-06-17 18:00:24,899 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID15: 2059 frames, 1024-dims embeddings
2025-06-17 18:00:25,056 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID18: 1943 frames, 1024-dims embeddings
2025-06-17 18:00:25,186 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID22: 1533 frames, 1024-dims embeddings
2025-06-17 18:00:25,320 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID26: 1774 frames, 1024-dims embeddings
2025-06-17 18:00:25,485 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID27: 2085 frames, 1024-dims embeddings
2025-06-17 18:00:25,665 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID29: 2351 frames, 1024-dims embeddings
2025-06-17 18:00:25,974 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID31: 3946 frames, 1024-dims embeddings
2025-06-17 18:00:26,134 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID32: 2117 frames, 1024-dims embeddings
2025-06-17 18:00:26,309 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID35: 2107 frames, 1024-dims embeddings
2025-06-17 18:00:26,504 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID36: 2388 frames, 1024-dims embeddings
2025-06-17 18:00:26,677 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID40: 2223 frames, 1024-dims embeddings
2025-06-17 18:00:26,999 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID42: 3713 frames, 1024-dims embeddings
2025-06-17 18:00:27,199 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID43: 2363 frames, 1024-dims embeddings
2025-06-17 18:00:27,367 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID47: 2260 frames, 1024-dims embeddings
2025-06-17 18:00:27,505 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID48: 1835 frames, 1024-dims embeddings
2025-06-17 18:00:27,635 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID49: 1672 frames, 1024-dims embeddings
2025-06-17 18:00:27,790 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID52: 1967 frames, 1024-dims embeddings
2025-06-17 18:00:27,938 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID56: 1837 frames, 1024-dims embeddings
2025-06-17 18:00:28,133 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID57: 2633 frames, 1024-dims embeddings
2025-06-17 18:00:28,324 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID60: 2533 frames, 1024-dims embeddings
2025-06-17 18:00:28,476 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID62: 2033 frames, 1024-dims embeddings
2025-06-17 18:00:28,636 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID65: 1874 frames, 1024-dims embeddings
2025-06-17 18:00:28,786 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID68: 1973 frames, 1024-dims embeddings
2025-06-17 18:00:28,882 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID70: 1195 frames, 1024-dims embeddings
2025-06-17 18:00:28,986 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID73: 1357 frames, 1024-dims embeddings
2025-06-17 18:00:29,117 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID74: 1635 frames, 1024-dims embeddings
2025-06-17 18:00:29,261 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID75: 1924 frames, 1024-dims embeddings
2025-06-17 18:00:29,320 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID78: 740 frames, 1024-dims embeddings
2025-06-17 18:00:29,454 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID80: 1725 frames, 1024-dims embeddings
2025-06-17 18:00:29,612 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID92: 2124 frames, 1024-dims embeddings
2025-06-17 18:00:29,741 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID96: 1707 frames, 1024-dims embeddings
2025-06-17 18:00:29,742 - INFO - RL_Debug_Experiment_126285051913632 - üìÇ Loaded 40 videos from train split
2025-06-17 18:00:29,742 - INFO - RL_Debug_Experiment_126285051913632 - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-17 18:00:29,835 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (21895, 156)
2025-06-17 18:00:29,835 - INFO - RL_Debug_Experiment_126285051913632 - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-17 18:00:29,835 - INFO - RL_Debug_Experiment_126285051913632 - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-17 18:00:29,836 - INFO - RL_Debug_Experiment_126285051913632 - [Test] Found 10 videos in metadata file
2025-06-17 18:00:29,836 - INFO - RL_Debug_Experiment_126285051913632 - [Test] Loading data for 10 videos
2025-06-17 18:00:30,112 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID02: 2840 frames, 1024-dims embeddings
2025-06-17 18:00:30,349 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID06: 2154 frames, 1024-dims embeddings
2025-06-17 18:00:30,512 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID111: 2146 frames, 1024-dims embeddings
2025-06-17 18:00:30,642 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID14: 1709 frames, 1024-dims embeddings
2025-06-17 18:00:30,798 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID23: 1636 frames, 1024-dims embeddings
2025-06-17 18:00:31,003 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID25: 2130 frames, 1024-dims embeddings
2025-06-17 18:00:31,087 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID50: 1095 frames, 1024-dims embeddings
2025-06-17 18:00:31,314 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID51: 2945 frames, 1024-dims embeddings
2025-06-17 18:00:31,483 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID66: 1825 frames, 1024-dims embeddings
2025-06-17 18:00:31,785 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Loaded video VID79: 3415 frames, 1024-dims embeddings
2025-06-17 18:00:31,786 - INFO - RL_Debug_Experiment_126285051913632 - üìÇ Loaded 10 videos from test split
2025-06-17 18:00:31,786 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Data loaded successfully
2025-06-17 18:00:31,786 - INFO - RL_Debug_Experiment_126285051913632 -    Training videos: 40
2025-06-17 18:00:31,786 - INFO - RL_Debug_Experiment_126285051913632 -    Test videos: 10
2025-06-17 18:00:31,786 - INFO - RL_Debug_Experiment_126285051913632 - üéì Method 1: Supervised IL Baseline
2025-06-17 18:00:31,786 - INFO - RL_Debug_Experiment_126285051913632 - ----------------------------------------
2025-06-17 18:00:31,786 - INFO - RL_Debug_Experiment_126285051913632 - üèãÔ∏è Training IL model from scratch as baseline...
2025-06-17 18:00:36,395 - INFO - RL_Debug_Experiment_126285051913632 - üéì Autoregressive IL Trainer initialized (FINAL)
2025-06-17 18:00:36,395 - INFO - RL_Debug_Experiment_126285051913632 -    Device: cuda
2025-06-17 18:00:36,395 - INFO - RL_Debug_Experiment_126285051913632 -    Epochs: 3
2025-06-17 18:00:36,395 - INFO - RL_Debug_Experiment_126285051913632 -    Learning rate: 0.0001
2025-06-17 18:00:36,395 - INFO - RL_Debug_Experiment_126285051913632 -    ‚úÖ Per-video aggregation + shared metrics + efficient validation
2025-06-17 18:00:36,395 - INFO - RL_Debug_Experiment_126285051913632 - üéì Starting Autoregressive IL Training...
2025-06-17 18:00:36,395 - INFO - RL_Debug_Experiment_126285051913632 - üéØ Goal: Learn causal frame generation ‚Üí action prediction
2025-06-17 18:00:36,395 - INFO - RL_Debug_Experiment_126285051913632 - üìä Evaluation: Per-video aggregation for robust metrics
2025-06-17 18:04:48,847 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID02 validation:    Loss: 0.5114,    Action mAP: 0.4313
2025-06-17 18:04:58,832 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID06 validation:    Loss: 0.5103,    Action mAP: 0.5912
2025-06-17 18:05:08,673 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID111 validation:    Loss: 0.8710,    Action mAP: 0.4550
2025-06-17 18:05:18,181 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID14 validation:    Loss: 0.7951,    Action mAP: 0.3135
2025-06-17 18:05:27,433 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID23 validation:    Loss: 0.9249,    Action mAP: 0.4463
2025-06-17 18:05:37,170 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID25 validation:    Loss: 0.7079,    Action mAP: 0.6612
2025-06-17 18:05:46,072 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID50 validation:    Loss: 0.3585,    Action mAP: 0.5557
2025-06-17 18:05:56,487 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID51 validation:    Loss: 0.5596,    Action mAP: 0.5101
2025-06-17 18:06:05,998 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID66 validation:    Loss: 0.3421,    Action mAP: 0.6211
2025-06-17 18:06:16,919 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID79 validation:    Loss: 0.4077,    Action mAP: 0.3895
2025-06-17 18:06:16,921 - INFO - RL_Debug_Experiment_126285051913632 - üìä Validation Summary (averaged across 10 videos):
2025-06-17 18:06:16,921 - INFO - RL_Debug_Experiment_126285051913632 -    üéØ Main mAP (surgical actions): 0.4975 ¬± 0.1043
2025-06-17 18:06:16,921 - INFO - RL_Debug_Experiment_126285051913632 -    üìä mAP with null verbs: 0.4528
2025-06-17 18:06:16,921 - INFO - RL_Debug_Experiment_126285051913632 -    üìã Actions evaluated: 25/94 surgical actions
2025-06-17 18:06:16,921 - INFO - RL_Debug_Experiment_126285051913632 -    üìà Surgical action sparsity: 0.7309
2025-06-17 18:06:16,921 - INFO - RL_Debug_Experiment_126285051913632 -    üîÑ Total Loss: 0.5989
2025-06-17 18:06:17,052 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ New best model saved: results/debug_rl_2025-06-17_17-59-26/logs/checkpoints/autoregressive_il_best_epoch_1.pt
2025-06-17 18:06:17,052 - INFO - RL_Debug_Experiment_126285051913632 - Epoch 1/3 | Train Loss: 0.3418 | Val Loss: 0.5989 | Action mAP: 0.4975¬±0.1043 (10 videos) | Frame MSE: 0.1683
2025-06-17 18:10:14,275 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID02 validation:    Loss: 0.5497,    Action mAP: 0.4252
2025-06-17 18:10:24,255 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID06 validation:    Loss: 0.4713,    Action mAP: 0.5927
2025-06-17 18:10:33,959 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID111 validation:    Loss: 0.8310,    Action mAP: 0.4588
2025-06-17 18:10:43,414 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID14 validation:    Loss: 0.9303,    Action mAP: 0.2958
2025-06-17 18:10:52,921 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID23 validation:    Loss: 0.9690,    Action mAP: 0.4339
2025-06-17 18:11:02,750 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID25 validation:    Loss: 0.6452,    Action mAP: 0.6447
2025-06-17 18:11:11,740 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID50 validation:    Loss: 0.3360,    Action mAP: 0.5364
2025-06-17 18:11:22,285 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID51 validation:    Loss: 0.5524,    Action mAP: 0.4817
2025-06-17 18:11:31,772 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID66 validation:    Loss: 0.3678,    Action mAP: 0.5978
2025-06-17 18:11:42,635 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID79 validation:    Loss: 0.4411,    Action mAP: 0.3677
2025-06-17 18:11:42,636 - INFO - RL_Debug_Experiment_126285051913632 - üìä Validation Summary (averaged across 10 videos):
2025-06-17 18:11:42,636 - INFO - RL_Debug_Experiment_126285051913632 -    üéØ Main mAP (surgical actions): 0.4835 ¬± 0.1044
2025-06-17 18:11:42,636 - INFO - RL_Debug_Experiment_126285051913632 -    üìä mAP with null verbs: 0.4400
2025-06-17 18:11:42,636 - INFO - RL_Debug_Experiment_126285051913632 -    üìã Actions evaluated: 25/94 surgical actions
2025-06-17 18:11:42,636 - INFO - RL_Debug_Experiment_126285051913632 -    üìà Surgical action sparsity: 0.7309
2025-06-17 18:11:42,636 - INFO - RL_Debug_Experiment_126285051913632 -    üîÑ Total Loss: 0.6094
2025-06-17 18:11:42,638 - INFO - RL_Debug_Experiment_126285051913632 - Epoch 2/3 | Train Loss: 0.2038 | Val Loss: 0.6094 | Action mAP: 0.4835¬±0.1044 (10 videos) | Frame MSE: 0.1627
2025-06-17 18:15:39,339 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID02 validation:    Loss: 0.5728,    Action mAP: 0.4227
2025-06-17 18:15:49,237 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID06 validation:    Loss: 0.5183,    Action mAP: 0.5844
2025-06-17 18:15:58,988 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID111 validation:    Loss: 1.0333,    Action mAP: 0.4534
2025-06-17 18:16:08,488 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID14 validation:    Loss: 1.0171,    Action mAP: 0.3008
2025-06-17 18:16:17,891 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID23 validation:    Loss: 0.9407,    Action mAP: 0.4434
2025-06-17 18:16:27,722 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID25 validation:    Loss: 0.7176,    Action mAP: 0.6329
2025-06-17 18:16:36,698 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID50 validation:    Loss: 0.3384,    Action mAP: 0.5316
2025-06-17 18:16:47,262 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID51 validation:    Loss: 0.6997,    Action mAP: 0.4786
2025-06-17 18:16:56,828 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID66 validation:    Loss: 0.3366,    Action mAP: 0.6152
2025-06-17 18:17:07,764 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID79 validation:    Loss: 0.4375,    Action mAP: 0.3695
2025-06-17 18:17:07,764 - INFO - RL_Debug_Experiment_126285051913632 - üìä Validation Summary (averaged across 10 videos):
2025-06-17 18:17:07,765 - INFO - RL_Debug_Experiment_126285051913632 -    üéØ Main mAP (surgical actions): 0.4833 ¬± 0.1024
2025-06-17 18:17:07,765 - INFO - RL_Debug_Experiment_126285051913632 -    üìä mAP with null verbs: 0.4382
2025-06-17 18:17:07,765 - INFO - RL_Debug_Experiment_126285051913632 -    üìã Actions evaluated: 25/94 surgical actions
2025-06-17 18:17:07,765 - INFO - RL_Debug_Experiment_126285051913632 -    üìà Surgical action sparsity: 0.7309
2025-06-17 18:17:07,765 - INFO - RL_Debug_Experiment_126285051913632 -    üîÑ Total Loss: 0.6612
2025-06-17 18:17:07,767 - INFO - RL_Debug_Experiment_126285051913632 - Epoch 3/3 | Train Loss: 0.1706 | Val Loss: 0.6612 | Action mAP: 0.4833¬±0.1024 (10 videos) | Frame MSE: 0.1611
2025-06-17 18:17:08,846 - INFO - RL_Debug_Experiment_126285051913632 - üìä Per-video analysis saved to: results/debug_rl_2025-06-17_17-59-26/logs/per_video_performance_analysis.png
2025-06-17 18:17:08,846 - INFO - RL_Debug_Experiment_126285051913632 - üìä Performance data saved to: results/debug_rl_2025-06-17_17-59-26/logs/per_video_performance_data.json
2025-06-17 18:17:08,846 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Autoregressive IL Training completed!
2025-06-17 18:17:08,846 - INFO - RL_Debug_Experiment_126285051913632 - üìÑ Best model: results/debug_rl_2025-06-17_17-59-26/logs/checkpoints/autoregressive_il_best_epoch_1.pt
2025-06-17 18:17:08,846 - INFO - RL_Debug_Experiment_126285051913632 - üìÑ Final model: results/debug_rl_2025-06-17_17-59-26/logs/checkpoints/autoregressive_il_final.pt
2025-06-17 18:17:08,846 - INFO - RL_Debug_Experiment_126285051913632 - üìä Per-video analysis saved
2025-06-17 18:17:08,846 - INFO - RL_Debug_Experiment_126285051913632 - üìä Evaluating Autoregressive IL Model (PER-VIDEO)...
2025-06-17 18:17:19,123 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID02 validation:    Loss: 0.5728,    Action mAP: 0.4227
2025-06-17 18:17:28,845 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID06 validation:    Loss: 0.5183,    Action mAP: 0.5844
2025-06-17 18:17:38,450 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID111 validation:    Loss: 1.0333,    Action mAP: 0.4534
2025-06-17 18:17:47,850 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID14 validation:    Loss: 1.0171,    Action mAP: 0.3008
2025-06-17 18:17:57,117 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID23 validation:    Loss: 0.9407,    Action mAP: 0.4434
2025-06-17 18:18:06,780 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID25 validation:    Loss: 0.7176,    Action mAP: 0.6329
2025-06-17 18:18:15,510 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID50 validation:    Loss: 0.3384,    Action mAP: 0.5316
2025-06-17 18:18:25,760 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID51 validation:    Loss: 0.6997,    Action mAP: 0.4786
2025-06-17 18:18:35,062 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID66 validation:    Loss: 0.3366,    Action mAP: 0.6152
2025-06-17 18:18:45,894 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Video VID79 validation:    Loss: 0.4375,    Action mAP: 0.3695
2025-06-17 18:18:45,894 - INFO - RL_Debug_Experiment_126285051913632 - üìä Validation Summary (averaged across 10 videos):
2025-06-17 18:18:45,894 - INFO - RL_Debug_Experiment_126285051913632 -    üéØ Main mAP (surgical actions): 0.4833 ¬± 0.1024
2025-06-17 18:18:45,894 - INFO - RL_Debug_Experiment_126285051913632 -    üìä mAP with null verbs: 0.4382
2025-06-17 18:18:45,894 - INFO - RL_Debug_Experiment_126285051913632 -    üìã Actions evaluated: 25/94 surgical actions
2025-06-17 18:18:45,894 - INFO - RL_Debug_Experiment_126285051913632 -    üìà Surgical action sparsity: 0.7309
2025-06-17 18:18:45,894 - INFO - RL_Debug_Experiment_126285051913632 -    üîÑ Total Loss: 0.6612
2025-06-17 18:20:09,722 - INFO - RL_Debug_Experiment_126285051913632 - üìä Evaluating generation quality...
2025-06-17 18:20:25,882 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Per-video evaluation completed
2025-06-17 18:20:25,883 - INFO - RL_Debug_Experiment_126285051913632 - üìä Overall Action mAP: 0.4833 ¬± 0.0000
2025-06-17 18:20:25,883 - INFO - RL_Debug_Experiment_126285051913632 - üìä Videos evaluated: 10
2025-06-17 18:20:25,883 - INFO - RL_Debug_Experiment_126285051913632 - üéØ Aggregation: Per-video metrics ‚Üí averaged
2025-06-17 18:20:25,883 - INFO - RL_Debug_Experiment_126285051913632 - üåç Method 2: World Model + Comprehensive Debugging
2025-06-17 18:20:25,883 - INFO - RL_Debug_Experiment_126285051913632 - ----------------------------------------
2025-06-17 18:20:25,883 - INFO - RL_Debug_Experiment_126285051913632 - üèãÔ∏è Training world model from scratch...
2025-06-17 18:20:44,388 - INFO - RL_Debug_Experiment_126285051913632 - üåç World Model Trainer initialized
2025-06-17 18:20:44,388 - INFO - RL_Debug_Experiment_126285051913632 -    Device: cuda
2025-06-17 18:20:44,388 - INFO - RL_Debug_Experiment_126285051913632 -    Epochs: 3
2025-06-17 18:20:44,389 - INFO - RL_Debug_Experiment_126285051913632 -    Learning rate: 0.0001
2025-06-17 18:20:44,389 - INFO - RL_Debug_Experiment_126285051913632 -    Focus: Action-conditioned state-reward prediction
2025-06-17 18:20:44,389 - INFO - RL_Debug_Experiment_126285051913632 - üåç Starting World Model Training...
2025-06-17 18:20:44,389 - INFO - RL_Debug_Experiment_126285051913632 - üéØ Goal: Learn action-conditioned state-reward prediction
2025-06-17 18:23:47,041 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ New best model saved: results/debug_rl_2025-06-17_17-59-26/logs/checkpoints/world_model_best_epoch_1.pt
2025-06-17 18:23:47,041 - INFO - RL_Debug_Experiment_126285051913632 - Epoch 1/3 | Train Loss: 0.8596 | Val Loss: 0.9393 | Val State MSE: 0.1577 | Val Reward MSE: 0.0574
2025-06-17 18:26:52,156 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ New best model saved: results/debug_rl_2025-06-17_17-59-26/logs/checkpoints/world_model_best_epoch_2.pt
2025-06-17 18:26:52,156 - INFO - RL_Debug_Experiment_126285051913632 - Epoch 2/3 | Train Loss: 0.4516 | Val Loss: 0.9185 | Val State MSE: 0.1476 | Val Reward MSE: 0.0600
2025-06-17 18:29:57,225 - INFO - RL_Debug_Experiment_126285051913632 - Epoch 3/3 | Train Loss: 0.3862 | Val Loss: 0.9453 | Val State MSE: 0.1421 | Val Reward MSE: 0.0594
2025-06-17 18:29:57,277 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ World Model Training completed!
2025-06-17 18:29:57,277 - INFO - RL_Debug_Experiment_126285051913632 - üìÑ Best model: results/debug_rl_2025-06-17_17-59-26/logs/checkpoints/world_model_best_epoch_2.pt
2025-06-17 18:29:57,277 - INFO - RL_Debug_Experiment_126285051913632 - üìÑ Final model: results/debug_rl_2025-06-17_17-59-26/logs/checkpoints/world_model_final.pt
2025-06-17 18:29:57,277 - INFO - RL_Debug_Experiment_126285051913632 - üìä Evaluating World Model...
2025-06-17 18:31:20,529 - INFO - RL_Debug_Experiment_126285051913632 - ‚úÖ Evaluation completed
2025-06-17 18:31:20,529 - INFO - RL_Debug_Experiment_126285051913632 - üìä State Loss: 0.1421
2025-06-17 18:31:20,529 - INFO - RL_Debug_Experiment_126285051913632 - üìä Reward Loss: 0.0594
2025-06-17 18:32:30,806 - INFO - RL_Debug_Experiment_126285051913632 - üîç RL Debugger initialized
2025-06-17 18:32:30,806 - INFO - RL_Debug_Experiment_126285051913632 - üìÅ Debug data will be saved to: results/debug_rl_2025-06-17_17-59-26/world_model_debug
2025-06-17 18:32:30,806 - INFO - RL_Debug_Experiment_126285051913632 - üîç Evaluating world model quality...
2025-06-17 18:32:30,806 - INFO - RL_Debug_Experiment_126285051913632 - üåç Evaluating World Model Quality...
2025-06-17 18:32:30,808 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 5: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,808 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 6: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,808 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 7: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,808 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 8: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,808 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 9: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,808 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 10: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,808 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 11: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 12: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 13: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 14: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 15: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 16: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 17: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 18: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 19: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 20: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 21: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 22: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 23: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 24: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 25: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 26: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 27: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 28: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 29: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,809 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 30: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 31: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 32: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 33: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 34: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 35: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 36: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 37: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 38: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 39: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 40: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 41: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 42: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 43: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 44: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 45: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 46: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 47: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 48: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 49: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,810 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 5: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 6: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 7: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 8: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 9: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 10: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 11: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 12: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 13: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 14: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 15: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 16: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 17: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 18: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 19: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 20: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 21: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 22: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 23: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 24: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 25: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 26: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 27: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 28: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 29: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 30: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 31: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 32: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 33: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 34: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 35: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 36: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 37: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 38: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 39: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,811 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 40: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 41: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 42: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 43: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 44: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 45: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 46: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 47: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 48: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 49: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 5: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 6: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 7: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 8: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 9: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 10: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 11: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 12: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 13: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 14: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 15: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 16: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 17: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 18: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 19: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 20: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 21: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 22: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 23: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 24: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 25: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 26: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 27: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 28: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 29: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 30: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 31: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 32: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 33: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 34: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 35: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 36: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 37: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 38: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 39: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 40: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 41: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,812 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 42: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,813 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 43: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,813 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 44: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,813 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 45: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,813 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 46: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,813 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 47: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,813 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 48: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,813 - WARNING - RL_Debug_Experiment_126285051913632 - World model evaluation failed at frame 49: 'ConditionalWorldModel' object has no attribute 'device'
2025-06-17 18:32:30,813 - INFO - RL_Debug_Experiment_126285051913632 - üåç World Model Quality Score: 0.000
2025-06-17 18:32:30,813 - INFO - RL_Debug_Experiment_126285051913632 -    State MSE: inf
2025-06-17 18:32:30,813 - INFO - RL_Debug_Experiment_126285051913632 -    Reward Accuracy: 0.000
2025-06-17 18:32:30,813 - INFO - RL_Debug_Experiment_126285051913632 -    Action Conditioning: 0.000
2025-06-17 18:32:30,813 - INFO - RL_Debug_Experiment_126285051913632 - üéØ Running simplified RL with debugging...
2025-06-17 18:32:30,813 - INFO - RL_Debug_Experiment_126285051913632 - üîç RL Debugger initialized
2025-06-17 18:32:30,813 - INFO - RL_Debug_Experiment_126285051913632 - üìÅ Debug data will be saved to: results/debug_rl_2025-06-17_17-59-26/logs/simplified_rl_training/debug
2025-06-17 18:32:30,813 - INFO - RL_Debug_Experiment_126285051913632 - üéØ SimplifiedRLTrainer initialized
2025-06-17 18:32:30,814 - INFO - RL_Debug_Experiment_126285051913632 -    Focus: Expert action matching only
2025-06-17 18:32:30,814 - INFO - RL_Debug_Experiment_126285051913632 -    Results: results/debug_rl_2025-06-17_17-59-26/logs/simplified_rl_training
2025-06-17 18:32:30,814 - INFO - RL_Debug_Experiment_126285051913632 - üéØ Training Simplified PPO (Expert Matching Only)
2025-06-17 18:32:30,814 - INFO - RL_Debug_Experiment_126285051913632 - ------------------------------------------------------------
2025-06-17 18:32:30,815 - INFO - RL_Debug_Experiment_126285051913632 - üéØ SimplifiedExpertMatchingEnv initialized
2025-06-17 18:32:30,815 - INFO - RL_Debug_Experiment_126285051913632 -    Focus: ONLY expert action matching + sparsity
2025-06-17 18:32:30,815 - INFO - RL_Debug_Experiment_126285051913632 -    Reward weights: {'expert_f1': 100.0, 'action_sparsity': 5.0, 'completion_bonus': 2.0}
2025-06-17 18:32:30,815 - ERROR - RL_Debug_Experiment_126285051913632 - ‚ùå Simplified PPO training failed: Expected env to be a `gymnasium.Env` but got <class 'rl_debugging_system.simplified_rl_trainer.SimplifiedExpertMatchingEnv'>
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - üéØ Method 3: Simplified RL (Direct Video + Expert Matching)
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - ----------------------------------------
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - üéØ SIMPLIFIED RL TRAINING WITH EXPERT MATCHING FOCUS
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - ============================================================
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - Goal: Understand why RL can't reach 10% mAP vs supervised baseline
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - Approach: Focus ONLY on expert action matching + comprehensive debugging
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - üîç RL Debugger initialized
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - üìÅ Debug data will be saved to: results/debug_rl_2025-06-17_17-59-26/logs/simplified_rl_training/debug
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - üéØ SimplifiedRLTrainer initialized
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 -    Focus: Expert action matching only
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 -    Results: results/debug_rl_2025-06-17_17-59-26/logs/simplified_rl_training
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - 
üåç Step 1: Evaluating World Model Quality...
2025-06-17 18:32:30,825 - INFO - RL_Debug_Experiment_126285051913632 - üåç Evaluating World Model Quality...
2025-06-17 18:32:31,142 - ERROR - RL_Debug_Experiment_126285051913632 - ‚ùå Method 3 failed: 'NoneType' object has no attribute 'eval'
2025-06-17 18:32:31,145 - INFO - RL_Debug_Experiment_126285051913632 - üîç Running Comprehensive Debugging Analysis
2025-06-17 18:32:31,145 - INFO - RL_Debug_Experiment_126285051913632 - ----------------------------------------
2025-06-17 18:32:31,145 - INFO - RL_Debug_Experiment_126285051913632 - üîç Debugging Analysis Complete
2025-06-17 18:32:31,145 - INFO - RL_Debug_Experiment_126285051913632 -    Supervised mAP: 0.4833
2025-06-17 18:32:31,145 - INFO - RL_Debug_Experiment_126285051913632 -    World Model RL mAP: 0.0000
2025-06-17 18:32:31,145 - INFO - RL_Debug_Experiment_126285051913632 -    Direct Video RL mAP: 0.0000
2025-06-17 18:32:31,145 - INFO - RL_Debug_Experiment_126285051913632 -    Main issue: large_rl_vs_supervised_gap
2025-06-17 18:32:31,145 - INFO - RL_Debug_Experiment_126285051913632 - üìä PERFORMANCE GAP ANALYSIS
2025-06-17 18:32:31,145 - INFO - RL_Debug_Experiment_126285051913632 - ==================================================
2025-06-17 18:32:31,146 - INFO - RL_Debug_Experiment_126285051913632 - üéì Supervised IL Baseline: 0.4833 mAP
2025-06-17 18:32:31,146 - INFO - RL_Debug_Experiment_126285051913632 - üåç World Model + RL: 0.0000 mAP
2025-06-17 18:32:31,146 - INFO - RL_Debug_Experiment_126285051913632 - üéØ Direct Video RL: 0.0000 mAP
2025-06-17 18:32:31,146 - INFO - RL_Debug_Experiment_126285051913632 - 
2025-06-17 18:32:31,146 - INFO - RL_Debug_Experiment_126285051913632 - üìâ Performance Gaps:
2025-06-17 18:32:31,146 - INFO - RL_Debug_Experiment_126285051913632 -    Supervised vs World Model RL: 0.4833 (100.0%)
2025-06-17 18:32:31,146 - INFO - RL_Debug_Experiment_126285051913632 -    Supervised vs Direct Video RL: 0.4833 (100.0%)
2025-06-17 18:32:31,146 - INFO - RL_Debug_Experiment_126285051913632 - ü§ù RL approaches perform similarly
2025-06-17 18:32:31,146 - INFO - RL_Debug_Experiment_126285051913632 - ‚ùå RL is far from supervised performance - major issues
2025-06-17 18:32:31,148 - INFO - RL_Debug_Experiment_126285051913632 - üíæ Debugging results saved to: results/debug_rl_2025-06-17_17-59-26
2025-06-17 18:32:31,148 - INFO - RL_Debug_Experiment_126285051913632 - üìÑ Detailed results: results/debug_rl_2025-06-17_17-59-26/debugging_results.json
2025-06-17 18:32:31,148 - INFO - RL_Debug_Experiment_126285051913632 - üìÑ Summary: results/debug_rl_2025-06-17_17-59-26/debugging_summary.json
2025-06-17 18:38:00,947 - INFO - RL_Debug_Experiment_126285051913632 - üìä Analyzing debugging results...
2025-06-17 18:38:00,947 - INFO - RL_Debug_Experiment_126285051913632 - üìä Analysis complete:
2025-06-17 18:38:00,947 - INFO - RL_Debug_Experiment_126285051913632 -    Supervised mAP: 0.4833
2025-06-17 18:38:00,947 - INFO - RL_Debug_Experiment_126285051913632 -    Best RL mAP: 0.0000
2025-06-17 18:38:00,948 - INFO - RL_Debug_Experiment_126285051913632 -    Performance gap: 0.4833
2025-06-17 18:38:00,948 - INFO - RL_Debug_Experiment_126285051913632 -    Main issues: ['poor_world_model_quality', 'rl_not_learning']
