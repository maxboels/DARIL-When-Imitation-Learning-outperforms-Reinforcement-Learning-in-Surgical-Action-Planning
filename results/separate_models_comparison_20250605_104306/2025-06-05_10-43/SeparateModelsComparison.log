2025-06-05 10:43:06,870 - INFO - SeparateModelsComparison_124595743898656 - ğŸ¯ Experiment: separate_models_comparison_20250605_104306
2025-06-05 10:43:06,870 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“ Results dir: results/separate_models_comparison_20250605_104306
2025-06-05 10:43:06,870 - INFO - SeparateModelsComparison_124595743898656 - ğŸš€ Starting Complete Separate Models Comparison
2025-06-05 10:43:06,870 - INFO - SeparateModelsComparison_124595743898656 - ============================================================
2025-06-05 10:43:06,870 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“‚ Loading CholecT50 data...
2025-06-05 10:43:06,870 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“‚ Loading CholecT50 dataset...
2025-06-05 10:43:06,871 - ERROR - SeparateModelsComparison_124595743898656 - âŒ Data file not found: /home/maxboels/datasets/CholecT50/embeddings_f0_swin_bas_129_with_enhanced_global_metrics.csv
2025-06-05 10:43:06,871 - WARNING - SeparateModelsComparison_124595743898656 - âš ï¸ Creating dummy data for testing
2025-06-05 10:43:06,881 - INFO - SeparateModelsComparison_124595743898656 - âœ… Created 2 dummy training and 1 dummy test videos
2025-06-05 10:43:06,881 - INFO - SeparateModelsComparison_124595743898656 - âœ… Data loaded successfully
2025-06-05 10:43:06,881 - INFO - SeparateModelsComparison_124595743898656 -    Training videos: 2
2025-06-05 10:43:06,881 - INFO - SeparateModelsComparison_124595743898656 -    Test videos: 1
2025-06-05 10:43:06,881 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“ Running Method 1: Autoregressive IL
2025-06-05 10:43:06,881 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“ Method 1: Autoregressive IL Training
2025-06-05 10:43:06,881 - INFO - SeparateModelsComparison_124595743898656 - ----------------------------------------
2025-06-05 10:43:07,405 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“ Autoregressive IL Trainer initialized
2025-06-05 10:43:07,405 - INFO - SeparateModelsComparison_124595743898656 -    Device: cuda
2025-06-05 10:43:07,405 - INFO - SeparateModelsComparison_124595743898656 -    Epochs: 1
2025-06-05 10:43:07,405 - INFO - SeparateModelsComparison_124595743898656 -    Learning rate: 0.0001
2025-06-05 10:43:07,405 - INFO - SeparateModelsComparison_124595743898656 -    Focus: Causal frame generation â†’ action prediction
2025-06-05 10:43:07,405 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“ Starting Autoregressive IL Training...
2025-06-05 10:43:07,405 - INFO - SeparateModelsComparison_124595743898656 - ğŸ¯ Goal: Learn causal frame generation â†’ action prediction
2025-06-05 10:43:07,475 - ERROR - SeparateModelsComparison_124595743898656 - âŒ Method 1 failed: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 172, in collate
    key: collate(
         ^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 271, in collate_tensor_fn
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to resize storage that is not resizable

2025-06-05 10:43:07,475 - INFO - SeparateModelsComparison_124595743898656 - ğŸŒ Running Method 2: Conditional World Model + RL
2025-06-05 10:43:07,475 - INFO - SeparateModelsComparison_124595743898656 - ğŸŒ Method 2: Conditional World Model + RL
2025-06-05 10:43:07,475 - INFO - SeparateModelsComparison_124595743898656 - ----------------------------------------
2025-06-05 10:43:07,736 - INFO - SeparateModelsComparison_124595743898656 - ğŸŒ World Model Trainer initialized
2025-06-05 10:43:07,736 - INFO - SeparateModelsComparison_124595743898656 -    Device: cuda
2025-06-05 10:43:07,736 - INFO - SeparateModelsComparison_124595743898656 -    Epochs: 1
2025-06-05 10:43:07,736 - INFO - SeparateModelsComparison_124595743898656 -    Learning rate: 0.0001
2025-06-05 10:43:07,736 - INFO - SeparateModelsComparison_124595743898656 -    Focus: Action-conditioned state-reward prediction
2025-06-05 10:43:07,736 - INFO - SeparateModelsComparison_124595743898656 - ğŸŒ Starting World Model Training...
2025-06-05 10:43:07,736 - INFO - SeparateModelsComparison_124595743898656 - ğŸ¯ Goal: Learn action-conditioned state-reward prediction
2025-06-05 10:43:08,983 - INFO - SeparateModelsComparison_124595743898656 - âœ… New best model saved: results/separate_models_comparison_20250605_104306/2025-06-05_10-43/checkpoints/world_model_best_epoch_1.pt
2025-06-05 10:43:08,983 - INFO - SeparateModelsComparison_124595743898656 - Epoch 1/1 | Train Loss: 11.3274 | Val Loss: 6.7897 | State MSE: 1.0049 | Reward MSE: 1.2745
2025-06-05 10:43:09,867 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“Š Training plots saved to: results/separate_models_comparison_20250605_104306/2025-06-05_10-43/world_model_training_curves.png
2025-06-05 10:43:09,868 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“Š Metrics saved to: results/separate_models_comparison_20250605_104306/2025-06-05_10-43/world_model_metrics.json
2025-06-05 10:43:09,868 - INFO - SeparateModelsComparison_124595743898656 - âœ… World Model Training completed!
2025-06-05 10:43:09,868 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“„ Best model: results/separate_models_comparison_20250605_104306/2025-06-05_10-43/checkpoints/world_model_best_epoch_1.pt
2025-06-05 10:43:09,868 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“„ Final model: results/separate_models_comparison_20250605_104306/2025-06-05_10-43/checkpoints/world_model_final.pt
2025-06-05 10:43:09,868 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“Š Evaluating World Model...
2025-06-05 10:43:10,110 - ERROR - SeparateModelsComparison_124595743898656 - âŒ Method 2 failed: 'actions'
2025-06-05 10:43:10,114 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“¹ Running Method 3: Direct Video RL
2025-06-05 10:43:10,114 - INFO - SeparateModelsComparison_124595743898656 - ğŸ“¹ Method 3: Direct Video RL
2025-06-05 10:43:10,114 - INFO - SeparateModelsComparison_124595743898656 - ----------------------------------------
