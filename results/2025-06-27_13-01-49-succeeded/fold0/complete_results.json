{
  "experiment_name": "2025-06-27_13-01-49",
  "config": {
    "debug": false,
    "experiment": {
      "train": {
        "max_videos": 40
      },
      "test": {
        "max_videos": 10,
        "test_on_train": false
      },
      "autoregressive_il": {
        "enabled": true,
        "train": true,
        "evaluate": true,
        "model_type_preference": "combined",
        "save_all_best_models": true,
        "il_model_path": null,
        "ivt_saving": {
          "enabled": true,
          "current_weight": 0.4,
          "next_weight": 0.6,
          "save_frequency": 1,
          "keep_top_k": 3
        },
        "evaluation_model": "combined",
        "recognition": {
          "enabled": false,
          "ivt_map": 36.1
        }
      },
      "world_model": {
        "enabled": false,
        "wm_model_path": "results/fixed_rl_2025-06-13_19-22-25/logs/checkpoints/world_model_best_epoch_1.pt"
      },
      "rl_experiments": {
        "enabled": false,
        "eval_episodes": 10
      }
    },
    "training": {
      "epochs": 15,
      "batch_size": 8,
      "learning_rate": "8e-5",
      "log_every_n_steps": 20,
      "optimizer_type": "adamw",
      "weight_decay": 0.025,
      "gradient_clip_val": 0.8,
      "scheduler": {
        "type": "cosine_with_warmup",
        "warmup_epochs": 3,
        "eta_min": "8e-6"
      },
      "parameter_groups": {
        "bilstm_recognition": {
          "lr_multiplier": 1.0,
          "weight_decay_multiplier": 0.3
        },
        "gpt2_backbone": {
          "lr_multiplier": 0.3,
          "weight_decay_multiplier": 0.8
        },
        "frame_processing": {
          "lr_multiplier": 0.5,
          "weight_decay_multiplier": 1.5
        },
        "action_prediction": {
          "lr_multiplier": 1.5,
          "weight_decay_multiplier": 0.2
        },
        "auxiliary_heads": {
          "lr_multiplier": 0.8,
          "weight_decay_multiplier": 1.0
        }
      },
      "lr_monitoring": {
        "track_gradients": true,
        "track_parameters": true,
        "log_frequency": 50,
        "save_plots": true,
        "generate_recommendations": true
      },
      "augmentation": {
        "temporal_crop_ratio": 0.85,
        "temporal_jitter_std": 0.02,
        "sequence_shuffle_prob": 0.1,
        "frame_dropout_prob": 0.05
      },
      "early_stopping": {
        "patience": 8,
        "min_delta": 0.001,
        "monitor": "ivt_next_mAP",
        "mode": "max"
      },
      "monitor_ivt_metrics": true,
      "log_ivt_components": true,
      "tensorboard_ivt_tracking": true,
      "num_workers": 2,
      "pin_memory": true,
      "log_dir": "logs",
      "checkpoint_dir": "checkpoints",
      "eval_epoch_interval": 1,
      "save_model": true,
      "checkpointing": {
        "save_best_only": false,
        "save_top_k": 5,
        "monitor": "ivt_next_mAP",
        "mode": "max",
        "save_every_n_epochs": 5,
        "save_ivt_milestones": true,
        "ivt_milestones": [
          0.3,
          0.34,
          0.35,
          0.36,
          0.37
        ]
      },
      "min_current_map_threshold": 0.3,
      "min_next_map_threshold": 0.3,
      "min_combined_threshold": 0.3
    },
    "evaluation": {
      "prediction_horizon": 8,
      "comprehensive_evaluation": {
        "per_video_analysis": true,
        "statistical_significance": true,
        "confidence_intervals": true,
        "baseline_comparison": 36.1,
        "evaluate_ivt_components": true,
        "ivt_video_wise": true,
        "report_both_tasks": true
      },
      "supervised": {
        "action_prediction": true
      },
      "rl": {
        "rollout_horizon": 15,
        "use_best_actions": true
      },
      "comparison": {
        "statistical_tests": true,
        "effect_size_threshold": 0.15,
        "compare_all_saved_models": true
      },
      "planning_evaluation": {
        "enabled": true,
        "horizons": [
          1,
          2,
          3,
          5
        ],
        "use_best_next_model": true
      },
      "world_model": {
        "use_memory": false,
        "overall_horizon": 1
      }
    },
    "rl_training": {
      "action_space_type": "continuous",
      "outcome_based_rewards": true,
      "rl_horizon": 30,
      "reward_mode": "dense",
      "normalize_rewards": true,
      "early_termination": true,
      "timesteps": 50000,
      "reward_weights": {
        "expert_matching": 10.0,
        "action_sparsity": 1.0,
        "world_model_rewards": 0.5,
        "completion_bonus": 5.0,
        "consistency_bonus": 1.0,
        "phase_completion": 1.0,
        "risk_penalty": -0.5
      },
      "ppo": {
        "learning_rate": "5e-5",
        "n_steps": 512,
        "batch_size": 64,
        "n_epochs": 10,
        "gamma": 0.95,
        "gae_lambda": 0.9,
        "clip_range": 0.1,
        "ent_coef": 0.05,
        "vf_coef": 0.5,
        "max_grad_norm": 0.5
      },
      "a2c": {
        "learning_rate": "1e-4",
        "n_steps": 32,
        "gamma": 0.95,
        "gae_lambda": 0.9,
        "ent_coef": 0.05,
        "vf_coef": 0.25,
        "max_grad_norm": 0.5
      }
    },
    "data": {
      "context_length": 12,
      "train_shift": 1,
      "padding_value": 0.0,
      "max_horizon": 8,
      "normalize_embeddings": true,
      "embedding_noise": 0.01,
      "ivt_evaluation_mode": true,
      "preserve_video_structure": true,
      "paths": {
        "data_dir": "/home/maxboels/datasets/CholecT50",
        "class_labels_file_path": "./data/labels.json",
        "fold": 0,
        "metadata_file": "embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv",
        "video_global_outcome_file": "embeddings_f1_swin_bas_129_with_enhanced_global_metrics.csv"
      },
      "frame_risk_agg": "max"
    },
    "training_mode": "rl",
    "preprocess": {
      "extract_rewards": false,
      "analyze_rewards": false,
      "rewards": {
        "grounded": {
          "phase_completion": true,
          "phase_transition": true,
          "phase_progression": true,
          "global_progression": true
        },
        "imitation": {
          "action_distribution": true
        },
        "expert_knowledge": {
          "risk_score": true,
          "frame_risk_agg": "max"
        }
      }
    },
    "models": {
      "autoregressive_il": {
        "hidden_dim": 384,
        "embedding_dim": 1024,
        "n_layer": 3,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.3,
        "max_length": 256,
        "layer_dropout": 0.15,
        "attention_dropout": 0.2,
        "frame_projection_dropout": 0.2,
        "bilstm_layers": 1,
        "bilstm_dropout": 0.25,
        "bilstm_bidirectional": true,
        "current_task_weight": 2.0,
        "next_task_weight": 1.5,
        "consistency_weight": 0.1
      },
      "conditional_world_model": {
        "hidden_dim": 512,
        "embedding_dim": 1024,
        "action_embedding_dim": 128,
        "n_layer": 4,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.1,
        "max_sequence_length": 512
      }
    },
    "loss_weights": {
      "recognition": 2.0,
      "generation": 1.5,
      "frame_reconstruction": 0.2,
      "phase_prediction": 0.5,
      "consistency": 0.1
    },
    "fair_evaluation": {
      "enabled": true,
      "include_traditional_metrics": true,
      "include_clinical_metrics": true,
      "per_video_analysis": {
        "enabled": true,
        "save_individual_results": true,
        "statistical_aggregation": true,
        "baseline_comparison": 36.1
      },
      "clinical_outcome_weights": {
        "phase_progression": 2.0,
        "innovation": 0.5
      }
    },
    "supervised_learning": {
      "data_augmentation": true
    },
    "research_comparison": {
      "methods": [
        "autoregressive_il",
        "conditional_world_model",
        "direct_video_rl"
      ]
    },
    "advanced": {
      "mixed_precision": false
    },
    "hardware": {
      "persistent_workers": false,
      "mixed_precision": false
    },
    "rl_debugging": {
      "enabled": true,
      "save_training_curves": true,
      "monitor_expert_matching": true,
      "log_action_distributions": true,
      "convergence_analysis": true,
      "episode_log_frequency": 10,
      "eval_frequency": 1000,
      "reward_improvement_threshold": 0.1,
      "expert_matching_threshold": 0.5,
      "debug_dir": "rl_debug",
      "plot_dir": "rl_plots"
    },
    "il_debugging": {
      "enabled": true,
      "convergence_tracking": {
        "early_plateau_detection": true,
        "overfitting_detection": true,
        "feature_utilization_analysis": true
      },
      "baseline_comparison": {
        "swin_recognition_mAP": 36.1,
        "improvement_threshold": 1.0
      },
      "temporal_evaluation": {
        "short_term_prediction": true,
        "medium_term_prediction": true,
        "temporal_consistency": true,
        "sequence_modeling_analysis": true
      }
    },
    "logging": {
      "level": "INFO",
      "log_ivt_details": true,
      "save_ivt_plots": true,
      "ivt_component_analysis": true,
      "log_best_scores": true,
      "log_model_saves": true
    },
    "il_performance_targets": {
      "current_recognition_mAP_target": 35.0,
      "current_recognition_minimum": 30.0,
      "next_prediction_mAP_target": 32.0,
      "next_prediction_minimum": 25.0,
      "combined_score_target": 33.0,
      "improvement_over_baseline": 2.0,
      "convergence_epoch": 8,
      "maximum_overfitting": 5.0,
      "ivt_instrument_target": 85.0,
      "ivt_verb_target": 65.0,
      "ivt_target_target": 45.0
    }
  },
  "timestamp": "2025-06-27_13-01-49",
  "results_dir": "results/2025-06-27_13-01-49/fold0",
  "method_1_autoregressive_il": {
    "status": "failed",
    "error": "'AutoregressiveILTrainer' object has no attribute '_enhanced_training_complete'"
  },
  "comprehensive_evaluation": {
    "status": "failed",
    "error": "No models loaded",
    "fix_applied": "attempted_but_no_models"
  },
  "generated_plots": {
    "performance_dashboard": "results/2025-06-27_13-01-49/fold0/publication_plots/performance_dashboard.png"
  }
}