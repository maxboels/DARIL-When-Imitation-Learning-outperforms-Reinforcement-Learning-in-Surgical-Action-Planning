2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 - Shared experiment log directory: results/2025-06-26_11-38-15/fold0/logs
2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 - 🎯 RL Experiment: 2025-06-26_11-38-15
2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 - 📁 Results dir: results/2025-06-26_11-38-15/fold0
2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 - 📂 Plots dir: results/2025-06-26_11-38-15/fold0/publication_plots
2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 - 🚀 Starting Complete RL Comparison
2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 - ============================================================
2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 - 📂 Loading CholecT50 data...
2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 -    Training videos: 2
2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 -    Test videos: 2
2025-06-26 11:38:15,860 - INFO - SuRL_FixedRL_136471054290384 - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-26 11:38:16,262 - INFO - SuRL_FixedRL_136471054290384 - ✅ Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (78968, 156)
2025-06-26 11:38:16,262 - INFO - SuRL_FixedRL_136471054290384 - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-26 11:38:16,263 - INFO - SuRL_FixedRL_136471054290384 - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-26 11:38:16,264 - INFO - SuRL_FixedRL_136471054290384 - [Train] Found 2 videos in metadata file
2025-06-26 11:38:16,264 - INFO - SuRL_FixedRL_136471054290384 - [Train] Loading data for 2 videos
2025-06-26 11:38:16,440 - INFO - SuRL_FixedRL_136471054290384 - ✅ Loaded video VID01: 1734 frames, 1024-dims embeddings
2025-06-26 11:38:16,503 - INFO - SuRL_FixedRL_136471054290384 - ✅ Loaded video VID04: 1523 frames, 1024-dims embeddings
2025-06-26 11:38:16,503 - INFO - SuRL_FixedRL_136471054290384 - 📂 Loaded 2 videos from train split
2025-06-26 11:38:16,506 - INFO - SuRL_FixedRL_136471054290384 - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-26 11:38:16,582 - INFO - SuRL_FixedRL_136471054290384 - ✅ Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (21895, 156)
2025-06-26 11:38:16,582 - INFO - SuRL_FixedRL_136471054290384 - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-26 11:38:16,583 - INFO - SuRL_FixedRL_136471054290384 - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-26 11:38:16,583 - INFO - SuRL_FixedRL_136471054290384 - [Test] Found 2 videos in metadata file
2025-06-26 11:38:16,583 - INFO - SuRL_FixedRL_136471054290384 - [Test] Loading data for 2 videos
2025-06-26 11:38:16,692 - INFO - SuRL_FixedRL_136471054290384 - ✅ Loaded video VID02: 2840 frames, 1024-dims embeddings
2025-06-26 11:38:16,774 - INFO - SuRL_FixedRL_136471054290384 - ✅ Loaded video VID06: 2154 frames, 1024-dims embeddings
2025-06-26 11:38:16,774 - INFO - SuRL_FixedRL_136471054290384 - 📂 Loaded 2 videos from test split
2025-06-26 11:38:16,775 - INFO - SuRL_FixedRL_136471054290384 - ✅ Data loaded successfully
2025-06-26 11:38:16,775 - INFO - SuRL_FixedRL_136471054290384 -    Training videos: 2
2025-06-26 11:38:16,775 - INFO - SuRL_FixedRL_136471054290384 -    Test videos: 2
2025-06-26 11:38:16,775 - INFO - SuRL_FixedRL_136471054290384 - 🎓 Running Method 1: Autoregressive IL
2025-06-26 11:38:16,775 - INFO - SuRL_FixedRL_136471054290384 - 🎓 Method 1: Autoregressive IL
2025-06-26 11:38:16,775 - INFO - SuRL_FixedRL_136471054290384 - ----------------------------------------
2025-06-26 11:38:16,775 - INFO - SuRL_FixedRL_136471054290384 - 🏋️ Training IL model from scratch...
2025-06-26 11:38:17,501 - INFO - SuRL_FixedRL_136471054290384 - 🎓 Autoregressive IL Trainer initialized (FIXED)
2025-06-26 11:38:17,502 - INFO - SuRL_FixedRL_136471054290384 -    Device: cuda
2025-06-26 11:38:17,502 - INFO - SuRL_FixedRL_136471054290384 -    Epochs: 4
2025-06-26 11:38:17,502 - INFO - SuRL_FixedRL_136471054290384 -    Learning rate: 3e-05
2025-06-26 11:38:17,502 - INFO - SuRL_FixedRL_136471054290384 -    ✅ Per-video aggregation + shared metrics + efficient validation
2025-06-26 11:38:17,502 - INFO - SuRL_FixedRL_136471054290384 - 🌟 Training Autoregressive IL model...
2025-06-26 11:38:17,502 - INFO - SuRL_FixedRL_136471054290384 - 🎓 Starting Autoregressive IL Training...
2025-06-26 11:38:17,502 - INFO - SuRL_FixedRL_136471054290384 - 🎯 Goal: Learn causal frame generation → action prediction
2025-06-26 11:38:17,502 - INFO - SuRL_FixedRL_136471054290384 - 📊 Evaluation: Per-video aggregation for robust metrics
2025-06-26 11:38:49,945 - INFO - SuRL_FixedRL_136471054290384 - ✅ Video VID06 validation:    Loss: 1.4787,    IVT current mAP: 0.1165,    IVT next mAP: 0.2015, 
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 - 📊 Validation Summary (averaged across 2 videos):
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current mAP:                0.1165
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next mAP:                   0.2015
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next I mAP:     0.7710
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next V mAP:     0.5276
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next T mAP:     0.3686
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next IV mAP:     0.3022
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next IT mAP:     0.2472
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current mAP:         0.1165
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current I mAP: 0.4102
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current V mAP: 0.2564
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current T mAP: 0.2398
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current IV mAP: 0.1446
2025-06-26 11:38:49,946 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current IT mAP: 0.1383
2025-06-26 11:38:50,084 - INFO - SuRL_FixedRL_136471054290384 - ✅ New best model saved: results/2025-06-26_11-38-15/fold0/logs/checkpoints/autoregressive_il_best_epoch_1.pt
2025-06-26 11:38:50,085 - INFO - SuRL_FixedRL_136471054290384 - Epoch 1/4 | Train Loss: 1.6252 | Val Loss: 1.3349 | Action mAP: 0.2603±0.0085 (2 videos) | Frame MSE: 0.5691
2025-06-26 11:39:16,209 - INFO - SuRL_FixedRL_136471054290384 - ✅ Video VID06 validation:    Loss: 1.3515,    IVT current mAP: 0.1486,    IVT next mAP: 0.2247, 
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 - 📊 Validation Summary (averaged across 2 videos):
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current mAP:                0.1486
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next mAP:                   0.2247
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next I mAP:     0.8096
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next V mAP:     0.0000
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next T mAP:     0.0000
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next IV mAP:     0.0000
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT next IT mAP:     0.0000
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current mAP:         0.1486
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current I mAP: 0.5624
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current V mAP: 0.3391
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current T mAP: 0.3060
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current IV mAP: 0.1972
2025-06-26 11:39:16,210 - INFO - SuRL_FixedRL_136471054290384 -    📊 IVT current IT mAP: 0.1771
2025-06-26 11:39:16,321 - INFO - SuRL_FixedRL_136471054290384 - ✅ New best model saved: results/2025-06-26_11-38-15/fold0/logs/checkpoints/autoregressive_il_best_epoch_2.pt
2025-06-26 11:39:16,321 - INFO - SuRL_FixedRL_136471054290384 - Epoch 2/4 | Train Loss: 0.5346 | Val Loss: 1.2207 | Action mAP: 0.2889±0.0120 (2 videos) | Frame MSE: 0.4791
