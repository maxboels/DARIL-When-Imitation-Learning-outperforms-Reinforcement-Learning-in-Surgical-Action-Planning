2025-06-25 17:34:21,070 - INFO - SuRL_FixedRL_138732256967136 - Shared experiment log directory: results/2025-06-25_17-34-21/fold0/logs
2025-06-25 17:34:21,071 - INFO - SuRL_FixedRL_138732256967136 - ğŸ¯ RL Experiment: 2025-06-25_17-34-21
2025-06-25 17:34:21,071 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“ Results dir: results/2025-06-25_17-34-21/fold0
2025-06-25 17:34:21,071 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“‚ Plots dir: results/2025-06-25_17-34-21/fold0/publication_plots
2025-06-25 17:34:21,071 - INFO - SuRL_FixedRL_138732256967136 - ğŸš€ Starting Complete RL Comparison
2025-06-25 17:34:21,071 - INFO - SuRL_FixedRL_138732256967136 - ============================================================
2025-06-25 17:34:21,071 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“‚ Loading CholecT50 data...
2025-06-25 17:34:21,071 - INFO - SuRL_FixedRL_138732256967136 -    Training videos: 2
2025-06-25 17:34:21,071 - INFO - SuRL_FixedRL_138732256967136 -    Test videos: 10
2025-06-25 17:34:21,071 - INFO - SuRL_FixedRL_138732256967136 - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-25 17:34:21,468 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (78968, 156)
2025-06-25 17:34:21,468 - INFO - SuRL_FixedRL_138732256967136 - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-25 17:34:21,469 - INFO - SuRL_FixedRL_138732256967136 - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-25 17:34:21,470 - INFO - SuRL_FixedRL_138732256967136 - [Train] Found 2 videos in metadata file
2025-06-25 17:34:21,471 - INFO - SuRL_FixedRL_138732256967136 - [Train] Loading data for 2 videos
2025-06-25 17:34:21,549 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID01: 1734 frames, 1024-dims embeddings
2025-06-25 17:34:21,611 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID04: 1523 frames, 1024-dims embeddings
2025-06-25 17:34:21,611 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“‚ Loaded 2 videos from train split
2025-06-25 17:34:21,611 - INFO - SuRL_FixedRL_138732256967136 - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-25 17:34:21,689 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (21895, 156)
2025-06-25 17:34:21,689 - INFO - SuRL_FixedRL_138732256967136 - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-25 17:34:21,689 - INFO - SuRL_FixedRL_138732256967136 - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-25 17:34:21,689 - INFO - SuRL_FixedRL_138732256967136 - [Test] Found 10 videos in metadata file
2025-06-25 17:34:21,689 - INFO - SuRL_FixedRL_138732256967136 - [Test] Loading data for 10 videos
2025-06-25 17:34:21,800 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID02: 2840 frames, 1024-dims embeddings
2025-06-25 17:34:21,884 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID06: 2154 frames, 1024-dims embeddings
2025-06-25 17:34:21,968 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID111: 2146 frames, 1024-dims embeddings
2025-06-25 17:34:22,037 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID14: 1709 frames, 1024-dims embeddings
2025-06-25 17:34:22,101 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID23: 1636 frames, 1024-dims embeddings
2025-06-25 17:34:22,185 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID25: 2130 frames, 1024-dims embeddings
2025-06-25 17:34:22,229 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID50: 1095 frames, 1024-dims embeddings
2025-06-25 17:34:22,344 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID51: 2945 frames, 1024-dims embeddings
2025-06-25 17:34:22,417 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID66: 1825 frames, 1024-dims embeddings
2025-06-25 17:34:22,555 - INFO - SuRL_FixedRL_138732256967136 - âœ… Loaded video VID79: 3415 frames, 1024-dims embeddings
2025-06-25 17:34:22,555 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“‚ Loaded 10 videos from test split
2025-06-25 17:34:22,555 - INFO - SuRL_FixedRL_138732256967136 - âœ… Data loaded successfully
2025-06-25 17:34:22,555 - INFO - SuRL_FixedRL_138732256967136 -    Training videos: 2
2025-06-25 17:34:22,555 - INFO - SuRL_FixedRL_138732256967136 -    Test videos: 10
2025-06-25 17:34:22,555 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“ Running Method 1: Autoregressive IL
2025-06-25 17:34:22,555 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“ Method 1: Autoregressive IL
2025-06-25 17:34:22,555 - INFO - SuRL_FixedRL_138732256967136 - ----------------------------------------
2025-06-25 17:34:22,555 - INFO - SuRL_FixedRL_138732256967136 - ğŸ‹ï¸ Training IL model from scratch...
2025-06-25 17:34:23,970 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“ Autoregressive IL Trainer initialized (FIXED)
2025-06-25 17:34:23,971 - INFO - SuRL_FixedRL_138732256967136 -    Device: cuda
2025-06-25 17:34:23,971 - INFO - SuRL_FixedRL_138732256967136 -    Epochs: 2
2025-06-25 17:34:23,971 - INFO - SuRL_FixedRL_138732256967136 -    Learning rate: 3e-05
2025-06-25 17:34:23,971 - INFO - SuRL_FixedRL_138732256967136 -    âœ… Per-video aggregation + shared metrics + efficient validation
2025-06-25 17:34:23,971 - INFO - SuRL_FixedRL_138732256967136 - ğŸŒŸ Training Autoregressive IL model...
2025-06-25 17:34:23,971 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“ Starting Autoregressive IL Training...
2025-06-25 17:34:23,971 - INFO - SuRL_FixedRL_138732256967136 - ğŸ¯ Goal: Learn causal frame generation â†’ action prediction
2025-06-25 17:34:23,971 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“Š Evaluation: Per-video aggregation for robust metrics
2025-06-25 17:37:52,782 - INFO - SuRL_FixedRL_138732256967136 - âœ… Video VID79 validation:    Loss: 1.4461,    Action next mAP: 0.2202,    IVT next mAP: 0.1699,    IVT current mAP: 0.0713, 
2025-06-25 17:38:53,867 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“Š Validation Summary (averaged across 10 videos):
2025-06-25 17:38:53,867 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ¯ Current System mAP:     0.3164 Â± 0.0618
2025-06-25 17:38:53,867 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Standard mAP:       0.1699
2025-06-25 17:38:53,867 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ† Publication Metric:     0.1699 (IVT mAP)
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“‹ Actions evaluated:      25 surgical actions
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ”„ Total Loss:             1.6102
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT I mAP:     0.8195
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT V mAP:     0.5806
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT T mAP:     0.3586
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT IV mAP:     0.2982
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT IT mAP:     0.2338
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current mAP:         0.0713
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current I mAP: 0.3581
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current V mAP: 0.2204
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current T mAP: 0.1635
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current IV mAP: 0.1147
2025-06-25 17:38:53,868 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current IT mAP: 0.0930
2025-06-25 17:38:54,000 - INFO - SuRL_FixedRL_138732256967136 - âœ… New best model saved: results/2025-06-25_17-34-21/fold0/logs/checkpoints/autoregressive_il_best_epoch_1.pt
2025-06-25 17:38:54,000 - INFO - SuRL_FixedRL_138732256967136 - Epoch 1/2 | Train Loss: 1.7679 | Val Loss: 1.6102 | Action mAP: 0.3164Â±0.0618 (10 videos) | Frame MSE: 0.5447
2025-06-25 17:42:11,202 - INFO - SuRL_FixedRL_138732256967136 - âœ… Video VID79 validation:    Loss: 1.2786,    Action next mAP: 0.2230,    IVT next mAP: 0.1772,    IVT current mAP: 0.0792, 
2025-06-25 17:42:17,141 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“Š Validation Summary (averaged across 10 videos):
2025-06-25 17:42:17,141 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ¯ Current System mAP:     0.3285 Â± 0.0647
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Standard mAP:       0.1772
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ† Publication Metric:     0.1772 (IVT mAP)
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“‹ Actions evaluated:      25 surgical actions
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ”„ Total Loss:             1.4766
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT I mAP:     0.8273
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT V mAP:     0.6036
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT T mAP:     0.3654
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT IV mAP:     0.3097
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT IT mAP:     0.2435
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current mAP:         0.0792
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current I mAP: 0.4094
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current V mAP: 0.2699
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current T mAP: 0.2032
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current IV mAP: 0.1377
2025-06-25 17:42:17,142 - INFO - SuRL_FixedRL_138732256967136 -    ğŸ“Š IVT Current IT mAP: 0.1053
2025-06-25 17:42:17,267 - INFO - SuRL_FixedRL_138732256967136 - âœ… New best model saved: results/2025-06-25_17-34-21/fold0/logs/checkpoints/autoregressive_il_best_epoch_2.pt
2025-06-25 17:42:17,267 - INFO - SuRL_FixedRL_138732256967136 - Epoch 2/2 | Train Loss: 0.5811 | Val Loss: 1.4766 | Action mAP: 0.3285Â±0.0647 (10 videos) | Frame MSE: 0.4894
2025-06-25 17:42:18,274 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“Š Per-video analysis saved to: results/2025-06-25_17-34-21/fold0/logs/per_video_performance_analysis.png
2025-06-25 17:42:18,274 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“Š Performance data saved to: results/2025-06-25_17-34-21/fold0/logs/per_video_performance_data.json
2025-06-25 17:42:18,274 - INFO - SuRL_FixedRL_138732256967136 - âœ… Autoregressive IL Training completed!
2025-06-25 17:42:18,274 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“„ Best model: results/2025-06-25_17-34-21/fold0/logs/checkpoints/autoregressive_il_best_epoch_2.pt
2025-06-25 17:42:18,274 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“„ Final model: results/2025-06-25_17-34-21/fold0/logs/checkpoints/autoregressive_il_final.pt
2025-06-25 17:42:18,274 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“Š Per-video analysis saved
2025-06-25 17:42:18,274 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“Š Evaluating Autoregressive IL model...
2025-06-25 17:42:18,274 - INFO - SuRL_FixedRL_138732256967136 - ğŸ“Š Evaluating Autoregressive IL Model with Planning Assessment...
