2025-06-04 22:09:42,646 - INFO - SeparateModelsComparison_135904779216000 - ğŸ¯ Experiment: separate_models_comparison_20250604_220942
2025-06-04 22:09:42,646 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“ Results dir: results/separate_models_comparison_20250604_220942
2025-06-04 22:09:42,646 - INFO - SeparateModelsComparison_135904779216000 - ğŸš€ Starting Complete Separate Models Comparison
2025-06-04 22:09:42,646 - INFO - SeparateModelsComparison_135904779216000 - ============================================================
2025-06-04 22:09:42,646 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“‚ Loading CholecT50 data...
2025-06-04 22:09:42,646 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“‚ Loading CholecT50 dataset...
2025-06-04 22:09:42,646 - ERROR - SeparateModelsComparison_135904779216000 - âŒ Data file not found: /home/maxboels/datasets/CholecT50/embeddings_f0_swin_bas_129_with_enhanced_global_metrics.csv
2025-06-04 22:09:42,646 - WARNING - SeparateModelsComparison_135904779216000 - âš ï¸ Creating dummy data for testing
2025-06-04 22:09:42,655 - INFO - SeparateModelsComparison_135904779216000 - âœ… Created 2 dummy training and 1 dummy test videos
2025-06-04 22:09:42,655 - INFO - SeparateModelsComparison_135904779216000 - âœ… Data loaded successfully
2025-06-04 22:09:42,655 - INFO - SeparateModelsComparison_135904779216000 -    Training videos: 2
2025-06-04 22:09:42,655 - INFO - SeparateModelsComparison_135904779216000 -    Test videos: 1
2025-06-04 22:09:42,655 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“ Running Method 1: Autoregressive IL
2025-06-04 22:09:42,655 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“ Method 1: Autoregressive IL Training
2025-06-04 22:09:42,655 - INFO - SeparateModelsComparison_135904779216000 - ----------------------------------------
2025-06-04 22:09:43,125 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“ Autoregressive IL Trainer initialized
2025-06-04 22:09:43,125 - INFO - SeparateModelsComparison_135904779216000 -    Device: cuda
2025-06-04 22:09:43,125 - INFO - SeparateModelsComparison_135904779216000 -    Epochs: 1
2025-06-04 22:09:43,125 - INFO - SeparateModelsComparison_135904779216000 -    Learning rate: 0.0001
2025-06-04 22:09:43,125 - INFO - SeparateModelsComparison_135904779216000 -    Focus: Causal frame generation â†’ action prediction
2025-06-04 22:09:43,125 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“ Starting Autoregressive IL Training...
2025-06-04 22:09:43,125 - INFO - SeparateModelsComparison_135904779216000 - ğŸ¯ Goal: Learn causal frame generation â†’ action prediction
2025-06-04 22:09:43,189 - ERROR - SeparateModelsComparison_135904779216000 - âŒ Method 1 failed: Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 172, in collate
    key: collate(
         ^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 271, in collate_tensor_fn
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to resize storage that is not resizable

2025-06-04 22:09:43,189 - INFO - SeparateModelsComparison_135904779216000 - ğŸŒ Running Method 2: Conditional World Model + RL
2025-06-04 22:09:43,189 - INFO - SeparateModelsComparison_135904779216000 - ğŸŒ Method 2: Conditional World Model + RL
2025-06-04 22:09:43,189 - INFO - SeparateModelsComparison_135904779216000 - ----------------------------------------
2025-06-04 22:09:43,454 - INFO - SeparateModelsComparison_135904779216000 - ğŸŒ World Model Trainer initialized
2025-06-04 22:09:43,454 - INFO - SeparateModelsComparison_135904779216000 -    Device: cuda
2025-06-04 22:09:43,454 - INFO - SeparateModelsComparison_135904779216000 -    Epochs: 1
2025-06-04 22:09:43,454 - INFO - SeparateModelsComparison_135904779216000 -    Learning rate: 0.0001
2025-06-04 22:09:43,454 - INFO - SeparateModelsComparison_135904779216000 -    Focus: Action-conditioned state-reward prediction
2025-06-04 22:09:43,454 - INFO - SeparateModelsComparison_135904779216000 - ğŸŒ Starting World Model Training...
2025-06-04 22:09:43,454 - INFO - SeparateModelsComparison_135904779216000 - ğŸ¯ Goal: Learn action-conditioned state-reward prediction
2025-06-04 22:09:44,624 - INFO - SeparateModelsComparison_135904779216000 - âœ… New best model saved: results/separate_models_comparison_20250604_220942/2025-06-04_22-09/checkpoints/world_model_best_epoch_1.pt
2025-06-04 22:09:44,624 - INFO - SeparateModelsComparison_135904779216000 - Epoch 1/1 | Train Loss: 11.3274 | Val Loss: 6.7897 | State MSE: 1.0049 | Reward MSE: 1.2745
2025-06-04 22:09:45,525 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Training plots saved to: results/separate_models_comparison_20250604_220942/2025-06-04_22-09/world_model_training_curves.png
2025-06-04 22:09:45,525 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Metrics saved to: results/separate_models_comparison_20250604_220942/2025-06-04_22-09/world_model_metrics.json
2025-06-04 22:09:45,525 - INFO - SeparateModelsComparison_135904779216000 - âœ… World Model Training completed!
2025-06-04 22:09:45,525 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“„ Best model: results/separate_models_comparison_20250604_220942/2025-06-04_22-09/checkpoints/world_model_best_epoch_1.pt
2025-06-04 22:09:45,525 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“„ Final model: results/separate_models_comparison_20250604_220942/2025-06-04_22-09/checkpoints/world_model_final.pt
2025-06-04 22:09:45,525 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Evaluating World Model...
2025-06-04 22:09:45,784 - ERROR - SeparateModelsComparison_135904779216000 - âŒ Method 2 failed: 'actions'
2025-06-04 22:09:45,787 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“¹ Running Method 3: Direct Video RL
2025-06-04 22:09:45,787 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“¹ Method 3: Direct Video RL
2025-06-04 22:09:45,787 - INFO - SeparateModelsComparison_135904779216000 - ----------------------------------------
2025-06-04 22:10:02,399 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Running Comprehensive Evaluation
2025-06-04 22:10:02,399 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Running Comprehensive Cross-Method Evaluation
2025-06-04 22:10:02,399 - INFO - SeparateModelsComparison_135904779216000 - --------------------------------------------------
2025-06-04 22:10:02,399 - INFO - SeparateModelsComparison_135904779216000 - ğŸ”¬ Integrated Evaluation Framework initialized
2025-06-04 22:10:02,399 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“ Results will be saved to: results/separate_models_comparison_20250604_220942/integrated_evaluation
2025-06-04 22:10:02,416 - INFO - SeparateModelsComparison_135904779216000 - âœ… Loaded ppo model from direct video training
2025-06-04 22:10:02,425 - INFO - SeparateModelsComparison_135904779216000 - âœ… Loaded a2c model from direct video training
2025-06-04 22:10:02,425 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Loaded 2 models for integrated evaluation
2025-06-04 22:10:02,425 - INFO - SeparateModelsComparison_135904779216000 - ğŸ¯ Running Integrated Evaluation with Rollout Saving
2025-06-04 22:10:02,425 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Evaluating 2 models on 1 videos
2025-06-04 22:10:02,425 - INFO - SeparateModelsComparison_135904779216000 - â±ï¸ Prediction horizon: 15 timesteps
2025-06-04 22:10:02,425 - INFO - SeparateModelsComparison_135904779216000 - ============================================================
2025-06-04 22:10:02,425 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“¹ Video 1/1
2025-06-04 22:10:02,425 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“¹ Evaluating test_video_1 with rollouts (horizon: 15)
2025-06-04 22:10:02,425 - INFO - SeparateModelsComparison_135904779216000 -   ğŸ¤– Evaluating DirectVideoRL_ppo with rollouts
2025-06-04 22:10:02,555 - INFO - SeparateModelsComparison_135904779216000 -     ğŸ“Š Final mAP: 0.824
2025-06-04 22:10:02,555 - INFO - SeparateModelsComparison_135904779216000 -   ğŸ¤– Evaluating DirectVideoRL_a2c with rollouts
2025-06-04 22:10:02,657 - INFO - SeparateModelsComparison_135904779216000 -     ğŸ“Š Final mAP: 0.824
2025-06-04 22:10:02,665 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Visualization data saved to: results/separate_models_comparison_20250604_220942/integrated_evaluation/visualization_data.json
2025-06-04 22:10:02,665 - INFO - SeparateModelsComparison_135904779216000 - ğŸ’¾ Saving integrated evaluation results...
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Integrated results saved to: results/separate_models_comparison_20250604_220942/integrated_evaluation
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 - ğŸ‰ INTEGRATED EVALUATION COMPLETED!
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 - ==================================================
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Key Features:
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 -   âœ… Unified mAP metrics for all methods
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 -   âœ… Detailed rollout saving at every timestep
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 -   âœ… Planning horizon visualization data
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 -   âœ… Thinking process capture
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 -   âœ… Statistical significance testing
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 -   âœ… Visualization-ready data export
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 - ğŸ† THREE-METHOD COMPARISON RESULTS
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 - ============================================================
2025-06-04 22:10:02,753 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“ Method 1: âŒ Failed - Caught RuntimeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 172, in collate
    key: collate(
         ^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 155, in collate
    return collate_fn_map[elem_type](batch, collate_fn_map=collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/maxboels/.venv/lib/python3.12/site-packages/torch/utils/data/_utils/collate.py", line 271, in collate_tensor_fn
    out = elem.new(storage).resize_(len(batch), *list(elem.size()))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to resize storage that is not resizable

2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ğŸŒ Method 2: âŒ Failed - 'actions'
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“¹ Method 3 (Direct Video RL):
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    Status: âœ… Success
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    RL Algorithms: ['ppo', 'a2c']
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      ppo: 63.142 reward
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      a2c: 63.080 reward
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    Approach: Model-free RL on real video frames
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - 
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ğŸ¯ Successful Methods: ['Method 3 (Direct RL)']
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“Š Total Methods Tested: 3
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - âœ… Success Rate: 1/3
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - 
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ğŸ—ï¸ ARCHITECTURAL INSIGHTS
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ==================================================
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“ Method 1 (Autoregressive IL):
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Pure causal modeling without action conditioning
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Actions emerge from learned frame representations
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Good for capturing temporal patterns in demonstrations
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Limited exploration beyond expert behavior
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ğŸŒ Method 2 (Conditional World Model):
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Explicit action conditioning enables true simulation
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Can explore beyond expert demonstrations
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Learns forward dynamics: state + action â†’ next_state
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Enables model-based RL and planning
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“¹ Method 3 (Direct Video RL):
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Model-free approach using real video frames
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ No simulation, limited to existing video sequences
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Direct policy optimization on offline data
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    â€¢ Baseline for comparison with model-based approaches
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - 
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 - ğŸ”¬ RESEARCH IMPLICATIONS:
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    Autoregressive IL:
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Simple training objective (supervised learning)
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Leverages pre-trained language model knowledge
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Good for dense action sequence modeling
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Interpretable causal generation process
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    Conditional World Model:
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Enables true counterfactual simulation
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Can explore beyond expert demonstrations
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Supports model-based planning and control
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Explicit action conditioning for controllability
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -    Direct Video RL:
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ No model bias or simulation errors
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Direct optimization on real data
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Simple implementation and debugging
2025-06-04 22:10:02,754 - INFO - SeparateModelsComparison_135904779216000 -      â€¢ Good baseline for model-based comparisons
2025-06-04 22:10:02,824 - WARNING - SeparateModelsComparison_135904779216000 - âš ï¸ Paper generation failed: generate_research_paper() got an unexpected keyword argument 'results'
2025-06-04 22:10:02,824 - INFO - SeparateModelsComparison_135904779216000 - ğŸ’¾ All results saved to: results/separate_models_comparison_20250604_220942
2025-06-04 22:10:02,824 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“„ Complete results: results/separate_models_comparison_20250604_220942/complete_results.json
2025-06-04 22:10:02,824 - INFO - SeparateModelsComparison_135904779216000 - ğŸ“„ Summary: results/separate_models_comparison_20250604_220942/experiment_summary.json
