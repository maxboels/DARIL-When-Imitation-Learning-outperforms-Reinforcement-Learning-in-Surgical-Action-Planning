{
  "experiment_name": "ext_eval_2025-06-09_19-17-53",
  "config": {
    "debug": true,
    "training_mode": "rl",
    "preprocess": {
      "extract_rewards": false
    },
    "experiment": {
      "max_videos": 1,
      "train": {
        "max_videos": 1
      },
      "test": {
        "max_videos": 5
      },
      "dual_world_model": {
        "train": false,
        "best_model_path": null
      },
      "il_experiments": {
        "enabled": true,
        "il_model_path": null
      },
      "rl_experiments": {
        "enabled": true,
        "eval_episodes": 5
      }
    },
    "training": {
      "epochs": 1,
      "batch_size": 8,
      "learning_rate": 0.0001,
      "log_every_n_steps": 10,
      "scheduler": {
        "type": "cosine",
        "warmup_steps": 100
      },
      "weight_decay": 0.01,
      "gradient_clip_val": 1.0,
      "dropout": 0.1,
      "num_workers": 0,
      "pin_memory": false,
      "log_dir": "debug_logs",
      "checkpoint_dir": "debug_checkpoints",
      "eval_epoch_interval": 1,
      "save_model": false
    },
    "evaluation": {
      "prediction_horizon": 10,
      "supervised": {
        "action_prediction": true
      },
      "rl": {
        "rollout_horizon": 10,
        "use_best_actions": true
      },
      "comparison": {
        "statistical_tests": true,
        "effect_size_threshold": 0.2
      },
      "world_model": {
        "use_memory": false,
        "overall_horizon": 1
      }
    },
    "rl_training": {
      "outcome_based_rewards": true,
      "rl_horizon": 25,
      "reward_mode": "dense",
      "normalize_rewards": true,
      "early_termination": true,
      "timesteps": 500,
      "reward_weights": {
        "phase_completion": 1.0,
        "risk_penalty": -0.5
      },
      "ppo": {
        "learning_rate": 0.0003,
        "value_coef": 0.5
      },
      "sac": {
        "learning_rate": 0.0003,
        "alpha": 0.2
      }
    },
    "data": {
      "context_length": 10,
      "train_shift": 1,
      "padding_value": 0.0,
      "max_horizon": 10,
      "paths": {
        "data_dir": "/home/maxboels/datasets/CholecT50",
        "class_labels_file_path": "./data/labels.json",
        "fold": 0,
        "metadata_file": "embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv",
        "video_global_outcome_file": "embeddings_f0_swin_bas_129_with_enhanced_global_metrics.csv"
      },
      "frame_risk_agg": "max"
    },
    "models": {
      "autoregressive_il": {
        "hidden_dim": 768,
        "embedding_dim": 1024,
        "n_layer": 6,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.1,
        "max_length": 512
      },
      "conditional_world_model": {
        "hidden_dim": 768,
        "embedding_dim": 1024,
        "action_embedding_dim": 128,
        "n_layer": 6,
        "num_action_classes": 100,
        "num_phase_classes": 7,
        "dropout": 0.1,
        "max_sequence_length": 256
      }
    },
    "fair_evaluation": {
      "enabled": true,
      "include_traditional_metrics": true,
      "include_clinical_metrics": true,
      "debug_mode": true,
      "verbose_logging": true,
      "save_intermediate_results": true,
      "create_visualizations": true,
      "clinical_outcome_weights": {
        "phase_progression": 2.0,
        "innovation": 0.5
      }
    },
    "supervised_learning": {
      "data_augmentation": false
    },
    "research_comparison": {
      "methods": [
        "autoregressive_il",
        "conditional_world_model",
        "direct_video_rl"
      ]
    },
    "advanced": {
      "mixed_precision": false
    },
    "hardware": {
      "persistent_workers": false
    },
    "debug_settings": {
      "detailed_metric_logging": true,
      "save_prediction_samples": true,
      "create_confusion_matrices": true,
      "analyze_worst_predictions": true,
      "analyze_best_predictions": true,
      "max_samples_to_analyze": 100,
      "create_distribution_plots": true,
      "create_correlation_plots": true,
      "save_attention_maps": false,
      "detailed_statistical_tests": true,
      "bootstrap_confidence_intervals": true,
      "effect_size_analysis": true,
      "profile_inference_time": true,
      "memory_usage_tracking": true
    },
    "results": {
      "save_predictions": true,
      "save_raw_outputs": true,
      "create_detailed_reports": true
    },
    "debug_paths": {
      "predictions_dir": "debug_predictions",
      "visualizations_dir": "debug_visualizations",
      "analysis_dir": "debug_analysis",
      "logs_dir": "debug_logs"
    }
  },
  "timestamp": "2025-06-09_19-17-53",
  "results_dir": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-17-53",
  "pretrained_dir": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58",
  "mode": "enhanced_evaluation_with_clinical_analysis",
  "method_1_autoregressive_il": {
    "status": "success",
    "model": "AutoregressiveILModel(\n  (gpt2): GPT2LMHeadModel(\n    (transformer): GPT2Model(\n      (wte): Embedding(1, 768)\n      (wpe): Embedding(1024, 768)\n      (drop): Dropout(p=0.1, inplace=False)\n      (h): ModuleList(\n        (0-5): 6 x GPT2Block(\n          (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n          (attn): GPT2SdpaAttention(\n            (c_attn): Conv1D(nf=2304, nx=768)\n            (c_proj): Conv1D(nf=768, nx=768)\n            (attn_dropout): Dropout(p=0.1, inplace=False)\n            (resid_dropout): Dropout(p=0.1, inplace=False)\n          )\n          (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n          (mlp): GPT2MLP(\n            (c_fc): Conv1D(nf=3072, nx=768)\n            (c_proj): Conv1D(nf=768, nx=3072)\n            (act): NewGELUActivation()\n            (dropout): Dropout(p=0.1, inplace=False)\n          )\n        )\n      )\n      (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n    )\n    (lm_head): Identity()\n  )\n  (frame_projection): Sequential(\n    (0): Linear(in_features=1024, out_features=768, bias=True)\n    (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n    (2): Dropout(p=0.1, inplace=False)\n  )\n  (next_frame_head): Sequential(\n    (0): Linear(in_features=768, out_features=768, bias=True)\n    (1): ReLU()\n    (2): Dropout(p=0.1, inplace=False)\n    (3): Linear(in_features=768, out_features=384, bias=True)\n    (4): ReLU()\n    (5): Dropout(p=0.1, inplace=False)\n    (6): Linear(in_features=384, out_features=1024, bias=True)\n  )\n  (action_prediction_head): Sequential(\n    (0): Linear(in_features=768, out_features=768, bias=True)\n    (1): ReLU()\n    (2): Dropout(p=0.1, inplace=False)\n    (3): Linear(in_features=768, out_features=384, bias=True)\n    (4): ReLU()\n    (5): Dropout(p=0.1, inplace=False)\n    (6): Linear(in_features=384, out_features=100, bias=True)\n  )\n  (phase_prediction_head): Sequential(\n    (0): Linear(in_features=768, out_features=384, bias=True)\n    (1): ReLU()\n    (2): Dropout(p=0.1, inplace=False)\n    (3): Linear(in_features=384, out_features=7, bias=True)\n  )\n)",
    "model_path": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/checkpoints/autoregressive_il_best_epoch_1.pt",
    "model_type": "AutoregressiveILModel",
    "approach": "Pure causal frame generation \u2192 action prediction",
    "method_description": "Autoregressive IL without action conditioning",
    "loaded_from_pretrained": true,
    "config_used": {
      "hidden_dim": 768,
      "embedding_dim": 1024,
      "n_layer": 6,
      "num_action_classes": 100,
      "num_phase_classes": 7,
      "max_length": 1024,
      "dropout": 0.1
    }
  },
  "method_2_conditional_world_model": {
    "status": "success",
    "world_model": "ConditionalWorldModel(\n  (state_projection): Sequential(\n    (0): Linear(in_features=1024, out_features=768, bias=True)\n    (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n    (2): Dropout(p=0.1, inplace=False)\n  )\n  (action_embedding): Sequential(\n    (0): Linear(in_features=100, out_features=128, bias=True)\n    (1): ReLU()\n    (2): Dropout(p=0.1, inplace=False)\n  )\n  (combined_projection): Sequential(\n    (0): Linear(in_features=896, out_features=768, bias=True)\n    (1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n    (2): Dropout(p=0.1, inplace=False)\n  )\n  (transformer): TransformerEncoder(\n    (layers): ModuleList(\n      (0-5): 6 x TransformerEncoderLayer(\n        (self_attn): MultiheadAttention(\n          (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)\n        )\n        (linear1): Linear(in_features=768, out_features=3072, bias=True)\n        (dropout): Dropout(p=0.1, inplace=False)\n        (linear2): Linear(in_features=3072, out_features=768, bias=True)\n        (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n        (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n        (dropout1): Dropout(p=0.1, inplace=False)\n        (dropout2): Dropout(p=0.1, inplace=False)\n      )\n    )\n  )\n  (next_state_head): Sequential(\n    (0): Linear(in_features=768, out_features=768, bias=True)\n    (1): ReLU()\n    (2): Dropout(p=0.1, inplace=False)\n    (3): Linear(in_features=768, out_features=384, bias=True)\n    (4): ReLU()\n    (5): Dropout(p=0.1, inplace=False)\n    (6): Linear(in_features=384, out_features=1024, bias=True)\n  )\n  (reward_heads): ModuleDict(\n    (phase_progression): Sequential(\n      (0): Linear(in_features=768, out_features=384, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=384, out_features=1, bias=True)\n    )\n    (phase_completion): Sequential(\n      (0): Linear(in_features=768, out_features=384, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=384, out_features=1, bias=True)\n    )\n    (phase_initiation): Sequential(\n      (0): Linear(in_features=768, out_features=384, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=384, out_features=1, bias=True)\n    )\n    (action_probability): Sequential(\n      (0): Linear(in_features=768, out_features=384, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=384, out_features=1, bias=True)\n    )\n    (safety): Sequential(\n      (0): Linear(in_features=768, out_features=384, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=384, out_features=1, bias=True)\n    )\n    (efficiency): Sequential(\n      (0): Linear(in_features=768, out_features=384, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=384, out_features=1, bias=True)\n    )\n    (risk_penalty): Sequential(\n      (0): Linear(in_features=768, out_features=384, bias=True)\n      (1): ReLU()\n      (2): Dropout(p=0.1, inplace=False)\n      (3): Linear(in_features=384, out_features=1, bias=True)\n    )\n  )\n  (phase_prediction_head): Sequential(\n    (0): Linear(in_features=768, out_features=384, bias=True)\n    (1): ReLU()\n    (2): Dropout(p=0.1, inplace=False)\n    (3): Linear(in_features=384, out_features=7, bias=True)\n  )\n  (value_head): Sequential(\n    (0): Linear(in_features=768, out_features=384, bias=True)\n    (1): ReLU()\n    (2): Dropout(p=0.1, inplace=False)\n    (3): Linear(in_features=384, out_features=1, bias=True)\n  )\n)",
    "world_model_path": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/checkpoints/world_model_best_epoch_2.pt",
    "rl_models": {
      "ppo": {
        "status": "success",
        "model": "<stable_baselines3.ppo.ppo.PPO object at 0x755258124c80>",
        "model_path": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/rl_world_model_simulation/ppo_conditional_world_model.zip",
        "mean_reward": -400.0
      },
      "a2c": {
        "status": "success",
        "model": "<stable_baselines3.a2c.a2c.A2C object at 0x755258cd7c20>",
        "model_path": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/rl_world_model_simulation/a2c_conditional_world_model.zip",
        "mean_reward": -405.0
      }
    },
    "model_type": "ConditionalWorldModel",
    "approach": "Action-conditioned world model + RL simulation",
    "method_description": "World model-based RL with action conditioning",
    "loaded_from_pretrained": true,
    "config_used": {
      "hidden_dim": 768,
      "embedding_dim": 1024,
      "action_embedding_dim": 128,
      "n_layer": 6,
      "num_action_classes": 100,
      "num_phase_classes": 7,
      "dropout": 0.1,
      "max_sequence_length": 512
    }
  },
  "method_3_direct_video_rl": {
    "status": "success",
    "rl_models": {
      "ppo": {
        "status": "success",
        "model": "<stable_baselines3.ppo.ppo.PPO object at 0x755258e56db0>",
        "model_path": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/direct_video_rl/ppo_direct_video.zip",
        "mean_reward": 79.5
      },
      "a2c": {
        "status": "success",
        "model": "<stable_baselines3.a2c.a2c.A2C object at 0x75525863e420>",
        "model_path": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/direct_video_rl/a2c_direct_video.zip",
        "mean_reward": 76.5
      }
    },
    "model_type": "DirectVideoRL",
    "approach": "Direct RL on video sequences (no world model)",
    "method_description": "Model-free RL on offline video episodes",
    "loaded_from_pretrained": true
  },
  "comprehensive_evaluation": {
    "evaluator": "<evaluation.integrated_evaluation.IntegratedEvaluationFramework object at 0x7552585bf260>",
    "results": {
      "status": "success",
      "evaluation_type": "comprehensive_evaluation_with_proper_batches",
      "num_models": 5,
      "num_videos": 5,
      "horizon": 10,
      "video_results": {
        "VID02": {
          "error": "'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'"
        },
        "VID06": {
          "error": "'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'"
        },
        "VID111": {
          "error": "'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'"
        },
        "VID14": {
          "error": "'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'"
        },
        "VID23": {
          "error": "'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'"
        }
      },
      "aggregate_results": {
        "single_step_comparison": {},
        "planning_analysis": {},
        "method_rankings": {
          "single_step_ranking": [],
          "planning_ranking": []
        }
      },
      "statistical_tests": {},
      "evaluation_design": {
        "data_handling": "uses_dataloader_batches_like_training",
        "temporal_structure": "maintained_properly",
        "model_interfaces": "consistent_with_training",
        "primary_evaluation": "single_step_action_prediction_with_proper_context",
        "secondary_evaluation": "multi_step_planning_analysis",
        "fairness_approach": "respects_training_paradigms_and_data_structure"
      },
      "timestamp": "2025-06-09 19:17:57.636252",
      "correction_applied": {
        "ground_truth_leakage": "eliminated",
        "environment_mismatch": "fixed",
        "evaluation_fairness": "implemented",
        "paradigm_respect": "ensured",
        "evaluation_approach": "two_tier_fair_comparison",
        "action_shape_issues": "resolved",
        "world_model_trainer_issues": "resolved"
      }
    },
    "file_paths": {
      "corrected_evaluation": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-17-53/integrated_evaluation/corrected_evaluation_results.json",
      "fair_comparison": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-17-53/integrated_evaluation/fair_single_step_comparison.csv",
      "planning_analysis": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-17-53/integrated_evaluation/planning_capability_analysis.csv",
      "correction_documentation": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-17-53/integrated_evaluation/evaluation_corrections.json"
    },
    "correction_report": {
      "original_issues": [
        "World model not used in Method 2 evaluation",
        "Ground truth future states leaked to RL methods",
        "Unfair comparison across different paradigms",
        "Environment mismatch between training and evaluation",
        "Action shape mismatches in planning evaluation",
        "World model trainer expecting single DataLoader vs dictionary"
      ],
      "corrections_applied": [
        "Single-step action prediction as primary fair comparison",
        "World model used only for Method 2 planning analysis",
        "No future ground truth state access for any method",
        "Method-specific evaluation respecting training paradigms",
        "Two-tier evaluation: fair comparison + capability analysis",
        "Fixed action shape handling in RL planning sequences",
        "Fixed world model trainer to handle dictionary of test loaders"
      ],
      "evaluation_validity": {
        "primary_comparison": "fair_and_valid",
        "secondary_analysis": "paradigm_specific_insights",
        "overall_approach": "methodologically_sound",
        "technical_issues": "resolved"
      }
    },
    "status": "corrected_and_completed"
  },
  "clinical_evaluation": {
    "method_1_autoregressive_il": {
      "clinical_overview": {
        "standard_map": 0.7167678826920578,
        "fair_map": 0.40225847850605256,
        "clinical_weighted_map": 0.46542282412598196,
        "total_actions": 100,
        "occurring_actions": 34,
        "evaluated_actions": 34
      },
      "instrument_analysis": {
        "grasper": {
          "map": 0.3214235488763787,
          "count": 11,
          "actions": [
            3,
            4,
            7,
            8,
            10,
            12,
            17,
            18,
            19,
            20,
            94
          ],
          "ap_scores": [
            0.02684939798616499,
            0.061691829537333175,
            0.022590751188204288,
            0.0024217321702208004,
            0.019605108629639986,
            0.8480210170339058,
            0.7986953655573243,
            0.10787127352369635,
            0.7826434810485979,
            0.4577681768885535,
            0.4075009040765244
          ]
        },
        "bipolar": {
          "map": 0.360160334947929,
          "count": 5,
          "actions": [
            26,
            29,
            44,
            45,
            95
          ],
          "ap_scores": [
            0.23309782050336741,
            0.8829292000024477,
            0.15134281802787353,
            0.41646849823501747,
            0.1169633379709387
          ]
        },
        "hook": {
          "map": 0.5018529410849552,
          "count": 6,
          "actions": [
            51,
            57,
            58,
            60,
            61,
            96
          ],
          "ap_scores": [
            0.055640243902439025,
            0.42883578715968557,
            0.46420465195222954,
            0.912695064849042,
            0.9646784920550422,
            0.18506340659129308
          ]
        },
        "scissors": {
          "map": 0.43333310751004284,
          "count": 4,
          "actions": [
            66,
            68,
            69,
            97
          ],
          "ap_scores": [
            0.06206385768651136,
            0.745395382455779,
            0.7387072497551236,
            0.18716594014275753
          ]
        },
        "clipper": {
          "map": 0.5232899491071351,
          "count": 3,
          "actions": [
            78,
            79,
            98
          ],
          "ap_scores": [
            0.6673685533256924,
            0.8280513252720014,
            0.07444996872371172
          ]
        },
        "irrigator": {
          "map": 0.40520152659093317,
          "count": 5,
          "actions": [
            82,
            88,
            90,
            92,
            99
          ],
          "ap_scores": [
            0.7615933494150529,
            0.5459090909090909,
            0.2135931186333872,
            0.10996939409213487,
            0.39494267990500015
          ]
        }
      },
      "anatomical_analysis": {
        "cystic_plate": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "gallbladder": {
          "map": 0.4474053563742524,
          "count": 4,
          "actions": [
            7,
            17,
            51,
            60
          ],
          "ap_scores": [
            0.022590751188204288,
            0.7986953655573243,
            0.055640243902439025,
            0.912695064849042
          ]
        },
        "omentum": {
          "map": 0.46463006895206327,
          "count": 4,
          "actions": [
            10,
            20,
            45,
            61
          ],
          "ap_scores": [
            0.019605108629639986,
            0.4577681768885535,
            0.41646849823501747,
            0.9646784920550422
          ]
        },
        "cystic_artery": {
          "map": 0.4671122802318305,
          "count": 4,
          "actions": [
            3,
            57,
            68,
            78
          ],
          "ap_scores": [
            0.02684939798616499,
            0.42883578715968557,
            0.745395382455779,
            0.6673685533256924
          ]
        },
        "cystic_duct": {
          "map": 0.523163764129172,
          "count": 4,
          "actions": [
            4,
            58,
            69,
            79
          ],
          "ap_scores": [
            0.061691829537333175,
            0.46420465195222954,
            0.7387072497551236,
            0.8280513252720014
          ]
        },
        "cystic_pedicle": {
          "map": 0.23309782050336741,
          "count": 1,
          "actions": [
            26
          ],
          "ap_scores": [
            0.23309782050336741
          ]
        },
        "gut": {
          "map": 0.05514650284695858,
          "count": 2,
          "actions": [
            8,
            18
          ],
          "ap_scores": [
            0.0024217321702208004,
            0.10787127352369635
          ]
        },
        "liver": {
          "map": 0.4280956023608883,
          "count": 5,
          "actions": [
            19,
            29,
            44,
            90,
            92
          ],
          "ap_scores": [
            0.7826434810485979,
            0.8829292000024477,
            0.15134281802787353,
            0.2135931186333872,
            0.10996939409213487
          ]
        },
        "peritoneum": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "specimen_bag": {
          "map": 0.8480210170339058,
          "count": 1,
          "actions": [
            12
          ],
          "ap_scores": [
            0.8480210170339058
          ]
        },
        "abdominal_wall_cavity": {
          "map": 0.5459090909090909,
          "count": 1,
          "actions": [
            88
          ],
          "ap_scores": [
            0.5459090909090909
          ]
        },
        "blood_vessel": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "adhesion": {
          "map": 0.06206385768651136,
          "count": 1,
          "actions": [
            66
          ],
          "ap_scores": [
            0.06206385768651136
          ]
        },
        "fluid": {
          "map": 0.7615933494150529,
          "count": 1,
          "actions": [
            82
          ],
          "ap_scores": [
            0.7615933494150529
          ]
        },
        "null_target": {
          "map": 0.22768103956837094,
          "count": 6,
          "actions": [
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.4075009040765244,
            0.1169633379709387,
            0.18506340659129308,
            0.18716594014275753,
            0.07444996872371172,
            0.39494267990500015
          ]
        }
      },
      "procedural_analysis": {
        "dissect": {
          "map": 0.6926034990039998,
          "count": 4,
          "actions": [
            57,
            58,
            60,
            61
          ],
          "ap_scores": [
            0.42883578715968557,
            0.46420465195222954,
            0.912695064849042,
            0.9646784920550422
          ]
        },
        "grasp": {
          "map": 0.16352997275757816,
          "count": 6,
          "actions": [
            3,
            4,
            7,
            8,
            10,
            12
          ],
          "ap_scores": [
            0.02684939798616499,
            0.061691829537333175,
            0.022590751188204288,
            0.0024217321702208004,
            0.019605108629639986,
            0.8480210170339058
          ]
        },
        "pack": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "retract": {
          "map": 0.40353700105331397,
          "count": 7,
          "actions": [
            17,
            18,
            19,
            20,
            44,
            45,
            92
          ],
          "ap_scores": [
            0.7986953655573243,
            0.10787127352369635,
            0.7826434810485979,
            0.4577681768885535,
            0.15134281802787353,
            0.41646849823501747,
            0.10996939409213487
          ]
        },
        "coagulate": {
          "map": 0.3905557548027514,
          "count": 3,
          "actions": [
            26,
            29,
            51
          ],
          "ap_scores": [
            0.23309782050336741,
            0.8829292000024477,
            0.055640243902439025
          ]
        },
        "cut": {
          "map": 0.5153888299658046,
          "count": 3,
          "actions": [
            66,
            68,
            69
          ],
          "ap_scores": [
            0.06206385768651136,
            0.745395382455779,
            0.7387072497551236
          ]
        },
        "clip": {
          "map": 0.7477099392988469,
          "count": 2,
          "actions": [
            78,
            79
          ],
          "ap_scores": [
            0.6673685533256924,
            0.8280513252720014
          ]
        },
        "aspirate": {
          "map": 0.7615933494150529,
          "count": 1,
          "actions": [
            82
          ],
          "ap_scores": [
            0.7615933494150529
          ]
        },
        "irrigate": {
          "map": 0.3797511047712391,
          "count": 2,
          "actions": [
            88,
            90
          ],
          "ap_scores": [
            0.5459090909090909,
            0.2135931186333872
          ]
        },
        "null_verb": {
          "map": 0.22768103956837094,
          "count": 6,
          "actions": [
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.4075009040765244,
            0.1169633379709387,
            0.18506340659129308,
            0.18716594014275753,
            0.07444996872371172,
            0.39494267990500015
          ]
        }
      },
      "phase_analysis": {
        "preparation": {
          "map": 0.22768103956837094,
          "count": 6,
          "actions": [
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.4075009040765244,
            0.1169633379709387,
            0.18506340659129308,
            0.18716594014275753,
            0.07444996872371172,
            0.39494267990500015
          ]
        },
        "calot_triangle_dissection": {
          "map": 0.28974389278519297,
          "count": 14,
          "actions": [
            3,
            4,
            8,
            10,
            18,
            19,
            20,
            44,
            45,
            57,
            58,
            61,
            66,
            92
          ],
          "ap_scores": [
            0.02684939798616499,
            0.061691829537333175,
            0.0024217321702208004,
            0.019605108629639986,
            0.10787127352369635,
            0.7826434810485979,
            0.4577681768885535,
            0.15134281802787353,
            0.41646849823501747,
            0.42883578715968557,
            0.46420465195222954,
            0.9646784920550422,
            0.06206385768651136,
            0.10996939409213487
          ]
        },
        "clipping_and_cutting": {
          "map": 0.7448806277021491,
          "count": 4,
          "actions": [
            68,
            69,
            78,
            79
          ],
          "ap_scores": [
            0.745395382455779,
            0.7387072497551236,
            0.6673685533256924,
            0.8280513252720014
          ]
        },
        "gallbladder_dissection": {
          "map": 0.4676429080186231,
          "count": 2,
          "actions": [
            7,
            60
          ],
          "ap_scores": [
            0.022590751188204288,
            0.912695064849042
          ]
        },
        "gallbladder_packaging": {
          "map": 0.8480210170339058,
          "count": 1,
          "actions": [
            12
          ],
          "ap_scores": [
            0.8480210170339058
          ]
        },
        "cleaning_and_coagulation": {
          "map": 0.4487938038942975,
          "count": 6,
          "actions": [
            26,
            29,
            51,
            82,
            88,
            90
          ],
          "ap_scores": [
            0.23309782050336741,
            0.8829292000024477,
            0.055640243902439025,
            0.7615933494150529,
            0.5459090909090909,
            0.2135931186333872
          ]
        },
        "gallbladder_extraction": {
          "map": 0.7986953655573243,
          "count": 1,
          "actions": [
            17
          ],
          "ap_scores": [
            0.7986953655573243
          ]
        }
      },
      "complexity_analysis": {
        "basic": {
          "map": 0.2990284619885526,
          "count": 17,
          "actions": [
            7,
            8,
            10,
            12,
            17,
            18,
            19,
            20,
            44,
            45,
            92,
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.022590751188204288,
            0.0024217321702208004,
            0.019605108629639986,
            0.8480210170339058,
            0.7986953655573243,
            0.10787127352369635,
            0.7826434810485979,
            0.4577681768885535,
            0.15134281802787353,
            0.41646849823501747,
            0.10996939409213487,
            0.4075009040765244,
            0.1169633379709387,
            0.18506340659129308,
            0.18716594014275753,
            0.07444996872371172,
            0.39494267990500015
          ]
        },
        "intermediate": {
          "map": 0.4658677607793368,
          "count": 10,
          "actions": [
            3,
            4,
            26,
            29,
            51,
            60,
            61,
            82,
            88,
            90
          ],
          "ap_scores": [
            0.02684939798616499,
            0.061691829537333175,
            0.23309782050336741,
            0.8829292000024477,
            0.055640243902439025,
            0.912695064849042,
            0.9646784920550422,
            0.7615933494150529,
            0.5459090909090909,
            0.2135931186333872
          ]
        },
        "advanced": {
          "map": 0.3183680989328088,
          "count": 3,
          "actions": [
            57,
            58,
            66
          ],
          "ap_scores": [
            0.42883578715968557,
            0.46420465195222954,
            0.06206385768651136
          ]
        },
        "expert": {
          "map": 0.7448806277021491,
          "count": 4,
          "actions": [
            68,
            69,
            78,
            79
          ],
          "ap_scores": [
            0.745395382455779,
            0.7387072497551236,
            0.6673685533256924,
            0.8280513252720014
          ]
        }
      },
      "criticality_analysis": {
        "routine": {
          "map": 0.3604408526103794,
          "weighted_map": 0.3760995648541446,
          "count": 21,
          "actions": [
            7,
            8,
            10,
            12,
            17,
            18,
            19,
            20,
            44,
            45,
            61,
            82,
            88,
            90,
            92,
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.022590751188204288,
            0.0024217321702208004,
            0.019605108629639986,
            0.8480210170339058,
            0.7986953655573243,
            0.10787127352369635,
            0.7826434810485979,
            0.4577681768885535,
            0.15134281802787353,
            0.41646849823501747,
            0.9646784920550422,
            0.7615933494150529,
            0.5459090909090909,
            0.2135931186333872,
            0.10996939409213487,
            0.4075009040765244,
            0.1169633379709387,
            0.18506340659129308,
            0.18716594014275753,
            0.07444996872371172,
            0.39494267990500015
          ],
          "avg_weight": 1.0714285714285714
        },
        "important": {
          "map": 0.347556428175469,
          "weighted_map": 0.3423452479458652,
          "count": 9,
          "actions": [
            3,
            4,
            26,
            29,
            51,
            57,
            58,
            60,
            66
          ],
          "ap_scores": [
            0.02684939798616499,
            0.061691829537333175,
            0.23309782050336741,
            0.8829292000024477,
            0.055640243902439025,
            0.42883578715968557,
            0.46420465195222954,
            0.912695064849042,
            0.06206385768651136
          ],
          "avg_weight": 2.2222222222222223
        },
        "critical": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "extremely_critical": {
          "map": 0.7448806277021491,
          "weighted_map": 0.7448806277021491,
          "count": 4,
          "actions": [
            68,
            69,
            78,
            79
          ],
          "ap_scores": [
            0.745395382455779,
            0.7387072497551236,
            0.6673685533256924,
            0.8280513252720014
          ],
          "avg_weight": 4.0
        }
      }
    },
    "method_2_conditional_world_model": {
      "clinical_overview": {
        "standard_map": 0.015041768500493258,
        "fair_map": 0.04424049558968606,
        "clinical_weighted_map": 0.04368080205225775,
        "total_actions": 100,
        "occurring_actions": 34,
        "evaluated_actions": 34
      },
      "instrument_analysis": {
        "grasper": {
          "map": 0.06288753758837175,
          "count": 11,
          "actions": [
            3,
            4,
            7,
            8,
            10,
            12,
            17,
            18,
            19,
            20,
            94
          ],
          "ap_scores": [
            0.013026201418575297,
            0.0063032369232025025,
            0.008231570596770366,
            0.004514008371420594,
            0.007614201923883314,
            0.019728336129195487,
            0.346033426126232,
            0.026269359872661505,
            0.13197950589330204,
            0.072043108339151,
            0.056019957877695245
          ]
        },
        "bipolar": {
          "map": 0.01117339599870471,
          "count": 5,
          "actions": [
            26,
            29,
            44,
            45,
            95
          ],
          "ap_scores": [
            0.007613398984666097,
            0.02567848990944009,
            0.007942706236002298,
            0.005518285896562944,
            0.00911409896685211
          ]
        },
        "hook": {
          "map": 0.09516711145758337,
          "count": 6,
          "actions": [
            51,
            57,
            58,
            60,
            61,
            96
          ],
          "ap_scores": [
            0.010271317829457364,
            0.031677679619123704,
            0.10630715428778809,
            0.3748736379374971,
            0.03856002897870772,
            0.009312850092926298
          ]
        },
        "scissors": {
          "map": 0.020790402087227756,
          "count": 4,
          "actions": [
            66,
            68,
            69,
            97
          ],
          "ap_scores": [
            0.05195759855767003,
            0.013101025622756363,
            0.013142015520419395,
            0.004960968648065238
          ]
        },
        "clipper": {
          "map": 0.008773774870295343,
          "count": 3,
          "actions": [
            78,
            79,
            98
          ],
          "ap_scores": [
            0.012197053468216895,
            0.011257927498260645,
            0.0028663436444084887
          ]
        },
        "irrigator": {
          "map": 0.015212270975683135,
          "count": 5,
          "actions": [
            82,
            88,
            90,
            92,
            99
          ],
          "ap_scores": [
            0.035592429959136335,
            0.001966061967362603,
            0.006943530023682734,
            0.011571814642289964,
            0.019987518285944035
          ]
        }
      },
      "anatomical_analysis": {
        "cystic_plate": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "gallbladder": {
          "map": 0.18485248812248922,
          "count": 4,
          "actions": [
            7,
            17,
            51,
            60
          ],
          "ap_scores": [
            0.008231570596770366,
            0.346033426126232,
            0.010271317829457364,
            0.3748736379374971
          ]
        },
        "omentum": {
          "map": 0.030933906284576245,
          "count": 4,
          "actions": [
            10,
            20,
            45,
            61
          ],
          "ap_scores": [
            0.007614201923883314,
            0.072043108339151,
            0.005518285896562944,
            0.03856002897870772
          ]
        },
        "cystic_artery": {
          "map": 0.017500490032168064,
          "count": 4,
          "actions": [
            3,
            57,
            68,
            78
          ],
          "ap_scores": [
            0.013026201418575297,
            0.031677679619123704,
            0.013101025622756363,
            0.012197053468216895
          ]
        },
        "cystic_duct": {
          "map": 0.03425258355741766,
          "count": 4,
          "actions": [
            4,
            58,
            69,
            79
          ],
          "ap_scores": [
            0.0063032369232025025,
            0.10630715428778809,
            0.013142015520419395,
            0.011257927498260645
          ]
        },
        "cystic_pedicle": {
          "map": 0.007613398984666097,
          "count": 1,
          "actions": [
            26
          ],
          "ap_scores": [
            0.007613398984666097
          ]
        },
        "gut": {
          "map": 0.01539168412204105,
          "count": 2,
          "actions": [
            8,
            18
          ],
          "ap_scores": [
            0.004514008371420594,
            0.026269359872661505
          ]
        },
        "liver": {
          "map": 0.03682320934094342,
          "count": 5,
          "actions": [
            19,
            29,
            44,
            90,
            92
          ],
          "ap_scores": [
            0.13197950589330204,
            0.02567848990944009,
            0.007942706236002298,
            0.006943530023682734,
            0.011571814642289964
          ]
        },
        "peritoneum": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "specimen_bag": {
          "map": 0.019728336129195487,
          "count": 1,
          "actions": [
            12
          ],
          "ap_scores": [
            0.019728336129195487
          ]
        },
        "abdominal_wall_cavity": {
          "map": 0.001966061967362603,
          "count": 1,
          "actions": [
            88
          ],
          "ap_scores": [
            0.001966061967362603
          ]
        },
        "blood_vessel": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "adhesion": {
          "map": 0.05195759855767003,
          "count": 1,
          "actions": [
            66
          ],
          "ap_scores": [
            0.05195759855767003
          ]
        },
        "fluid": {
          "map": 0.035592429959136335,
          "count": 1,
          "actions": [
            82
          ],
          "ap_scores": [
            0.035592429959136335
          ]
        },
        "null_target": {
          "map": 0.01704362291931524,
          "count": 6,
          "actions": [
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.056019957877695245,
            0.00911409896685211,
            0.009312850092926298,
            0.004960968648065238,
            0.0028663436444084887,
            0.019987518285944035
          ]
        }
      },
      "procedural_analysis": {
        "dissect": {
          "map": 0.13785462520577915,
          "count": 4,
          "actions": [
            57,
            58,
            60,
            61
          ],
          "ap_scores": [
            0.031677679619123704,
            0.10630715428778809,
            0.3748736379374971,
            0.03856002897870772
          ]
        },
        "grasp": {
          "map": 0.00990292589384126,
          "count": 6,
          "actions": [
            3,
            4,
            7,
            8,
            10,
            12
          ],
          "ap_scores": [
            0.013026201418575297,
            0.0063032369232025025,
            0.008231570596770366,
            0.004514008371420594,
            0.007614201923883314,
            0.019728336129195487
          ]
        },
        "pack": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "retract": {
          "map": 0.08590831528660024,
          "count": 7,
          "actions": [
            17,
            18,
            19,
            20,
            44,
            45,
            92
          ],
          "ap_scores": [
            0.346033426126232,
            0.026269359872661505,
            0.13197950589330204,
            0.072043108339151,
            0.007942706236002298,
            0.005518285896562944,
            0.011571814642289964
          ]
        },
        "coagulate": {
          "map": 0.014521068907854519,
          "count": 3,
          "actions": [
            26,
            29,
            51
          ],
          "ap_scores": [
            0.007613398984666097,
            0.02567848990944009,
            0.010271317829457364
          ]
        },
        "cut": {
          "map": 0.02606687990028193,
          "count": 3,
          "actions": [
            66,
            68,
            69
          ],
          "ap_scores": [
            0.05195759855767003,
            0.013101025622756363,
            0.013142015520419395
          ]
        },
        "clip": {
          "map": 0.01172749048323877,
          "count": 2,
          "actions": [
            78,
            79
          ],
          "ap_scores": [
            0.012197053468216895,
            0.011257927498260645
          ]
        },
        "aspirate": {
          "map": 0.035592429959136335,
          "count": 1,
          "actions": [
            82
          ],
          "ap_scores": [
            0.035592429959136335
          ]
        },
        "irrigate": {
          "map": 0.004454795995522669,
          "count": 2,
          "actions": [
            88,
            90
          ],
          "ap_scores": [
            0.001966061967362603,
            0.006943530023682734
          ]
        },
        "null_verb": {
          "map": 0.01704362291931524,
          "count": 6,
          "actions": [
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.056019957877695245,
            0.00911409896685211,
            0.009312850092926298,
            0.004960968648065238,
            0.0028663436444084887,
            0.019987518285944035
          ]
        }
      },
      "phase_analysis": {
        "preparation": {
          "map": 0.01704362291931524,
          "count": 6,
          "actions": [
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.056019957877695245,
            0.00911409896685211,
            0.009312850092926298,
            0.004960968648065238,
            0.0028663436444084887,
            0.019987518285944035
          ]
        },
        "calot_triangle_dissection": {
          "map": 0.03680606364002436,
          "count": 14,
          "actions": [
            3,
            4,
            8,
            10,
            18,
            19,
            20,
            44,
            45,
            57,
            58,
            61,
            66,
            92
          ],
          "ap_scores": [
            0.013026201418575297,
            0.0063032369232025025,
            0.004514008371420594,
            0.007614201923883314,
            0.026269359872661505,
            0.13197950589330204,
            0.072043108339151,
            0.007942706236002298,
            0.005518285896562944,
            0.031677679619123704,
            0.10630715428778809,
            0.03856002897870772,
            0.05195759855767003,
            0.011571814642289964
          ]
        },
        "clipping_and_cutting": {
          "map": 0.012424505527413324,
          "count": 4,
          "actions": [
            68,
            69,
            78,
            79
          ],
          "ap_scores": [
            0.013101025622756363,
            0.013142015520419395,
            0.012197053468216895,
            0.011257927498260645
          ]
        },
        "gallbladder_dissection": {
          "map": 0.19155260426713375,
          "count": 2,
          "actions": [
            7,
            60
          ],
          "ap_scores": [
            0.008231570596770366,
            0.3748736379374971
          ]
        },
        "gallbladder_packaging": {
          "map": 0.019728336129195487,
          "count": 1,
          "actions": [
            12
          ],
          "ap_scores": [
            0.019728336129195487
          ]
        },
        "cleaning_and_coagulation": {
          "map": 0.014677538112290873,
          "count": 6,
          "actions": [
            26,
            29,
            51,
            82,
            88,
            90
          ],
          "ap_scores": [
            0.007613398984666097,
            0.02567848990944009,
            0.010271317829457364,
            0.035592429959136335,
            0.001966061967362603,
            0.006943530023682734
          ]
        },
        "gallbladder_extraction": {
          "map": 0.346033426126232,
          "count": 1,
          "actions": [
            17
          ],
          "ap_scores": [
            0.346033426126232
          ]
        }
      },
      "complexity_analysis": {
        "basic": {
          "map": 0.04374753303196253,
          "count": 17,
          "actions": [
            7,
            8,
            10,
            12,
            17,
            18,
            19,
            20,
            44,
            45,
            92,
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.008231570596770366,
            0.004514008371420594,
            0.007614201923883314,
            0.019728336129195487,
            0.346033426126232,
            0.026269359872661505,
            0.13197950589330204,
            0.072043108339151,
            0.007942706236002298,
            0.005518285896562944,
            0.011571814642289964,
            0.056019957877695245,
            0.00911409896685211,
            0.009312850092926298,
            0.004960968648065238,
            0.0028663436444084887,
            0.019987518285944035
          ]
        },
        "intermediate": {
          "map": 0.05208283339317279,
          "count": 10,
          "actions": [
            3,
            4,
            26,
            29,
            51,
            60,
            61,
            82,
            88,
            90
          ],
          "ap_scores": [
            0.013026201418575297,
            0.0063032369232025025,
            0.007613398984666097,
            0.02567848990944009,
            0.010271317829457364,
            0.3748736379374971,
            0.03856002897870772,
            0.035592429959136335,
            0.001966061967362603,
            0.006943530023682734
          ]
        },
        "advanced": {
          "map": 0.0633141441548606,
          "count": 3,
          "actions": [
            57,
            58,
            66
          ],
          "ap_scores": [
            0.031677679619123704,
            0.10630715428778809,
            0.05195759855767003
          ]
        },
        "expert": {
          "map": 0.012424505527413324,
          "count": 4,
          "actions": [
            68,
            69,
            78,
            79
          ],
          "ap_scores": [
            0.013101025622756363,
            0.013142015520419395,
            0.012197053468216895,
            0.011257927498260645
          ]
        }
      },
      "criticality_analysis": {
        "routine": {
          "map": 0.039370005355821545,
          "weighted_map": 0.045474783347693656,
          "count": 21,
          "actions": [
            7,
            8,
            10,
            12,
            17,
            18,
            19,
            20,
            44,
            45,
            61,
            82,
            88,
            90,
            92,
            94,
            95,
            96,
            97,
            98,
            99
          ],
          "ap_scores": [
            0.008231570596770366,
            0.004514008371420594,
            0.007614201923883314,
            0.019728336129195487,
            0.346033426126232,
            0.026269359872661505,
            0.13197950589330204,
            0.072043108339151,
            0.007942706236002298,
            0.005518285896562944,
            0.03856002897870772,
            0.035592429959136335,
            0.001966061967362603,
            0.006943530023682734,
            0.011571814642289964,
            0.056019957877695245,
            0.00911409896685211,
            0.009312850092926298,
            0.004960968648065238,
            0.0028663436444084887,
            0.019987518285944035
          ],
          "avg_weight": 1.0714285714285714
        },
        "important": {
          "map": 0.06974541282971336,
          "weighted_map": 0.06666761031476791,
          "count": 9,
          "actions": [
            3,
            4,
            26,
            29,
            51,
            57,
            58,
            60,
            66
          ],
          "ap_scores": [
            0.013026201418575297,
            0.0063032369232025025,
            0.007613398984666097,
            0.02567848990944009,
            0.010271317829457364,
            0.031677679619123704,
            0.10630715428778809,
            0.3748736379374971,
            0.05195759855767003
          ],
          "avg_weight": 2.2222222222222223
        },
        "critical": {
          "map": 0.0,
          "count": 0,
          "actions": []
        },
        "extremely_critical": {
          "map": 0.012424505527413324,
          "weighted_map": 0.012424505527413324,
          "count": 4,
          "actions": [
            68,
            69,
            78,
            79
          ],
          "ap_scores": [
            0.013101025622756363,
            0.013142015520419395,
            0.012197053468216895,
            0.011257927498260645
          ],
          "avg_weight": 4.0
        }
      }
    },
    "method_3_direct_video_rl": {
      "status": "failed",
      "error": "No model found for method_3_direct_video_rl"
    }
  },
  "metric_debugging": {
    "method_1_autoregressive_il": {
      "method_name": "method_1_autoregressive_il",
      "metric_breakdown": {
        "overall_map": 0.7777777777777777,
        "exact_match_rate": 0.925,
        "num_evaluated_classes": 1,
        "per_class_metrics": {},
        "prediction_stats": {
          "mean": "0.0007861889",
          "std": "0.013239174",
          "min": "2.2083183e-10",
          "max": "0.68492323"
        }
      },
      "sample_analysis": {
        "mean_sample_accuracy": 0.999,
        "std_sample_accuracy": 0.0037416573867739447,
        "best_sample": {
          "index": 0,
          "accuracy": 1.0,
          "num_predicted_actions": 0,
          "num_true_actions": 0
        },
        "worst_sample": {
          "index": 39,
          "accuracy": 0.98,
          "num_predicted_actions": 1,
          "num_true_actions": 1
        }
      },
      "distribution_analysis": {
        "prediction_distribution": {
          "mean": 0.000786188873462379,
          "std": 0.013239174149930477,
          "percentiles": {
            "25": 1.5495082195116083e-07,
            "50": 1.2502740673880908e-06,
            "75": 1.552143521621474e-05,
            "90": 0.00022824042825959613,
            "95": 0.0011859687161631797
          }
        },
        "ground_truth_distribution": {
          "sparsity": 0.9992499999934807,
          "mean_actions_per_sample": 0.07500000298023224,
          "most_frequent_actions": [
            27,
            26,
            35,
            99,
            66
          ],
          "action_frequencies": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ]
        }
      }
    },
    "method_2_conditional_world_model": {
      "method_name": "method_2_conditional_world_model",
      "metric_breakdown": {
        "overall_map": 0.09511784511784512,
        "exact_match_rate": 0.0,
        "num_evaluated_classes": 1,
        "per_class_metrics": {},
        "prediction_stats": {
          "mean": "0.49934086",
          "std": "0.20853965",
          "min": "0.031947523",
          "max": "0.9745953"
        }
      },
      "sample_analysis": {
        "mean_sample_accuracy": 0.506,
        "std_sample_accuracy": 0.03576310948449535,
        "best_sample": {
          "index": 20,
          "accuracy": 0.56,
          "num_predicted_actions": 44,
          "num_true_actions": 0
        },
        "worst_sample": {
          "index": 7,
          "accuracy": 0.43,
          "num_predicted_actions": 57,
          "num_true_actions": 0
        }
      },
      "distribution_analysis": {
        "prediction_distribution": {
          "mean": 0.49934086203575134,
          "std": 0.20853964984416962,
          "percentiles": {
            "25": 0.3370298594236374,
            "50": 0.4960153251886368,
            "75": 0.6624955087900162,
            "90": 0.7828108906745911,
            "95": 0.8423726737499236
          }
        },
        "ground_truth_distribution": {
          "sparsity": 0.9992499999934807,
          "mean_actions_per_sample": 0.07500000298023224,
          "most_frequent_actions": [
            27,
            26,
            35,
            99,
            66
          ],
          "action_frequencies": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ]
        }
      }
    },
    "method_3_direct_video_rl": {
      "method_name": "method_3_direct_video_rl",
      "metric_breakdown": {
        "overall_map": 0.2185185185185185,
        "exact_match_rate": 0.0,
        "num_evaluated_classes": 1,
        "per_class_metrics": {},
        "prediction_stats": {
          "mean": "0.5045895",
          "std": "0.20557286",
          "min": "0.01709029",
          "max": "0.9690168"
        }
      },
      "sample_analysis": {
        "mean_sample_accuracy": 0.48775,
        "std_sample_accuracy": 0.04210032660205856,
        "best_sample": {
          "index": 23,
          "accuracy": 0.57,
          "num_predicted_actions": 43,
          "num_true_actions": 0
        },
        "worst_sample": {
          "index": 5,
          "accuracy": 0.39,
          "num_predicted_actions": 61,
          "num_true_actions": 0
        }
      },
      "distribution_analysis": {
        "prediction_distribution": {
          "mean": 0.5045894980430603,
          "std": 0.20557285845279694,
          "percentiles": {
            "25": 0.34301405400037766,
            "50": 0.5071702301502228,
            "75": 0.6640271693468094,
            "90": 0.7832025408744812,
            "95": 0.8354243904352188
          }
        },
        "ground_truth_distribution": {
          "sparsity": 0.9992499999934807,
          "mean_actions_per_sample": 0.07500000298023224,
          "most_frequent_actions": [
            27,
            26,
            35,
            99,
            66
          ],
          "action_frequencies": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            3.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ]
        }
      }
    }
  },
  "visualizations": {
    "status": "success",
    "visualizations_dir": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-17-53/visualizations"
  },
  "reports": {
    "executive_summary": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-17-53/executive_summary.md",
    "technical_report": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-17-53/technical_report.md",
    "clinical_summary": "/home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-17-53/clinical_evaluation/clinical_summary.md"
  }
}