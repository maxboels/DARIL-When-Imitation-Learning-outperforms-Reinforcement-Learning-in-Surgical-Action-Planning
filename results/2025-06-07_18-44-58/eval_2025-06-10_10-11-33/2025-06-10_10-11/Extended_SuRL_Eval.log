2025-06-10 10:11:33,624 - INFO - Extended_SuRL_Eval_139984931075520 - Shared experiment log directory: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/eval_2025-06-10_10-11-33/2025-06-10_10-11
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ¥ Clinical evaluator initialized
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ”¬ Enhanced Evaluation Experiment: eval_2025-06-10_10-11-33
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“ Loading models from: /home/maxboels/projects/surl/results/2025-06-07_18-44-58
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“ Saving results to: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/eval_2025-06-10_10-11-33
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ¥ Clinical evaluation: ENABLED
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“Š Metric debugging: ENABLED
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸš€ Starting ENHANCED EVALUATION with Clinical Analysis
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ======================================================================
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ¯ Features:
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Standard evaluation metrics
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 -    ğŸ¥ Clinical surgical evaluation
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 -    ğŸ”¬ Detailed metric debugging
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 -    ğŸ“Š Advanced visualizations
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 -    ğŸ“‹ Comprehensive reports
2025-06-10 10:11:33,625 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“‚ Loading CholecT50 data for evaluation...
2025-06-10 10:11:33,626 - INFO - Extended_SuRL_Eval_139984931075520 - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-10 10:11:34,033 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (78968, 156)
2025-06-10 10:11:34,033 - INFO - Extended_SuRL_Eval_139984931075520 - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-10 10:11:34,033 - INFO - Extended_SuRL_Eval_139984931075520 - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-10 10:11:34,035 - INFO - Extended_SuRL_Eval_139984931075520 - [Train] Found 1 videos in metadata file
2025-06-10 10:11:34,035 - INFO - Extended_SuRL_Eval_139984931075520 - [Train] Loading data for 1 videos
2025-06-10 10:11:34,116 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded video VID01: 1734 frames, 1024D embeddings
2025-06-10 10:11:34,116 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Successfully loaded 1 videos for train
2025-06-10 10:11:34,116 - INFO - Extended_SuRL_Eval_139984931075520 - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-10 10:11:34,217 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (21895, 156)
2025-06-10 10:11:34,217 - INFO - Extended_SuRL_Eval_139984931075520 - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-10 10:11:34,217 - INFO - Extended_SuRL_Eval_139984931075520 - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-10 10:11:34,218 - INFO - Extended_SuRL_Eval_139984931075520 - [Test] Found 5 videos in metadata file
2025-06-10 10:11:34,218 - INFO - Extended_SuRL_Eval_139984931075520 - [Test] Loading data for 5 videos
2025-06-10 10:11:34,333 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded video VID02: 2840 frames, 1024D embeddings
2025-06-10 10:11:34,420 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded video VID06: 2154 frames, 1024D embeddings
2025-06-10 10:11:34,506 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded video VID111: 2146 frames, 1024D embeddings
2025-06-10 10:11:34,576 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded video VID14: 1709 frames, 1024D embeddings
2025-06-10 10:11:34,645 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded video VID23: 1636 frames, 1024D embeddings
2025-06-10 10:11:34,646 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Successfully loaded 5 videos for test
2025-06-10 10:11:34,646 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Data loaded for evaluation
2025-06-10 10:11:34,646 - INFO - Extended_SuRL_Eval_139984931075520 -    Training videos: 1 (for context)
2025-06-10 10:11:34,646 - INFO - Extended_SuRL_Eval_139984931075520 -    Test videos: 5 (for evaluation)
2025-06-10 10:11:34,646 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“¦ Loading Pre-trained Models
2025-06-10 10:11:34,646 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“ Loading Method 1: Autoregressive IL
2025-06-10 10:11:34,646 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“¦ Loading AutoregressiveIL from: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/checkpoints/autoregressive_il_best_epoch_1.pt
2025-06-10 10:11:35,689 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Method 1 loaded successfully
2025-06-10 10:11:35,690 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸŒ Loading Method 2: Conditional World Model + RL
2025-06-10 10:11:35,690 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“¦ Loading ConditionalWorldModel from: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/checkpoints/world_model_best_epoch_2.pt
2025-06-10 10:11:36,012 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… World model loaded successfully
2025-06-10 10:11:36,496 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… PPO model loaded
2025-06-10 10:11:36,509 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… A2C model loaded
2025-06-10 10:11:36,510 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“¹ Loading Method 3: Direct Video RL
2025-06-10 10:11:36,523 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… PPO model loaded
2025-06-10 10:11:36,536 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… A2C model loaded
2025-06-10 10:11:36,536 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ”§ Creating test data loaders...
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Created test loaders for 5 videos
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“Š Running Standard Comprehensive Evaluation
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ¯ FIXED INTEGRATED EVALUATION
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 - ==================================================
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ”§ Fixed Issues:
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Eliminated ground truth future state leakage
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Proper world model usage for Method 2
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Fair single-step comparison as primary evaluation
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Method-specific planning analysis as secondary
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Respects each paradigm's training environment
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Fixed action shape mismatches in planning evaluation
2025-06-10 10:11:37,577 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Fixed world model trainer test loader handling
2025-06-10 10:11:37,578 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ”¬ Evaluation Framework initialized
2025-06-10 10:11:37,578 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“ Results will be saved to: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/eval_2025-06-10_10-11-33/integrated_evaluation
2025-06-10 10:11:38,279 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded AutoregressiveIL model
2025-06-10 10:11:38,730 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded ConditionalWorldModel (for planning analysis)
2025-06-10 10:11:38,752 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded ppo RL policy (trained with world model)
2025-06-10 10:11:38,771 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded a2c RL policy (trained with world model)
2025-06-10 10:11:38,794 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded ppo RL policy (trained on direct video)
2025-06-10 10:11:38,819 - INFO - Extended_SuRL_Eval_139984931075520 - âœ… Loaded a2c RL policy (trained on direct video)
2025-06-10 10:11:38,819 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“Š Loaded 5 models for comprehensive evaluation
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ¯ Evaluation approach:
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 -    Primary: Single-step action prediction (fair comparison)
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 -    Secondary: Multi-step planning analysis (paradigm-specific)
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“Š Loaded models for evaluation:
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 -    AutoregressiveIL: supervised_imitation_learning
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 -    WorldModelRL_ppo: rl_with_world_model_simulation
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 -    WorldModelRL_a2c: rl_with_world_model_simulation
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 -    DirectVideoRL_ppo: rl_with_direct_video_episodes
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 -    DirectVideoRL_a2c: rl_with_direct_video_episodes
2025-06-10 10:11:38,820 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸš€ Running evaluation on 5 videos...
2025-06-10 10:11:38,821 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸš€ Starting FIXED comprehensive evaluation (using proper batches)
2025-06-10 10:11:38,821 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“Š Models: 5, Videos: 5
2025-06-10 10:11:38,821 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ¯ Evaluation approach:
2025-06-10 10:11:38,821 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Uses DataLoader batches directly (like training)
2025-06-10 10:11:38,821 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Maintains temporal structure for IL model
2025-06-10 10:11:38,821 - INFO - Extended_SuRL_Eval_139984931075520 -    âœ… Consistent model interfaces
2025-06-10 10:12:36,509 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“¹ Evaluating video: VID02
2025-06-10 10:12:36,518 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“¹ Comprehensive evaluation: VID02
2025-06-10 10:12:36,518 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ¯ PRIMARY: Single-step action prediction
2025-06-10 10:12:36,518 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ¤– AutoregressiveIL: Single-step action prediction
2025-06-10 10:12:45,056 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Single-step mAP: 0.7112
2025-06-10 10:12:45,056 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ¤– WorldModelRL_ppo: Single-step action prediction
2025-06-10 10:21:51,412 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Single-step mAP: 0.6823
2025-06-10 10:21:51,412 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ¤– WorldModelRL_a2c: Single-step action prediction
2025-06-10 10:21:53,328 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Single-step mAP: 0.6788
2025-06-10 10:21:53,328 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ¤– DirectVideoRL_ppo: Single-step action prediction
2025-06-10 10:21:55,428 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Single-step mAP: 0.5965
2025-06-10 10:21:55,429 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ¤– DirectVideoRL_a2c: Single-step action prediction
2025-06-10 10:21:57,308 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Single-step mAP: 0.6772
2025-06-10 10:21:57,308 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸš€ SECONDARY: Planning capability analysis
2025-06-10 10:21:57,308 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ§  AutoregressiveIL: Planning capability analysis
2025-06-10 10:22:06,011 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Planning stability: 0.9978
2025-06-10 10:22:06,011 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ§  WorldModelRL_ppo: Planning capability analysis
2025-06-10 10:22:15,377 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Planning stability: 0.9999
2025-06-10 10:22:15,377 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ§  WorldModelRL_a2c: Planning capability analysis
2025-06-10 10:22:25,915 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Planning stability: 1.0000
2025-06-10 10:22:25,915 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ§  DirectVideoRL_ppo: Planning capability analysis
2025-06-10 10:22:28,712 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Planning stability: 0.9987
2025-06-10 10:22:28,713 - INFO - Extended_SuRL_Eval_139984931075520 -   ğŸ§  DirectVideoRL_a2c: Planning capability analysis
2025-06-10 10:22:31,726 - INFO - Extended_SuRL_Eval_139984931075520 -     ğŸ“Š Planning stability: 0.9991
2025-06-10 10:22:31,728 - INFO - Extended_SuRL_Eval_139984931075520 -   AutoregressiveIL: mAP = 0.7112 (proper batches)
2025-06-10 10:22:31,728 - INFO - Extended_SuRL_Eval_139984931075520 -   WorldModelRL_ppo: mAP = 0.6823 (proper batches)
2025-06-10 10:22:31,729 - INFO - Extended_SuRL_Eval_139984931075520 -   WorldModelRL_a2c: mAP = 0.6788 (proper batches)
2025-06-10 10:22:31,729 - INFO - Extended_SuRL_Eval_139984931075520 -   DirectVideoRL_ppo: mAP = 0.5965 (proper batches)
2025-06-10 10:22:31,729 - INFO - Extended_SuRL_Eval_139984931075520 -   DirectVideoRL_a2c: mAP = 0.6772 (proper batches)
2025-06-10 10:22:31,731 - INFO - Extended_SuRL_Eval_139984931075520 - ğŸ“¹ Evaluating video: VID06
