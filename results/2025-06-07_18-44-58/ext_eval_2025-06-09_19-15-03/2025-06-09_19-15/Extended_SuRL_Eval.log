2025-06-09 19:15:03,129 - INFO - Extended_SuRL_Eval_126387768290544 - Shared experiment log directory: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-15-03/2025-06-09_19-15
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - üè• Clinical evaluator initialized
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - üî¨ Enhanced Evaluation Experiment: ext_eval_2025-06-09_19-15-03
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - üìÅ Loading models from: /home/maxboels/projects/surl/results/2025-06-07_18-44-58
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - üìÅ Saving results to: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-15-03
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - üè• Clinical evaluation: ENABLED
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - üìä Metric debugging: ENABLED
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - üöÄ Starting ENHANCED EVALUATION with Clinical Analysis
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - ======================================================================
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - üéØ Features:
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Standard evaluation metrics
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 -    üè• Clinical surgical evaluation
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 -    üî¨ Detailed metric debugging
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 -    üìä Advanced visualizations
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 -    üìã Comprehensive reports
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - üìÇ Loading CholecT50 data for evaluation...
2025-06-09 19:15:03,130 - INFO - Extended_SuRL_Eval_126387768290544 - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-09 19:15:03,536 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (78968, 156)
2025-06-09 19:15:03,536 - INFO - Extended_SuRL_Eval_126387768290544 - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-09 19:15:03,536 - INFO - Extended_SuRL_Eval_126387768290544 - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-09 19:15:03,538 - INFO - Extended_SuRL_Eval_126387768290544 - [Train] Found 1 videos in metadata file
2025-06-09 19:15:03,538 - INFO - Extended_SuRL_Eval_126387768290544 - [Train] Loading data for 1 videos
2025-06-09 19:15:03,622 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded video VID01: 1734 frames, 1024D embeddings
2025-06-09 19:15:03,622 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Successfully loaded 1 videos for train
2025-06-09 19:15:03,622 - INFO - Extended_SuRL_Eval_126387768290544 - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-09 19:15:03,706 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded metadata: /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv - Shape: (21895, 156)
2025-06-09 19:15:03,706 - INFO - Extended_SuRL_Eval_126387768290544 - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-09 19:15:03,706 - INFO - Extended_SuRL_Eval_126387768290544 - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-09 19:15:03,707 - INFO - Extended_SuRL_Eval_126387768290544 - [Test] Found 5 videos in metadata file
2025-06-09 19:15:03,707 - INFO - Extended_SuRL_Eval_126387768290544 - [Test] Loading data for 5 videos
2025-06-09 19:15:03,820 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded video VID02: 2840 frames, 1024D embeddings
2025-06-09 19:15:03,904 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded video VID06: 2154 frames, 1024D embeddings
2025-06-09 19:15:03,989 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded video VID111: 2146 frames, 1024D embeddings
2025-06-09 19:15:04,063 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded video VID14: 1709 frames, 1024D embeddings
2025-06-09 19:15:04,130 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded video VID23: 1636 frames, 1024D embeddings
2025-06-09 19:15:04,130 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Successfully loaded 5 videos for test
2025-06-09 19:15:04,130 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Data loaded for evaluation
2025-06-09 19:15:04,130 - INFO - Extended_SuRL_Eval_126387768290544 -    Training videos: 1 (for context)
2025-06-09 19:15:04,130 - INFO - Extended_SuRL_Eval_126387768290544 -    Test videos: 5 (for evaluation)
2025-06-09 19:15:04,130 - INFO - Extended_SuRL_Eval_126387768290544 - üì¶ Loading Pre-trained Models
2025-06-09 19:15:04,130 - INFO - Extended_SuRL_Eval_126387768290544 - üéì Loading Method 1: Autoregressive IL
2025-06-09 19:15:04,131 - INFO - Extended_SuRL_Eval_126387768290544 - üì¶ Loading AutoregressiveIL from: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/checkpoints/autoregressive_il_best_epoch_1.pt
2025-06-09 19:15:04,666 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Method 1 loaded successfully
2025-06-09 19:15:04,666 - INFO - Extended_SuRL_Eval_126387768290544 - üåç Loading Method 2: Conditional World Model + RL
2025-06-09 19:15:04,666 - INFO - Extended_SuRL_Eval_126387768290544 - üì¶ Loading ConditionalWorldModel from: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/2025-06-07_18-44/checkpoints/world_model_best_epoch_2.pt
2025-06-09 19:15:04,932 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ World model loaded successfully
2025-06-09 19:15:05,291 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ PPO model loaded
2025-06-09 19:15:05,297 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ A2C model loaded
2025-06-09 19:15:05,297 - INFO - Extended_SuRL_Eval_126387768290544 - üìπ Loading Method 3: Direct Video RL
2025-06-09 19:15:05,303 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ PPO model loaded
2025-06-09 19:15:05,309 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ A2C model loaded
2025-06-09 19:15:05,309 - INFO - Extended_SuRL_Eval_126387768290544 - üîß Creating test data loaders...
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Created test loaders for 5 videos
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 - üìä Running Standard Comprehensive Evaluation
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 - üéØ FIXED INTEGRATED EVALUATION
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 - ==================================================
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 - üîß Fixed Issues:
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Eliminated ground truth future state leakage
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Proper world model usage for Method 2
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Fair single-step comparison as primary evaluation
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Method-specific planning analysis as secondary
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Respects each paradigm's training environment
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Fixed action shape mismatches in planning evaluation
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Fixed world model trainer test loader handling
2025-06-09 19:15:06,198 - INFO - Extended_SuRL_Eval_126387768290544 - üî¨ Evaluation Framework initialized
2025-06-09 19:15:06,199 - INFO - Extended_SuRL_Eval_126387768290544 - üìÅ Results will be saved to: /home/maxboels/projects/surl/results/2025-06-07_18-44-58/ext_eval_2025-06-09_19-15-03/integrated_evaluation
2025-06-09 19:15:06,633 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded AutoregressiveIL model
2025-06-09 19:15:06,910 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded ConditionalWorldModel (for planning analysis)
2025-06-09 19:15:06,923 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded ppo RL policy (trained with world model)
2025-06-09 19:15:06,933 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded a2c RL policy (trained with world model)
2025-06-09 19:15:06,945 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded ppo RL policy (trained on direct video)
2025-06-09 19:15:06,955 - INFO - Extended_SuRL_Eval_126387768290544 - ‚úÖ Loaded a2c RL policy (trained on direct video)
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üìä Loaded 5 models for comprehensive evaluation
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üéØ Evaluation approach:
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    Primary: Single-step action prediction (fair comparison)
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    Secondary: Multi-step planning analysis (paradigm-specific)
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üìä Loaded models for evaluation:
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    AutoregressiveIL: supervised_imitation_learning
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    WorldModelRL_ppo: rl_with_world_model_simulation
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    WorldModelRL_a2c: rl_with_world_model_simulation
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    DirectVideoRL_ppo: rl_with_direct_video_episodes
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    DirectVideoRL_a2c: rl_with_direct_video_episodes
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üöÄ Running evaluation on 5 videos...
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üöÄ Starting FIXED comprehensive evaluation (using proper batches)
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üìä Models: 5, Videos: 5
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üéØ Evaluation approach:
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Uses DataLoader batches directly (like training)
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Maintains temporal structure for IL model
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Consistent model interfaces
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üìπ Evaluating video: VID02
2025-06-09 19:15:06,956 - ERROR - Extended_SuRL_Eval_126387768290544 - ‚ùå Video VID02 evaluation failed: 'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üìπ Evaluating video: VID06
2025-06-09 19:15:06,956 - ERROR - Extended_SuRL_Eval_126387768290544 - ‚ùå Video VID06 evaluation failed: 'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üìπ Evaluating video: VID111
2025-06-09 19:15:06,956 - ERROR - Extended_SuRL_Eval_126387768290544 - ‚ùå Video VID111 evaluation failed: 'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üìπ Evaluating video: VID14
2025-06-09 19:15:06,956 - ERROR - Extended_SuRL_Eval_126387768290544 - ‚ùå Video VID14 evaluation failed: 'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'
2025-06-09 19:15:06,956 - INFO - Extended_SuRL_Eval_126387768290544 - üìπ Evaluating video: VID23
2025-06-09 19:15:06,956 - ERROR - Extended_SuRL_Eval_126387768290544 - ‚ùå Video VID23 evaluation failed: 'IntegratedEvaluationFramework' object has no attribute 'evaluate_single_video_comprehensive_fixed'
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - üìä Computing aggregate results...
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - üìà Performing statistical tests...
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - 
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - üéâ COMPREHENSIVE EVALUATION COMPLETED!
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - ============================================================
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - üéØ PRIMARY RESULTS: Single-step Action Prediction (Fair Comparison)
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - 
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - üöÄ SECONDARY RESULTS: Planning Capability Analysis
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - 
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - üîç KEY INSIGHTS:
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Fair single-step comparison shows paradigm performance
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Planning analysis reveals paradigm-specific strengths
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ No ground truth leakage or environment mismatches
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 -    ‚úÖ Each method evaluated according to its training paradigm
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - 
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 - ‚öñÔ∏è EVALUATION FAIRNESS:
2025-06-09 19:15:06,957 - INFO - Extended_SuRL_Eval_126387768290544 -    Primary task: single_step_action_prediction_with_proper_context
