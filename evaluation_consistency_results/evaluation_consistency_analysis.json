{
  "evaluation_comparison": {
    "training_data_evaluation": {
      "mAP": 0.11434463582647338,
      "avg_action_density": 0.5333333333333333,
      "avg_action_density_0.3": 5.366666666666666,
      "avg_expert_density": 1.4666666666666666,
      "samples": 60,
      "prediction_stats": {
        "mean": 0.07871561497449875,
        "std": 0.11308125406503677,
        "median": 0.0,
        "max": 0.6467517018318176
      }
    },
    "test_data_evaluation": {
      "mAP": 0.040291351781537144,
      "avg_action_density": 0.4666666666666667,
      "avg_action_density_0.3": 4.926666666666667,
      "avg_expert_density": 1.4966666666666666,
      "samples": 300,
      "prediction_stats": {
        "mean": 0.07557258009910583,
        "std": 0.10926978290081024,
        "median": 0.0,
        "max": 0.6803446412086487
      }
    },
    "performance_gap": {
      "mAP_difference": 0.07405328404493623,
      "mAP_ratio": 0.352367660190744,
      "density_difference": 0.06666666666666665
    },
    "diagnosis": [
      "Severe overfitting: Test performance <50% of training"
    ]
  },
  "calibration_analysis": {
    "total_predictions": 6000,
    "distribution": {
      "zeros": 3073.0,
      "near_zero": 3199.0,
      "low": 822.0,
      "medium": 1957.0,
      "high": 22.0
    },
    "statistics": {
      "mean": 0.07539553940296173,
      "std": 0.10846497863531113,
      "median": 0.0,
      "q95": 0.2954825386404992,
      "max": 0.6533247232437134
    },
    "calibration_issues": [
      "Model outputs too many zeros: 51.2%",
      "Model never confident: max prediction only 0.653"
    ]
  },
  "suggested_fixes": {
    "immediate_actions": [
      "Severe overfitting detected - reduce model complexity"
    ],
    "training_adjustments": [
      "Add stronger regularization (dropout, weight decay)",
      "Reduce training episodes/timesteps",
      "Use early stopping based on validation performance",
      "Increase exploration during training",
      "Use different activation functions (e.g., sigmoid instead of tanh)",
      "Scale rewards to encourage stronger signals"
    ],
    "evaluation_fixes": [
      "Use identical evaluation methodology for training and testing",
      "Ensure same data preprocessing and thresholding",
      "Cross-validate results on multiple data splits",
      "Compare against supervised baseline on same test set"
    ],
    "model_improvements": [
      "Retrain with different initialization",
      "Use behavioral cloning warm-start to improve calibration",
      "Adjust reward function to encourage more confident predictions"
    ]
  },
  "summary": {
    "training_vs_test_mAP_ratio": 0.352367660190744,
    "main_issues": [
      "Severe overfitting",
      "Model outputs too many zeros: 51.2%",
      "Model never confident: max prediction only 0.653"
    ],
    "priority_fixes": [
      "Severe overfitting detected - reduce model complexity"
    ]
  }
}