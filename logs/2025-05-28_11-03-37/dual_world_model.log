2025-05-28 11:03:37,823 - INFO - Log file: logs/2025-05-28_11-03-37/dual_world_model.log
2025-05-28 11:03:37,824 - INFO - Starting Dual World Model experiment
2025-05-28 11:03:37,824 - INFO - Using device: cuda
2025-05-28 11:03:37,824 - INFO - Loading CholecT50 data...
2025-05-28 11:03:37,824 - INFO - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-28 11:03:38,304 - INFO - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 11:03:38,305 - INFO - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 11:03:38,306 - INFO - [Train] Found 40 videos in metadata file
2025-05-28 11:03:38,306 - INFO - [Train] Loading data for 40 videos
2025-05-28 11:03:42,016 - INFO - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-28 11:03:42,122 - INFO - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 11:03:42,122 - INFO - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 11:03:42,123 - INFO - [Test] Found 10 videos in metadata file
2025-05-28 11:03:42,123 - INFO - [Test] Loading data for 10 videos
2025-05-28 11:03:54,649 - INFO - Max training videos: None
2025-05-28 11:03:54,649 - INFO - Max test videos: None
2025-05-28 11:03:54,649 - INFO - Training samples: 78928
2025-05-28 11:03:54,649 - INFO - Test videos: 10
2025-05-28 11:03:54,649 - INFO - Initializing Dual World Model...
2025-05-28 11:03:55,337 - INFO - Total parameters: 48,924,145
2025-05-28 11:03:55,337 - INFO - Trainable parameters: 48,924,145
2025-05-28 11:03:55,337 - INFO - Training mode: supervised
2025-05-28 11:03:55,337 - INFO - Starting supervised training...
2025-05-28 11:03:55,338 - INFO - Starting supervised training for autoregressive action prediction
2025-05-28 11:03:55,846 - INFO - Batch 0/4933 | Loss: 3.2461
2025-05-28 11:04:00,387 - INFO - Batch 100/4933 | Loss: 0.7943
2025-05-28 11:04:04,856 - INFO - Batch 200/4933 | Loss: 0.5642
2025-05-28 11:04:09,306 - INFO - Batch 300/4933 | Loss: 0.5762
2025-05-28 11:04:13,753 - INFO - Batch 400/4933 | Loss: 0.5567
2025-05-28 11:04:18,213 - INFO - Batch 500/4933 | Loss: 0.3995
2025-05-28 11:04:22,676 - INFO - Batch 600/4933 | Loss: 0.4802
2025-05-28 11:04:27,159 - INFO - Batch 700/4933 | Loss: 0.3833
2025-05-28 11:04:31,639 - INFO - Batch 800/4933 | Loss: 0.3593
2025-05-28 11:04:36,136 - INFO - Batch 900/4933 | Loss: 0.2978
2025-05-28 11:04:40,617 - INFO - Batch 1000/4933 | Loss: 0.3552
2025-05-28 11:04:45,110 - INFO - Batch 1100/4933 | Loss: 0.2385
2025-05-28 11:04:49,601 - INFO - Batch 1200/4933 | Loss: 0.3057
2025-05-28 11:04:54,095 - INFO - Batch 1300/4933 | Loss: 0.4328
2025-05-28 11:04:58,586 - INFO - Batch 1400/4933 | Loss: 0.2737
2025-05-28 11:05:03,076 - INFO - Batch 1500/4933 | Loss: 0.2298
2025-05-28 11:05:07,568 - INFO - Batch 1600/4933 | Loss: 0.2940
2025-05-28 11:05:12,060 - INFO - Batch 1700/4933 | Loss: 0.2207
2025-05-28 11:05:16,554 - INFO - Batch 1800/4933 | Loss: 0.2362
2025-05-28 11:05:21,056 - INFO - Batch 1900/4933 | Loss: 0.2218
2025-05-28 11:05:25,550 - INFO - Batch 2000/4933 | Loss: 0.2329
2025-05-28 11:05:30,040 - INFO - Batch 2100/4933 | Loss: 0.2417
2025-05-28 11:05:34,543 - INFO - Batch 2200/4933 | Loss: 0.3667
2025-05-28 11:05:39,041 - INFO - Batch 2300/4933 | Loss: 0.2412
2025-05-28 11:05:43,540 - INFO - Batch 2400/4933 | Loss: 0.2201
2025-05-28 11:05:48,042 - INFO - Batch 2500/4933 | Loss: 0.3489
2025-05-28 11:05:52,542 - INFO - Batch 2600/4933 | Loss: 0.2869
2025-05-28 11:05:57,044 - INFO - Batch 2700/4933 | Loss: 0.1865
2025-05-28 11:06:01,548 - INFO - Batch 2800/4933 | Loss: 0.2321
2025-05-28 11:06:06,046 - INFO - Batch 2900/4933 | Loss: 0.2015
2025-05-28 11:06:10,551 - INFO - Batch 3000/4933 | Loss: 0.2455
2025-05-28 11:06:15,043 - INFO - Batch 3100/4933 | Loss: 0.2645
2025-05-28 11:06:19,541 - INFO - Batch 3200/4933 | Loss: 0.2293
2025-05-28 11:06:24,049 - INFO - Batch 3300/4933 | Loss: 0.1950
2025-05-28 11:06:28,550 - INFO - Batch 3400/4933 | Loss: 0.2299
2025-05-28 11:06:33,050 - INFO - Batch 3500/4933 | Loss: 0.2040
2025-05-28 11:06:37,550 - INFO - Batch 3600/4933 | Loss: 0.2253
2025-05-28 11:06:42,055 - INFO - Batch 3700/4933 | Loss: 0.1997
2025-05-28 11:06:46,570 - INFO - Batch 3800/4933 | Loss: 0.1998
2025-05-28 11:06:51,075 - INFO - Batch 3900/4933 | Loss: 0.1764
2025-05-28 11:06:55,594 - INFO - Batch 4000/4933 | Loss: 0.2574
2025-05-28 11:07:00,107 - INFO - Batch 4100/4933 | Loss: 0.1574
2025-05-28 11:07:04,618 - INFO - Batch 4200/4933 | Loss: 0.2112
2025-05-28 11:07:09,123 - INFO - Batch 4300/4933 | Loss: 0.2047
2025-05-28 11:07:13,630 - INFO - Batch 4400/4933 | Loss: 0.1845
2025-05-28 11:07:18,132 - INFO - Batch 4500/4933 | Loss: 0.2006
2025-05-28 11:07:22,639 - INFO - Batch 4600/4933 | Loss: 0.2301
2025-05-28 11:07:27,155 - INFO - Batch 4700/4933 | Loss: 0.1673
2025-05-28 11:07:31,676 - INFO - Batch 4800/4933 | Loss: 0.1940
2025-05-28 11:07:36,192 - INFO - Batch 4900/4933 | Loss: 0.1673
2025-05-28 11:07:56,726 - INFO - New best model saved: logs/2025-05-28_11-03-37/checkpoints/supervised_best_epoch_1.pt
2025-05-28 11:07:56,726 - INFO - Epoch 1/2 | Train Loss: 0.3107 | Val Loss: 0.3652 | Val Action Acc: 0.9914
2025-05-28 11:07:56,969 - INFO - Batch 0/4933 | Loss: 0.2119
2025-05-28 11:08:01,462 - INFO - Batch 100/4933 | Loss: 0.1733
2025-05-28 11:08:05,978 - INFO - Batch 200/4933 | Loss: 0.2235
2025-05-28 11:08:10,487 - INFO - Batch 300/4933 | Loss: 0.1520
2025-05-28 11:08:14,994 - INFO - Batch 400/4933 | Loss: 0.1696
2025-05-28 11:08:19,526 - INFO - Batch 500/4933 | Loss: 0.1729
2025-05-28 11:08:24,046 - INFO - Batch 600/4933 | Loss: 0.2484
2025-05-28 11:08:28,565 - INFO - Batch 700/4933 | Loss: 0.1878
2025-05-28 11:08:33,080 - INFO - Batch 800/4933 | Loss: 0.1614
2025-05-28 11:08:37,588 - INFO - Batch 900/4933 | Loss: 0.1493
2025-05-28 11:08:42,097 - INFO - Batch 1000/4933 | Loss: 0.1902
2025-05-28 11:08:46,634 - INFO - Batch 1100/4933 | Loss: 0.1548
2025-05-28 11:08:51,151 - INFO - Batch 1200/4933 | Loss: 0.1484
2025-05-28 11:08:55,670 - INFO - Batch 1300/4933 | Loss: 0.1638
2025-05-28 11:09:00,172 - INFO - Batch 1400/4933 | Loss: 0.2243
2025-05-28 11:09:04,674 - INFO - Batch 1500/4933 | Loss: 0.1842
2025-05-28 11:09:09,174 - INFO - Batch 1600/4933 | Loss: 0.1752
2025-05-28 11:09:13,664 - INFO - Batch 1700/4933 | Loss: 0.1684
2025-05-28 11:09:18,161 - INFO - Batch 1800/4933 | Loss: 0.2137
2025-05-28 11:09:22,653 - INFO - Batch 1900/4933 | Loss: 0.1634
2025-05-28 11:09:27,156 - INFO - Batch 2000/4933 | Loss: 0.1483
2025-05-28 11:09:31,661 - INFO - Batch 2100/4933 | Loss: 0.1866
2025-05-28 11:09:36,147 - INFO - Batch 2200/4933 | Loss: 0.2052
2025-05-28 11:09:40,633 - INFO - Batch 2300/4933 | Loss: 0.1353
2025-05-28 11:09:45,137 - INFO - Batch 2400/4933 | Loss: 0.1374
2025-05-28 11:09:49,624 - INFO - Batch 2500/4933 | Loss: 0.1722
2025-05-28 11:09:54,120 - INFO - Batch 2600/4933 | Loss: 0.1504
2025-05-28 11:09:58,610 - INFO - Batch 2700/4933 | Loss: 0.1430
2025-05-28 11:10:03,133 - INFO - Batch 2800/4933 | Loss: 0.1386
2025-05-28 11:10:07,621 - INFO - Batch 2900/4933 | Loss: 0.1634
2025-05-28 11:10:12,112 - INFO - Batch 3000/4933 | Loss: 0.1640
2025-05-28 11:10:16,610 - INFO - Batch 3100/4933 | Loss: 0.1362
2025-05-28 11:10:21,110 - INFO - Batch 3200/4933 | Loss: 0.1325
2025-05-28 11:10:25,615 - INFO - Batch 3300/4933 | Loss: 0.1456
2025-05-28 11:10:30,103 - INFO - Batch 3400/4933 | Loss: 0.1533
2025-05-28 11:10:34,596 - INFO - Batch 3500/4933 | Loss: 0.1336
2025-05-28 11:10:39,080 - INFO - Batch 3600/4933 | Loss: 0.1917
2025-05-28 11:10:43,569 - INFO - Batch 3700/4933 | Loss: 0.1462
2025-05-28 11:10:48,063 - INFO - Batch 3800/4933 | Loss: 0.2806
2025-05-28 11:10:52,566 - INFO - Batch 3900/4933 | Loss: 0.2439
2025-05-28 11:10:57,073 - INFO - Batch 4000/4933 | Loss: 0.2119
2025-05-28 11:11:01,575 - INFO - Batch 4100/4933 | Loss: 0.1940
2025-05-28 11:11:06,078 - INFO - Batch 4200/4933 | Loss: 0.1547
2025-05-28 11:11:10,579 - INFO - Batch 4300/4933 | Loss: 0.1326
2025-05-28 11:11:15,082 - INFO - Batch 4400/4933 | Loss: 0.1594
2025-05-28 11:11:19,578 - INFO - Batch 4500/4933 | Loss: 0.1310
2025-05-28 11:11:24,086 - INFO - Batch 4600/4933 | Loss: 0.1553
2025-05-28 11:11:28,603 - INFO - Batch 4700/4933 | Loss: 0.1935
2025-05-28 11:11:33,107 - INFO - Batch 4800/4933 | Loss: 0.1951
2025-05-28 11:11:37,625 - INFO - Batch 4900/4933 | Loss: 0.1252
2025-05-28 11:11:57,757 - INFO - Epoch 2/2 | Train Loss: 0.1800 | Val Loss: 0.3672 | Val Action Acc: 0.9919
2025-05-28 11:11:58,294 - INFO - Training plots saved to logs/2025-05-28_11-03-37
2025-05-28 11:11:58,411 - INFO - Training completed. Best model: logs/2025-05-28_11-03-37/checkpoints/supervised_best_epoch_1.pt
2025-05-28 11:11:58,411 - INFO - Final model: logs/2025-05-28_11-03-37/checkpoints/final_model.pt
2025-05-28 11:11:58,411 - INFO - Supervised training completed. Model saved: logs/2025-05-28_11-03-37/checkpoints/supervised_best_epoch_1.pt
2025-05-28 11:11:58,411 - INFO - Starting model evaluation...
2025-05-28 11:11:58,411 - INFO - Evaluating supervised-trained model
2025-05-28 11:11:59,089 - INFO - Starting comprehensive evaluation of both modes
2025-05-28 11:11:59,090 - INFO - Starting supervised mode evaluation (autoregressive action prediction)
2025-05-28 11:11:59,090 - INFO - Evaluating 10 videos with horizons [1, 3, 5, 10, 15] and top-k [1, 3, 5, 10]
2025-05-28 11:11:59,090 - INFO - Evaluating video: VID02 (1/10)
2025-05-28 11:13:14,093 - INFO - Evaluating video: VID06 (2/10)
2025-05-28 11:14:10,920 - INFO - Evaluating video: VID111 (3/10)
2025-05-28 11:15:04,993 - INFO - Evaluating video: VID14 (4/10)
2025-05-28 11:15:49,908 - INFO - Evaluating video: VID23 (5/10)
2025-05-28 11:16:34,472 - INFO - Evaluating video: VID25 (6/10)
2025-05-28 11:17:31,884 - INFO - Evaluating video: VID50 (7/10)
2025-05-28 11:18:00,940 - INFO - Evaluating video: VID51 (8/10)
2025-05-28 11:19:18,312 - INFO - Evaluating video: VID66 (9/10)
2025-05-28 11:20:06,898 - INFO - Evaluating video: VID79 (10/10)
2025-05-28 11:21:38,262 - INFO - Supervised evaluation completed. Processed 21885 samples from 10 videos.
2025-05-28 11:21:38,263 - INFO - Starting RL mode evaluation (state and reward prediction)
2025-05-28 11:21:38,264 - INFO - Evaluating RL mode on video: VID02
2025-05-28 11:21:40,858 - INFO - Evaluating RL mode on video: VID06
2025-05-28 11:21:42,810 - INFO - Evaluating RL mode on video: VID111
2025-05-28 11:21:44,783 - INFO - Evaluating RL mode on video: VID14
2025-05-28 11:21:46,420 - INFO - Evaluating RL mode on video: VID23
2025-05-28 11:21:47,981 - INFO - Evaluating RL mode on video: VID25
2025-05-28 11:21:49,963 - INFO - Evaluating RL mode on video: VID50
2025-05-28 11:21:51,095 - INFO - Evaluating RL mode on video: VID51
2025-05-28 11:21:53,704 - INFO - Evaluating RL mode on video: VID66
2025-05-28 11:21:55,460 - INFO - Evaluating RL mode on video: VID79
2025-05-28 11:21:58,427 - INFO - RL evaluation completed. Processed 21885 samples from 10 videos.
2025-05-28 11:21:59,067 - INFO - Supervised evaluation results saved to logs/2025-05-28_11-03-37/evaluation_results
2025-05-28 11:21:59,282 - INFO - RL evaluation results saved to logs/2025-05-28_11-03-37/evaluation_results
2025-05-28 11:21:59,494 - INFO - Comparison visualizations saved to logs/2025-05-28_11-03-37/evaluation_results
2025-05-28 11:21:59,495 - INFO - Comprehensive evaluation completed
2025-05-28 11:21:59,495 - INFO - Evaluation completed successfully
2025-05-28 11:21:59,495 - INFO - Action prediction accuracy: 0.3977
2025-05-28 11:21:59,495 - INFO - State prediction MSE: 0.1678
2025-05-28 11:21:59,495 - INFO - RL state prediction MSE: 0.1639
2025-05-28 11:21:59,495 - INFO - Generating summary report...
2025-05-28 11:21:59,495 - INFO - === EXPERIMENT SUMMARY ===
2025-05-28 11:21:59,495 - INFO - ✓ Supervised training completed successfully
2025-05-28 11:21:59,495 - INFO - ⚠ Low action prediction performance, check data quality and model architecture
2025-05-28 11:21:59,495 - INFO - → Rl mode performs better for state prediction
2025-05-28 11:21:59,496 - INFO - Experiment completed! Summary saved to: logs/2025-05-28_11-03-37/experiment_summary.json
