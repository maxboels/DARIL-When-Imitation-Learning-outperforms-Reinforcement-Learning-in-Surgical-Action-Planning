2025-03-11 19:25:14,525 - INFO - Log file: logs/2025-03-11_19-25-14/loggings.log
2025-03-11 19:25:14,525 - INFO - Starting CholecT50 experiment for Surgical Actions Prediction
2025-03-11 19:25:14,525 - INFO - Experiment configuration: {'max_videos': 1, 'pretrain_next_frame': {'train': True, 'inference': True}, 'pretrain_reward_model': False, 'calculate_action_rewards': False, 'train_action_policy': False, 'run_tdmpc': False, 'analyze_results': False, 'run_evaluation': False}
2025-03-11 19:25:14,526 - INFO - Using device: cuda
2025-03-11 19:25:14,526 - INFO - Loading CholecT50 data...
2025-03-11 19:25:22,044 - INFO - Best model path: best_model_epoch1_valloss1.190734.pt
2025-03-11 19:25:22,228 - INFO - Loaded best model from best_model_epoch1_valloss1.190734.pt
2025-03-11 19:25:22,228 - INFO - Skip training and start validation
2025-03-11 19:25:22,228 - INFO - Epoch 1/1 Validation
2025-03-11 19:25:22,228 - INFO - Starting validation
2025-03-11 19:25:22,404 - INFO - Epoch 1/1, Batch 0/178, Loss: 17.0696
2025-03-11 19:35:47,719 - INFO - Epoch 1/1, Batch 40/178, Loss: 18.8383
2025-03-11 19:36:24,335 - INFO - Epoch 1/1, Batch 80/178, Loss: 19.3656
2025-03-11 19:36:59,889 - INFO - Epoch 1/1, Batch 120/178, Loss: 21.6542
2025-03-11 19:37:38,662 - INFO - Epoch 1/1, Batch 160/178, Loss: 18.8364
2025-03-11 19:37:57,348 - INFO - Epoch 1/1, Val Loss: 1.1950
2025-03-11 19:42:19,386 - INFO - 
Comprehensive Evaluation Results:
2025-03-11 19:42:19,386 - INFO - 
--- Prediction Horizon: 1 ---
2025-03-11 19:42:19,386 - INFO - mAP: 1.0000
2025-03-11 19:42:19,386 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,387 - INFO - Metric               Value     
2025-03-11 19:42:19,387 - INFO - ------------------------------
2025-03-11 19:42:19,387 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,387 - INFO - Metric               Value     
2025-03-11 19:42:19,387 - INFO - ------------------------------
2025-03-11 19:42:19,387 - INFO - top_1_any_match      1.0000
2025-03-11 19:42:19,387 - INFO - top_3_any_match      1.0000
2025-03-11 19:42:19,387 - INFO - top_5_any_match      1.0000
2025-03-11 19:42:19,387 - INFO - top_10_any_match     1.0000
2025-03-11 19:42:19,387 - INFO - top_1_exact_match    1.0000
2025-03-11 19:42:19,387 - INFO - top_3_exact_match    1.0000
2025-03-11 19:42:19,387 - INFO - top_5_exact_match    1.0000
2025-03-11 19:42:19,387 - INFO - top_10_exact_match   1.0000
2025-03-11 19:42:19,387 - INFO - 
Recall Metrics:
2025-03-11 19:42:19,387 - INFO - Metric               Value     
2025-03-11 19:42:19,387 - INFO - ------------------------------
2025-03-11 19:42:19,387 - INFO - top_1_recall         1.0000
2025-03-11 19:42:19,387 - INFO - top_3_recall         1.0000
2025-03-11 19:42:19,387 - INFO - top_5_recall         1.0000
2025-03-11 19:42:19,387 - INFO - top_10_recall        1.0000
2025-03-11 19:42:19,387 - INFO - 
Precision Metrics:
2025-03-11 19:42:19,387 - INFO - Metric               Value     
2025-03-11 19:42:19,388 - INFO - ------------------------------
2025-03-11 19:42:19,388 - INFO - top_1_precision      1.0000
2025-03-11 19:42:19,388 - INFO - top_3_precision      0.3333
2025-03-11 19:42:19,388 - INFO - top_5_precision      0.2000
2025-03-11 19:42:19,388 - INFO - top_10_precision     0.1000
2025-03-11 19:42:19,388 - INFO - 
F1-Score Metrics:
2025-03-11 19:42:19,388 - INFO - Metric               Value     
2025-03-11 19:42:19,388 - INFO - ------------------------------
2025-03-11 19:42:19,388 - INFO - top_1_f1             1.0000
2025-03-11 19:42:19,388 - INFO - top_3_f1             0.5000
2025-03-11 19:42:19,388 - INFO - top_5_f1             0.3333
2025-03-11 19:42:19,388 - INFO - top_10_f1            0.1818
2025-03-11 19:42:19,388 - INFO - 
--- Prediction Horizon: 3 ---
2025-03-11 19:42:19,388 - INFO - mAP: 1.0000
2025-03-11 19:42:19,388 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,388 - INFO - Metric               Value     
2025-03-11 19:42:19,388 - INFO - ------------------------------
2025-03-11 19:42:19,388 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,388 - INFO - Metric               Value     
2025-03-11 19:42:19,388 - INFO - ------------------------------
2025-03-11 19:42:19,388 - INFO - top_1_any_match      1.0000
2025-03-11 19:42:19,388 - INFO - top_3_any_match      1.0000
2025-03-11 19:42:19,388 - INFO - top_5_any_match      1.0000
2025-03-11 19:42:19,389 - INFO - top_10_any_match     1.0000
2025-03-11 19:42:19,389 - INFO - top_1_exact_match    1.0000
2025-03-11 19:42:19,389 - INFO - top_3_exact_match    1.0000
2025-03-11 19:42:19,389 - INFO - top_5_exact_match    1.0000
2025-03-11 19:42:19,389 - INFO - top_10_exact_match   1.0000
2025-03-11 19:42:19,389 - INFO - 
Recall Metrics:
2025-03-11 19:42:19,389 - INFO - Metric               Value     
2025-03-11 19:42:19,389 - INFO - ------------------------------
2025-03-11 19:42:19,389 - INFO - top_1_recall         1.0000
2025-03-11 19:42:19,389 - INFO - top_3_recall         1.0000
2025-03-11 19:42:19,389 - INFO - top_5_recall         1.0000
2025-03-11 19:42:19,389 - INFO - top_10_recall        1.0000
2025-03-11 19:42:19,389 - INFO - 
Precision Metrics:
2025-03-11 19:42:19,389 - INFO - Metric               Value     
2025-03-11 19:42:19,389 - INFO - ------------------------------
2025-03-11 19:42:19,389 - INFO - top_1_precision      1.0000
2025-03-11 19:42:19,389 - INFO - top_3_precision      0.3333
2025-03-11 19:42:19,389 - INFO - top_5_precision      0.2000
2025-03-11 19:42:19,389 - INFO - top_10_precision     0.1000
2025-03-11 19:42:19,389 - INFO - 
F1-Score Metrics:
2025-03-11 19:42:19,389 - INFO - Metric               Value     
2025-03-11 19:42:19,389 - INFO - ------------------------------
2025-03-11 19:42:19,389 - INFO - top_1_f1             1.0000
2025-03-11 19:42:19,389 - INFO - top_3_f1             0.5000
2025-03-11 19:42:19,390 - INFO - top_5_f1             0.3333
2025-03-11 19:42:19,390 - INFO - top_10_f1            0.1818
2025-03-11 19:42:19,390 - INFO - 
--- Prediction Horizon: 5 ---
2025-03-11 19:42:19,390 - INFO - mAP: 1.0000
2025-03-11 19:42:19,390 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,390 - INFO - Metric               Value     
2025-03-11 19:42:19,390 - INFO - ------------------------------
2025-03-11 19:42:19,390 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,390 - INFO - Metric               Value     
2025-03-11 19:42:19,390 - INFO - ------------------------------
2025-03-11 19:42:19,390 - INFO - top_1_any_match      1.0000
2025-03-11 19:42:19,390 - INFO - top_3_any_match      1.0000
2025-03-11 19:42:19,390 - INFO - top_5_any_match      1.0000
2025-03-11 19:42:19,390 - INFO - top_10_any_match     1.0000
2025-03-11 19:42:19,390 - INFO - top_1_exact_match    1.0000
2025-03-11 19:42:19,390 - INFO - top_3_exact_match    1.0000
2025-03-11 19:42:19,390 - INFO - top_5_exact_match    1.0000
2025-03-11 19:42:19,390 - INFO - top_10_exact_match   1.0000
2025-03-11 19:42:19,390 - INFO - 
Recall Metrics:
2025-03-11 19:42:19,390 - INFO - Metric               Value     
2025-03-11 19:42:19,390 - INFO - ------------------------------
2025-03-11 19:42:19,390 - INFO - top_1_recall         1.0000
2025-03-11 19:42:19,390 - INFO - top_3_recall         1.0000
2025-03-11 19:42:19,390 - INFO - top_5_recall         1.0000
2025-03-11 19:42:19,390 - INFO - top_10_recall        1.0000
2025-03-11 19:42:19,391 - INFO - 
Precision Metrics:
2025-03-11 19:42:19,391 - INFO - Metric               Value     
2025-03-11 19:42:19,391 - INFO - ------------------------------
2025-03-11 19:42:19,391 - INFO - top_1_precision      1.0000
2025-03-11 19:42:19,391 - INFO - top_3_precision      0.3333
2025-03-11 19:42:19,391 - INFO - top_5_precision      0.2000
2025-03-11 19:42:19,391 - INFO - top_10_precision     0.1000
2025-03-11 19:42:19,391 - INFO - 
F1-Score Metrics:
2025-03-11 19:42:19,391 - INFO - Metric               Value     
2025-03-11 19:42:19,391 - INFO - ------------------------------
2025-03-11 19:42:19,391 - INFO - top_1_f1             1.0000
2025-03-11 19:42:19,391 - INFO - top_3_f1             0.5000
2025-03-11 19:42:19,391 - INFO - top_5_f1             0.3333
2025-03-11 19:42:19,391 - INFO - top_10_f1            0.1818
2025-03-11 19:42:19,391 - INFO - 
--- Prediction Horizon: 10 ---
2025-03-11 19:42:19,391 - INFO - mAP: 1.0000
2025-03-11 19:42:19,391 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,391 - INFO - Metric               Value     
2025-03-11 19:42:19,391 - INFO - ------------------------------
2025-03-11 19:42:19,391 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,391 - INFO - Metric               Value     
2025-03-11 19:42:19,391 - INFO - ------------------------------
2025-03-11 19:42:19,391 - INFO - top_1_any_match      1.0000
2025-03-11 19:42:19,391 - INFO - top_3_any_match      1.0000
2025-03-11 19:42:19,391 - INFO - top_5_any_match      1.0000
2025-03-11 19:42:19,391 - INFO - top_10_any_match     1.0000
2025-03-11 19:42:19,392 - INFO - top_1_exact_match    1.0000
2025-03-11 19:42:19,392 - INFO - top_3_exact_match    1.0000
2025-03-11 19:42:19,392 - INFO - top_5_exact_match    1.0000
2025-03-11 19:42:19,392 - INFO - top_10_exact_match   1.0000
2025-03-11 19:42:19,392 - INFO - 
Recall Metrics:
2025-03-11 19:42:19,392 - INFO - Metric               Value     
2025-03-11 19:42:19,392 - INFO - ------------------------------
2025-03-11 19:42:19,392 - INFO - top_1_recall         1.0000
2025-03-11 19:42:19,392 - INFO - top_3_recall         1.0000
2025-03-11 19:42:19,392 - INFO - top_5_recall         1.0000
2025-03-11 19:42:19,392 - INFO - top_10_recall        1.0000
2025-03-11 19:42:19,392 - INFO - 
Precision Metrics:
2025-03-11 19:42:19,392 - INFO - Metric               Value     
2025-03-11 19:42:19,392 - INFO - ------------------------------
2025-03-11 19:42:19,392 - INFO - top_1_precision      1.0000
2025-03-11 19:42:19,392 - INFO - top_3_precision      0.3333
2025-03-11 19:42:19,392 - INFO - top_5_precision      0.2000
2025-03-11 19:42:19,392 - INFO - top_10_precision     0.1000
2025-03-11 19:42:19,392 - INFO - 
F1-Score Metrics:
2025-03-11 19:42:19,392 - INFO - Metric               Value     
2025-03-11 19:42:19,392 - INFO - ------------------------------
2025-03-11 19:42:19,392 - INFO - top_1_f1             1.0000
2025-03-11 19:42:19,392 - INFO - top_3_f1             0.5000
2025-03-11 19:42:19,393 - INFO - top_5_f1             0.3333
2025-03-11 19:42:19,393 - INFO - top_10_f1            0.1818
2025-03-11 19:42:19,393 - INFO - 
--- Prediction Horizon: 15 ---
2025-03-11 19:42:19,393 - INFO - mAP: 1.0000
2025-03-11 19:42:19,393 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,393 - INFO - Metric               Value     
2025-03-11 19:42:19,393 - INFO - ------------------------------
2025-03-11 19:42:19,393 - INFO - 
Accuracy Metrics:
2025-03-11 19:42:19,393 - INFO - Metric               Value     
2025-03-11 19:42:19,393 - INFO - ------------------------------
2025-03-11 19:42:19,393 - INFO - top_1_any_match      1.0000
2025-03-11 19:42:19,393 - INFO - top_3_any_match      1.0000
2025-03-11 19:42:19,393 - INFO - top_5_any_match      1.0000
2025-03-11 19:42:19,393 - INFO - top_10_any_match     1.0000
2025-03-11 19:42:19,393 - INFO - top_1_exact_match    1.0000
2025-03-11 19:42:19,393 - INFO - top_3_exact_match    1.0000
2025-03-11 19:42:19,393 - INFO - top_5_exact_match    1.0000
2025-03-11 19:42:19,393 - INFO - top_10_exact_match   1.0000
2025-03-11 19:42:19,393 - INFO - 
Recall Metrics:
2025-03-11 19:42:19,393 - INFO - Metric               Value     
2025-03-11 19:42:19,393 - INFO - ------------------------------
2025-03-11 19:42:19,393 - INFO - top_1_recall         1.0000
2025-03-11 19:42:19,393 - INFO - top_3_recall         1.0000
2025-03-11 19:42:19,393 - INFO - top_5_recall         1.0000
2025-03-11 19:42:19,393 - INFO - top_10_recall        1.0000
2025-03-11 19:42:19,394 - INFO - 
Precision Metrics:
2025-03-11 19:42:19,394 - INFO - Metric               Value     
2025-03-11 19:42:19,394 - INFO - ------------------------------
2025-03-11 19:42:19,394 - INFO - top_1_precision      1.0000
2025-03-11 19:42:19,394 - INFO - top_3_precision      0.3333
2025-03-11 19:42:19,394 - INFO - top_5_precision      0.2000
2025-03-11 19:42:19,394 - INFO - top_10_precision     0.1000
2025-03-11 19:42:19,394 - INFO - 
F1-Score Metrics:
2025-03-11 19:42:19,394 - INFO - Metric               Value     
2025-03-11 19:42:19,394 - INFO - ------------------------------
2025-03-11 19:42:19,394 - INFO - top_1_f1             1.0000
2025-03-11 19:42:19,394 - INFO - top_3_f1             0.5000
2025-03-11 19:42:19,394 - INFO - top_5_f1             0.3333
2025-03-11 19:42:19,394 - INFO - top_10_f1            0.1818
2025-03-11 19:42:20,506 - INFO - 
Action Prediction Accuracy:
2025-03-11 19:42:20,506 - INFO - --------------------------------------------------
2025-03-11 19:42:20,506 - INFO - Horizon    Top-k      Accuracy  
2025-03-11 19:42:20,506 - INFO - --------------------------------------------------
2025-03-11 19:42:20,506 - INFO - 1          mAP             1.0000
2025-03-11 19:42:20,506 - INFO - 3          mAP             1.0000
2025-03-11 19:42:20,506 - INFO - 5          mAP             1.0000
2025-03-11 19:42:20,507 - INFO - 10         mAP             1.0000
2025-03-11 19:42:20,507 - INFO - 15         mAP             1.0000
