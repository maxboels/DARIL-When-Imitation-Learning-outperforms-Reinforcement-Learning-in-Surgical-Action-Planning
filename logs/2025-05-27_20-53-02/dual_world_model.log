2025-05-27 20:53:02,977 - INFO - Log file: logs/2025-05-27_20-53-02/dual_world_model.log
2025-05-27 20:53:02,977 - INFO - Starting Dual World Model experiment
2025-05-27 20:53:02,977 - INFO - Using device: cuda
2025-05-27 20:53:02,977 - INFO - Loading CholecT50 data...
2025-05-27 20:53:02,977 - INFO - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-27 20:53:03,426 - INFO - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 20:53:06,826 - INFO - [Train] Added phase completion rewards to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet.csv
2025-05-27 20:53:09,532 - INFO - [Train] Added phase transition rewards to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit.csv
2025-05-27 20:57:04,739 - INFO - [Train] Added phase and global progression rewards to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit_prog.csv
2025-05-27 20:57:17,591 - INFO - [Train] Added action distribution rewards to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit_prog_prob_action.csv
2025-05-27 20:57:21,776 - INFO - [Train] Added risk scores to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit_prog_prob_action_risk.csv
2025-05-27 20:57:24,757 - INFO - [Train] Added global outcome scores to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 20:57:24,759 - INFO - [Train] Found 5 videos in metadata file
2025-05-27 20:57:24,759 - INFO - [Train] Loading data for 5 videos
2025-05-27 20:57:25,693 - INFO - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-27 20:57:25,770 - INFO - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 20:57:26,343 - INFO - [Test] Added phase completion rewards to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet.csv
2025-05-27 20:57:26,767 - INFO - [Test] Added phase transition rewards to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit.csv
2025-05-27 20:57:56,194 - INFO - [Test] Added phase and global progression rewards to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit_prog.csv
2025-05-27 20:57:59,427 - INFO - [Test] Added action distribution rewards to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit_prog_prob_action.csv
2025-05-27 20:58:00,171 - INFO - [Test] Added risk scores to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit_prog_prob_action_risk.csv
2025-05-27 20:58:00,574 - INFO - [Test] Added global outcome scores to embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 20:58:00,575 - INFO - [Test] Found 5 videos in metadata file
2025-05-27 20:58:00,575 - INFO - [Test] Loading data for 5 videos
2025-05-27 20:58:03,369 - INFO - Training samples: 8867
2025-05-27 20:58:03,369 - INFO - Test videos: 5
2025-05-27 20:58:03,369 - INFO - Initializing Dual World Model...
2025-05-27 20:58:03,969 - INFO - Total parameters: 48,924,145
2025-05-27 20:58:03,969 - INFO - Trainable parameters: 48,924,145
2025-05-27 20:58:03,970 - INFO - Training mode: supervised
2025-05-27 20:58:03,970 - INFO - Starting supervised training...
2025-05-27 20:58:03,971 - INFO - Starting supervised training for autoregressive action prediction
2025-05-27 20:58:04,398 - INFO - Batch 0/555 | Loss: 3.1361
2025-05-27 20:58:06,599 - INFO - Batch 50/555 | Loss: 1.1112
2025-05-27 20:58:08,813 - INFO - Batch 100/555 | Loss: 0.7747
2025-05-27 20:58:11,035 - INFO - Batch 150/555 | Loss: 0.6640
2025-05-27 20:58:13,254 - INFO - Batch 200/555 | Loss: 0.5219
2025-05-27 20:58:15,481 - INFO - Batch 250/555 | Loss: 0.3707
2025-05-27 20:58:17,700 - INFO - Batch 300/555 | Loss: 0.4053
2025-05-27 20:58:19,924 - INFO - Batch 350/555 | Loss: 0.4387
2025-05-27 20:58:22,144 - INFO - Batch 400/555 | Loss: 0.3493
2025-05-27 20:58:24,368 - INFO - Batch 450/555 | Loss: 0.3162
2025-05-27 20:58:26,593 - INFO - Batch 500/555 | Loss: 0.3618
2025-05-27 20:58:28,816 - INFO - Batch 550/555 | Loss: 0.3126
2025-05-27 20:58:37,263 - INFO - New best model saved: logs/2025-05-27_20-53-02/checkpoints/supervised_best_epoch_1.pt
2025-05-27 20:58:37,263 - INFO - Epoch 1/10 | Train Loss: 0.5723 | Val Loss: 0.6508 | Val Action Acc: 0.9901
2025-05-27 20:58:37,422 - INFO - Batch 0/555 | Loss: 0.2286
2025-05-27 20:58:39,661 - INFO - Batch 50/555 | Loss: 0.2761
2025-05-27 20:58:41,903 - INFO - Batch 100/555 | Loss: 0.2676
2025-05-27 20:58:44,141 - INFO - Batch 150/555 | Loss: 0.2483
2025-05-27 20:58:46,380 - INFO - Batch 200/555 | Loss: 0.2137
2025-05-27 20:58:48,628 - INFO - Batch 250/555 | Loss: 0.2286
2025-05-27 20:58:50,875 - INFO - Batch 300/555 | Loss: 0.2335
2025-05-27 20:58:53,119 - INFO - Batch 350/555 | Loss: 0.2357
2025-05-27 20:58:55,363 - INFO - Batch 400/555 | Loss: 0.2206
2025-05-27 20:58:57,613 - INFO - Batch 450/555 | Loss: 0.1884
2025-05-27 20:58:59,865 - INFO - Batch 500/555 | Loss: 0.1770
2025-05-27 20:59:02,112 - INFO - Batch 550/555 | Loss: 0.2818
2025-05-27 20:59:10,688 - INFO - Epoch 2/10 | Train Loss: 0.2481 | Val Loss: 0.7488 | Val Action Acc: 0.9901
2025-05-27 20:59:10,863 - INFO - Batch 0/555 | Loss: 0.2178
2025-05-27 20:59:13,112 - INFO - Batch 50/555 | Loss: 0.2207
2025-05-27 20:59:15,372 - INFO - Batch 100/555 | Loss: 0.2344
2025-05-27 20:59:17,631 - INFO - Batch 150/555 | Loss: 0.1731
2025-05-27 20:59:19,885 - INFO - Batch 200/555 | Loss: 0.1750
2025-05-27 20:59:22,137 - INFO - Batch 250/555 | Loss: 0.2143
2025-05-27 20:59:24,385 - INFO - Batch 300/555 | Loss: 0.2369
2025-05-27 20:59:26,642 - INFO - Batch 350/555 | Loss: 0.1911
2025-05-27 20:59:28,906 - INFO - Batch 400/555 | Loss: 0.1810
2025-05-27 20:59:31,156 - INFO - Batch 450/555 | Loss: 0.1675
2025-05-27 20:59:33,409 - INFO - Batch 500/555 | Loss: 0.1675
2025-05-27 20:59:35,678 - INFO - Batch 550/555 | Loss: 0.1531
2025-05-27 20:59:45,591 - INFO - Epoch 3/10 | Train Loss: 0.1962 | Val Loss: 0.8111 | Val Action Acc: 0.9903
2025-05-27 20:59:45,794 - INFO - Batch 0/555 | Loss: 0.2099
2025-05-27 20:59:48,072 - INFO - Batch 50/555 | Loss: 0.2131
2025-05-27 20:59:50,332 - INFO - Batch 100/555 | Loss: 0.1726
2025-05-27 20:59:52,585 - INFO - Batch 150/555 | Loss: 0.1592
2025-05-27 20:59:54,837 - INFO - Batch 200/555 | Loss: 0.1621
2025-05-27 20:59:57,096 - INFO - Batch 250/555 | Loss: 0.1794
2025-05-27 20:59:59,365 - INFO - Batch 300/555 | Loss: 0.1578
2025-05-27 21:00:01,616 - INFO - Batch 350/555 | Loss: 0.2151
2025-05-27 21:00:03,871 - INFO - Batch 400/555 | Loss: 0.1506
2025-05-27 21:00:06,125 - INFO - Batch 450/555 | Loss: 0.1699
2025-05-27 21:00:08,435 - INFO - Batch 500/555 | Loss: 0.1594
2025-05-27 21:00:10,699 - INFO - Batch 550/555 | Loss: 0.1526
2025-05-27 21:00:20,379 - INFO - Epoch 4/10 | Train Loss: 0.1753 | Val Loss: 0.7569 | Val Action Acc: 0.9906
2025-05-27 21:00:20,570 - INFO - Batch 0/555 | Loss: 0.1782
2025-05-27 21:00:22,823 - INFO - Batch 50/555 | Loss: 0.1677
2025-05-27 21:00:25,072 - INFO - Batch 100/555 | Loss: 0.1361
2025-05-27 21:00:27,318 - INFO - Batch 150/555 | Loss: 0.1444
2025-05-27 21:00:29,560 - INFO - Batch 200/555 | Loss: 0.1534
2025-05-27 21:00:31,805 - INFO - Batch 250/555 | Loss: 0.1603
2025-05-27 21:00:34,057 - INFO - Batch 300/555 | Loss: 0.1618
2025-05-27 21:00:36,304 - INFO - Batch 350/555 | Loss: 0.1410
2025-05-27 21:00:38,544 - INFO - Batch 400/555 | Loss: 0.1497
2025-05-27 21:00:40,799 - INFO - Batch 450/555 | Loss: 0.1435
2025-05-27 21:00:43,040 - INFO - Batch 500/555 | Loss: 0.1742
2025-05-27 21:00:45,274 - INFO - Batch 550/555 | Loss: 0.1683
2025-05-27 21:00:54,671 - INFO - Epoch 5/10 | Train Loss: 0.1584 | Val Loss: 0.7785 | Val Action Acc: 0.9907
2025-05-27 21:00:54,849 - INFO - Batch 0/555 | Loss: 0.1400
2025-05-27 21:00:57,079 - INFO - Batch 50/555 | Loss: 0.1462
2025-05-27 21:00:59,315 - INFO - Batch 100/555 | Loss: 0.1761
2025-05-27 21:01:01,547 - INFO - Batch 150/555 | Loss: 0.1532
2025-05-27 21:01:03,780 - INFO - Batch 200/555 | Loss: 0.1343
2025-05-27 21:01:06,016 - INFO - Batch 250/555 | Loss: 0.1400
2025-05-27 21:01:08,262 - INFO - Batch 300/555 | Loss: 0.1523
2025-05-27 21:01:10,505 - INFO - Batch 350/555 | Loss: 0.1518
2025-05-27 21:01:12,744 - INFO - Batch 400/555 | Loss: 0.1436
2025-05-27 21:01:15,008 - INFO - Batch 450/555 | Loss: 0.1374
2025-05-27 21:01:17,239 - INFO - Batch 500/555 | Loss: 0.1387
2025-05-27 21:01:19,471 - INFO - Batch 550/555 | Loss: 0.1462
2025-05-27 21:01:28,765 - INFO - Epoch 6/10 | Train Loss: 0.1463 | Val Loss: 0.8262 | Val Action Acc: 0.9905
2025-05-27 21:01:28,951 - INFO - Batch 0/555 | Loss: 0.1260
2025-05-27 21:01:31,183 - INFO - Batch 50/555 | Loss: 0.1635
2025-05-27 21:01:33,417 - INFO - Batch 100/555 | Loss: 0.1846
2025-05-27 21:01:35,651 - INFO - Batch 150/555 | Loss: 0.1223
2025-05-27 21:01:37,898 - INFO - Batch 200/555 | Loss: 0.1352
2025-05-27 21:01:40,142 - INFO - Batch 250/555 | Loss: 0.1346
2025-05-27 21:01:42,378 - INFO - Batch 300/555 | Loss: 0.1197
2025-05-27 21:01:44,620 - INFO - Batch 350/555 | Loss: 0.1307
2025-05-27 21:01:46,847 - INFO - Batch 400/555 | Loss: 0.1508
2025-05-27 21:01:49,090 - INFO - Batch 450/555 | Loss: 0.1295
2025-05-27 21:01:51,330 - INFO - Batch 500/555 | Loss: 0.1625
2025-05-27 21:01:53,558 - INFO - Batch 550/555 | Loss: 0.1422
2025-05-27 21:02:02,856 - INFO - Epoch 7/10 | Train Loss: 0.1425 | Val Loss: 0.7949 | Val Action Acc: 0.9906
2025-05-27 21:02:03,033 - INFO - Batch 0/555 | Loss: 0.1209
2025-05-27 21:02:05,265 - INFO - Batch 50/555 | Loss: 0.1208
2025-05-27 21:02:07,506 - INFO - Batch 100/555 | Loss: 0.1466
2025-05-27 21:02:09,742 - INFO - Batch 150/555 | Loss: 0.1398
2025-05-27 21:02:11,975 - INFO - Batch 200/555 | Loss: 0.1180
2025-05-27 21:02:14,222 - INFO - Batch 250/555 | Loss: 0.1553
2025-05-27 21:02:16,457 - INFO - Batch 300/555 | Loss: 0.1256
2025-05-27 21:02:18,697 - INFO - Batch 350/555 | Loss: 0.1325
2025-05-27 21:02:20,940 - INFO - Batch 400/555 | Loss: 0.1200
2025-05-27 21:02:23,176 - INFO - Batch 450/555 | Loss: 0.1171
2025-05-27 21:02:25,411 - INFO - Batch 500/555 | Loss: 0.1179
2025-05-27 21:02:27,648 - INFO - Batch 550/555 | Loss: 0.1159
2025-05-27 21:02:37,093 - INFO - Epoch 8/10 | Train Loss: 0.1322 | Val Loss: 0.8408 | Val Action Acc: 0.9906
2025-05-27 21:02:37,270 - INFO - Batch 0/555 | Loss: 0.1505
2025-05-27 21:02:39,517 - INFO - Batch 50/555 | Loss: 0.1132
2025-05-27 21:02:41,755 - INFO - Batch 100/555 | Loss: 0.1179
2025-05-27 21:02:43,983 - INFO - Batch 150/555 | Loss: 0.1172
2025-05-27 21:02:46,213 - INFO - Batch 200/555 | Loss: 0.0993
2025-05-27 21:02:48,451 - INFO - Batch 250/555 | Loss: 0.1246
2025-05-27 21:02:50,688 - INFO - Batch 300/555 | Loss: 0.1110
2025-05-27 21:02:52,913 - INFO - Batch 350/555 | Loss: 0.1091
2025-05-27 21:02:55,145 - INFO - Batch 400/555 | Loss: 0.1407
2025-05-27 21:02:57,378 - INFO - Batch 450/555 | Loss: 0.1380
2025-05-27 21:02:59,616 - INFO - Batch 500/555 | Loss: 0.1339
2025-05-27 21:03:01,868 - INFO - Batch 550/555 | Loss: 0.1340
2025-05-27 21:03:11,295 - INFO - Epoch 9/10 | Train Loss: 0.1280 | Val Loss: 0.8443 | Val Action Acc: 0.9907
2025-05-27 21:03:11,508 - INFO - Batch 0/555 | Loss: 0.1194
2025-05-27 21:03:13,743 - INFO - Batch 50/555 | Loss: 0.1085
2025-05-27 21:03:15,993 - INFO - Batch 100/555 | Loss: 0.1148
2025-05-27 21:03:18,226 - INFO - Batch 150/555 | Loss: 0.1187
2025-05-27 21:03:20,460 - INFO - Batch 200/555 | Loss: 0.1156
2025-05-27 21:03:22,698 - INFO - Batch 250/555 | Loss: 0.1167
2025-05-27 21:03:24,928 - INFO - Batch 300/555 | Loss: 0.1023
2025-05-27 21:03:27,155 - INFO - Batch 350/555 | Loss: 0.1228
2025-05-27 21:03:29,388 - INFO - Batch 400/555 | Loss: 0.1149
2025-05-27 21:03:31,621 - INFO - Batch 450/555 | Loss: 0.1324
2025-05-27 21:03:33,862 - INFO - Batch 500/555 | Loss: 0.1186
2025-05-27 21:03:36,104 - INFO - Batch 550/555 | Loss: 0.1236
2025-05-27 21:03:45,958 - INFO - Epoch 10/10 | Train Loss: 0.1218 | Val Loss: 0.8623 | Val Action Acc: 0.9907
2025-05-27 21:03:46,810 - INFO - Training plots saved to logs/2025-05-27_20-53-02
2025-05-27 21:03:46,969 - INFO - Training completed. Best model: logs/2025-05-27_20-53-02/checkpoints/supervised_best_epoch_1.pt
2025-05-27 21:03:46,969 - INFO - Final model: logs/2025-05-27_20-53-02/checkpoints/final_model.pt
2025-05-27 21:03:46,969 - INFO - Supervised training completed. Model saved: logs/2025-05-27_20-53-02/checkpoints/supervised_best_epoch_1.pt
2025-05-27 21:03:46,969 - INFO - Starting model evaluation...
2025-05-27 21:03:46,969 - INFO - Evaluating supervised-trained model
2025-05-27 21:03:47,764 - INFO - Starting comprehensive evaluation of both modes
2025-05-27 21:03:47,765 - INFO - Starting supervised mode evaluation (autoregressive action prediction)
2025-05-27 21:03:47,765 - INFO - Evaluating video: VID02
