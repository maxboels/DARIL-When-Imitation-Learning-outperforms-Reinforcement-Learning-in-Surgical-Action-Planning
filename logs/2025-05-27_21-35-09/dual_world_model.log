2025-05-27 21:35:09,426 - INFO - Log file: logs/2025-05-27_21-35-09/dual_world_model.log
2025-05-27 21:35:09,426 - INFO - Starting Dual World Model experiment
2025-05-27 21:35:09,426 - INFO - Using device: cuda
2025-05-27 21:35:09,426 - INFO - Loading CholecT50 data...
2025-05-27 21:35:09,426 - INFO - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-27 21:35:09,826 - INFO - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 21:35:09,826 - INFO - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 21:35:09,828 - INFO - [Train] Found 5 videos in metadata file
2025-05-27 21:35:09,828 - INFO - [Train] Loading data for 5 videos
2025-05-27 21:35:10,176 - INFO - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-27 21:35:10,268 - INFO - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 21:35:10,268 - INFO - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 21:35:10,269 - INFO - [Test] Found 5 videos in metadata file
2025-05-27 21:35:10,269 - INFO - [Test] Loading data for 5 videos
2025-05-27 21:35:13,195 - INFO - Training samples: 8867
2025-05-27 21:35:13,196 - INFO - Test videos: 5
2025-05-27 21:35:13,196 - INFO - Initializing Dual World Model...
2025-05-27 21:35:13,807 - INFO - Total parameters: 48,924,145
2025-05-27 21:35:13,808 - INFO - Trainable parameters: 48,924,145
2025-05-27 21:35:13,808 - INFO - Training mode: supervised
2025-05-27 21:35:13,808 - INFO - Starting supervised training...
2025-05-27 21:35:13,809 - INFO - Starting supervised training for autoregressive action prediction
2025-05-27 21:35:14,215 - INFO - Batch 0/555 | Loss: 3.1361
2025-05-27 21:35:16,470 - INFO - Batch 50/555 | Loss: 1.1346
2025-05-27 21:35:18,670 - INFO - Batch 100/555 | Loss: 0.7689
2025-05-27 21:35:20,874 - INFO - Batch 150/555 | Loss: 0.6558
2025-05-27 21:35:23,080 - INFO - Batch 200/555 | Loss: 0.5434
2025-05-27 21:35:25,309 - INFO - Batch 250/555 | Loss: 0.3664
2025-05-27 21:35:27,532 - INFO - Batch 300/555 | Loss: 0.3670
2025-05-27 21:35:29,777 - INFO - Batch 350/555 | Loss: 0.3784
2025-05-27 21:35:31,998 - INFO - Batch 400/555 | Loss: 0.3258
2025-05-27 21:35:34,225 - INFO - Batch 450/555 | Loss: 0.3180
2025-05-27 21:35:36,449 - INFO - Batch 500/555 | Loss: 0.3302
2025-05-27 21:35:38,678 - INFO - Batch 550/555 | Loss: 0.3000
2025-05-27 21:35:47,493 - INFO - New best model saved: logs/2025-05-27_21-35-09/checkpoints/supervised_best_epoch_1.pt
2025-05-27 21:35:47,493 - INFO - Epoch 1/5 | Train Loss: 0.5745 | Val Loss: 0.6519 | Val Action Acc: 0.9902
2025-05-27 21:35:47,673 - INFO - Batch 0/555 | Loss: 0.2230
2025-05-27 21:35:49,931 - INFO - Batch 50/555 | Loss: 0.2562
2025-05-27 21:35:52,170 - INFO - Batch 100/555 | Loss: 0.2921
2025-05-27 21:35:54,408 - INFO - Batch 150/555 | Loss: 0.2649
2025-05-27 21:35:56,648 - INFO - Batch 200/555 | Loss: 0.2466
2025-05-27 21:35:58,906 - INFO - Batch 250/555 | Loss: 0.2224
2025-05-27 21:36:01,149 - INFO - Batch 300/555 | Loss: 0.2349
2025-05-27 21:36:03,395 - INFO - Batch 350/555 | Loss: 0.2378
2025-05-27 21:36:05,656 - INFO - Batch 400/555 | Loss: 0.2312
2025-05-27 21:36:07,922 - INFO - Batch 450/555 | Loss: 0.1930
2025-05-27 21:36:10,169 - INFO - Batch 500/555 | Loss: 0.1867
2025-05-27 21:36:12,439 - INFO - Batch 550/555 | Loss: 0.1882
2025-05-27 21:36:21,079 - INFO - Epoch 2/5 | Train Loss: 0.2494 | Val Loss: 0.7021 | Val Action Acc: 0.9902
2025-05-27 21:36:21,245 - INFO - Batch 0/555 | Loss: 0.2136
2025-05-27 21:36:23,493 - INFO - Batch 50/555 | Loss: 0.2045
2025-05-27 21:36:25,752 - INFO - Batch 100/555 | Loss: 0.2174
2025-05-27 21:36:28,004 - INFO - Batch 150/555 | Loss: 0.1743
2025-05-27 21:36:30,261 - INFO - Batch 200/555 | Loss: 0.1737
2025-05-27 21:36:32,530 - INFO - Batch 250/555 | Loss: 0.1963
2025-05-27 21:36:34,798 - INFO - Batch 300/555 | Loss: 0.2323
2025-05-27 21:36:37,065 - INFO - Batch 350/555 | Loss: 0.1882
2025-05-27 21:36:39,328 - INFO - Batch 400/555 | Loss: 0.1891
2025-05-27 21:36:41,604 - INFO - Batch 450/555 | Loss: 0.1569
2025-05-27 21:36:43,890 - INFO - Batch 500/555 | Loss: 0.1661
2025-05-27 21:36:46,150 - INFO - Batch 550/555 | Loss: 0.1496
2025-05-27 21:36:55,446 - INFO - Epoch 3/5 | Train Loss: 0.1986 | Val Loss: 0.7626 | Val Action Acc: 0.9903
2025-05-27 21:36:55,669 - INFO - Batch 0/555 | Loss: 0.1942
2025-05-27 21:36:57,989 - INFO - Batch 50/555 | Loss: 0.2180
2025-05-27 21:37:00,276 - INFO - Batch 100/555 | Loss: 0.1781
2025-05-27 21:37:02,601 - INFO - Batch 150/555 | Loss: 0.1824
2025-05-27 21:37:04,867 - INFO - Batch 200/555 | Loss: 0.1617
2025-05-27 21:37:07,126 - INFO - Batch 250/555 | Loss: 0.2100
2025-05-27 21:37:09,380 - INFO - Batch 300/555 | Loss: 0.1809
2025-05-27 21:37:11,658 - INFO - Batch 350/555 | Loss: 0.2564
2025-05-27 21:37:13,924 - INFO - Batch 400/555 | Loss: 0.1553
2025-05-27 21:37:16,191 - INFO - Batch 450/555 | Loss: 0.1740
2025-05-27 21:37:18,466 - INFO - Batch 500/555 | Loss: 0.1516
2025-05-27 21:37:20,751 - INFO - Batch 550/555 | Loss: 0.1476
2025-05-27 21:37:31,444 - INFO - Epoch 4/5 | Train Loss: 0.1735 | Val Loss: 0.7595 | Val Action Acc: 0.9906
2025-05-27 21:37:31,679 - INFO - Batch 0/555 | Loss: 0.1784
2025-05-27 21:37:33,976 - INFO - Batch 50/555 | Loss: 0.1681
2025-05-27 21:37:36,278 - INFO - Batch 100/555 | Loss: 0.1310
2025-05-27 21:37:38,534 - INFO - Batch 150/555 | Loss: 0.1377
2025-05-27 21:37:40,780 - INFO - Batch 200/555 | Loss: 0.1453
2025-05-27 21:37:43,051 - INFO - Batch 250/555 | Loss: 0.1620
2025-05-27 21:37:45,328 - INFO - Batch 300/555 | Loss: 0.1636
2025-05-27 21:37:47,583 - INFO - Batch 350/555 | Loss: 0.1443
2025-05-27 21:37:49,820 - INFO - Batch 400/555 | Loss: 0.1447
2025-05-27 21:37:52,062 - INFO - Batch 450/555 | Loss: 0.1427
2025-05-27 21:37:54,304 - INFO - Batch 500/555 | Loss: 0.1713
2025-05-27 21:37:56,576 - INFO - Batch 550/555 | Loss: 0.1614
2025-05-27 21:38:06,899 - INFO - Epoch 5/5 | Train Loss: 0.1595 | Val Loss: 0.7873 | Val Action Acc: 0.9905
2025-05-27 21:38:07,815 - INFO - Training plots saved to logs/2025-05-27_21-35-09
2025-05-27 21:38:07,981 - INFO - Training completed. Best model: logs/2025-05-27_21-35-09/checkpoints/supervised_best_epoch_1.pt
2025-05-27 21:38:07,981 - INFO - Final model: logs/2025-05-27_21-35-09/checkpoints/final_model.pt
2025-05-27 21:38:07,982 - INFO - Supervised training completed. Model saved: logs/2025-05-27_21-35-09/checkpoints/supervised_best_epoch_1.pt
2025-05-27 21:38:07,982 - INFO - Starting model evaluation...
2025-05-27 21:38:07,982 - INFO - Evaluating supervised-trained model
2025-05-27 21:38:08,900 - INFO - Starting comprehensive evaluation of both modes
2025-05-27 21:38:08,900 - INFO - Starting supervised mode evaluation (autoregressive action prediction)
2025-05-27 21:38:08,900 - INFO - Evaluating video: VID02
2025-05-27 21:39:30,881 - INFO - Evaluating video: VID06
2025-05-27 21:40:32,881 - INFO - Evaluating video: VID111
2025-05-27 21:41:30,778 - INFO - Evaluating video: VID14
2025-05-27 21:42:19,229 - INFO - Evaluating video: VID23
2025-05-27 21:43:06,256 - INFO - Supervised evaluation completed. Processed 10480 samples from 5 videos.
2025-05-27 21:43:06,257 - INFO - Starting RL mode evaluation (state and reward prediction)
2025-05-27 21:43:06,257 - INFO - Evaluating RL mode on video: VID02
2025-05-27 21:43:06,452 - ERROR - Evaluation failed: 'DualWorldModel' object has no attribute 'rl_state_prediction'
2025-05-27 21:43:06,453 - INFO - Starting RL environment experiments...
2025-05-27 21:43:06,453 - INFO - Setting up RL environment experiments
2025-05-27 21:43:06,455 - INFO - Testing random policy baseline...
2025-05-27 21:43:06,463 - ERROR - RL environment experiments failed: 'DualWorldModel' object has no attribute 'rl_state_prediction'
2025-05-27 21:43:06,463 - INFO - Generating summary report...
