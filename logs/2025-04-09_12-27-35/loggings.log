2025-04-09 12:27:35,723 - INFO - Log file: logs/2025-04-09_12-27-35/loggings.log
2025-04-09 12:27:35,723 - INFO - Starting CholecT50 experiment for Surgical Actions Prediction
2025-04-09 12:27:35,723 - INFO - Experiment configuration: {'max_videos': None, 'recognition': {'train': True, 'inference': True, 'best_model_path': 'best_model_epoch1_valloss1.190734.pt'}, 'pretrain_next_frame': {'train': False, 'inference': False, 'best_model_path': 'best_model_epoch1_valloss1.190734.pt'}, 'pretrain_reward_model': False, 'calculate_action_rewards': False, 'train_action_policy': False, 'run_tdmpc': False, 'analyze_results': False, 'run_evaluation': False}
2025-04-09 12:27:35,723 - INFO - Using device: cuda
2025-04-09 12:27:35,723 - INFO - Loading CholecT50 data...
2025-04-09 12:27:47,276 - INFO - Created Recognition Head model with:
2025-04-09 12:27:47,276 - INFO -   - Input dimension: 1024
2025-04-09 12:27:47,276 - INFO -   - Hidden dimension: 768
2025-04-09 12:27:47,276 - INFO -   - Action classes: 100
2025-04-09 12:27:47,276 - INFO -   - Instrument classes: 6
2025-04-09 12:27:47,276 - INFO - Starting model training...
2025-04-09 12:27:47,400 - INFO - Epoch 1/3, Batch 0/4933, Loss: 1.4304
2025-04-09 12:27:48,001 - INFO - Epoch 1/3, Batch 40/4933, Loss: 0.5815
2025-04-09 12:27:48,598 - INFO - Epoch 1/3, Batch 80/4933, Loss: 0.2556
2025-04-09 12:27:49,188 - INFO - Epoch 1/3, Batch 120/4933, Loss: 0.1602
2025-04-09 12:27:49,794 - INFO - Epoch 1/3, Batch 160/4933, Loss: 0.1288
2025-04-09 12:27:50,400 - INFO - Epoch 1/3, Batch 200/4933, Loss: 0.0937
2025-04-09 12:27:51,022 - INFO - Epoch 1/3, Batch 240/4933, Loss: 0.1988
2025-04-09 12:27:51,644 - INFO - Epoch 1/3, Batch 280/4933, Loss: 0.1071
2025-04-09 12:27:52,266 - INFO - Epoch 1/3, Batch 320/4933, Loss: 0.0883
2025-04-09 12:27:52,892 - INFO - Epoch 1/3, Batch 360/4933, Loss: 0.0554
2025-04-09 12:27:53,524 - INFO - Epoch 1/3, Batch 400/4933, Loss: 0.1331
2025-04-09 12:27:54,159 - INFO - Epoch 1/3, Batch 440/4933, Loss: 0.0469
2025-04-09 12:27:54,803 - INFO - Epoch 1/3, Batch 480/4933, Loss: 0.0366
2025-04-09 12:27:55,453 - INFO - Epoch 1/3, Batch 520/4933, Loss: 0.0914
2025-04-09 12:27:56,099 - INFO - Epoch 1/3, Batch 560/4933, Loss: 0.0385
2025-04-09 12:27:56,746 - INFO - Epoch 1/3, Batch 600/4933, Loss: 0.0577
2025-04-09 12:27:57,398 - INFO - Epoch 1/3, Batch 640/4933, Loss: 0.0348
2025-04-09 12:27:58,071 - INFO - Epoch 1/3, Batch 680/4933, Loss: 0.0611
2025-04-09 12:27:58,731 - INFO - Epoch 1/3, Batch 720/4933, Loss: 0.0533
2025-04-09 12:27:59,387 - INFO - Epoch 1/3, Batch 760/4933, Loss: 0.0857
2025-04-09 12:28:00,046 - INFO - Epoch 1/3, Batch 800/4933, Loss: 0.0548
2025-04-09 12:28:00,712 - INFO - Epoch 1/3, Batch 840/4933, Loss: 0.0389
2025-04-09 12:28:01,390 - INFO - Epoch 1/3, Batch 880/4933, Loss: 0.0205
2025-04-09 12:28:02,086 - INFO - Epoch 1/3, Batch 920/4933, Loss: 0.0312
2025-04-09 12:28:02,782 - INFO - Epoch 1/3, Batch 960/4933, Loss: 0.0284
2025-04-09 12:28:03,488 - INFO - Epoch 1/3, Batch 1000/4933, Loss: 0.0443
2025-04-09 12:28:04,188 - INFO - Epoch 1/3, Batch 1040/4933, Loss: 0.0844
2025-04-09 12:28:04,874 - INFO - Epoch 1/3, Batch 1080/4933, Loss: 0.0365
2025-04-09 12:28:05,529 - INFO - Epoch 1/3, Batch 1120/4933, Loss: 0.0342
2025-04-09 12:28:06,181 - INFO - Epoch 1/3, Batch 1160/4933, Loss: 0.0265
2025-04-09 12:28:06,837 - INFO - Epoch 1/3, Batch 1200/4933, Loss: 0.0848
2025-04-09 12:28:07,491 - INFO - Epoch 1/3, Batch 1240/4933, Loss: 0.0391
2025-04-09 12:28:08,155 - INFO - Epoch 1/3, Batch 1280/4933, Loss: 0.1179
2025-04-09 12:28:08,813 - INFO - Epoch 1/3, Batch 1320/4933, Loss: 0.0414
2025-04-09 12:28:09,474 - INFO - Epoch 1/3, Batch 1360/4933, Loss: 0.0946
2025-04-09 12:28:10,140 - INFO - Epoch 1/3, Batch 1400/4933, Loss: 0.0376
2025-04-09 12:28:10,807 - INFO - Epoch 1/3, Batch 1440/4933, Loss: 0.0403
2025-04-09 12:28:11,478 - INFO - Epoch 1/3, Batch 1480/4933, Loss: 0.0689
2025-04-09 12:28:12,161 - INFO - Epoch 1/3, Batch 1520/4933, Loss: 0.0284
2025-04-09 12:28:12,833 - INFO - Epoch 1/3, Batch 1560/4933, Loss: 0.0383
2025-04-09 12:28:13,507 - INFO - Epoch 1/3, Batch 1600/4933, Loss: 0.0222
2025-04-09 12:28:14,191 - INFO - Epoch 1/3, Batch 1640/4933, Loss: 0.0089
2025-04-09 12:28:14,872 - INFO - Epoch 1/3, Batch 1680/4933, Loss: 0.0205
2025-04-09 12:28:15,559 - INFO - Epoch 1/3, Batch 1720/4933, Loss: 0.0543
2025-04-09 12:28:16,257 - INFO - Epoch 1/3, Batch 1760/4933, Loss: 0.0234
2025-04-09 12:28:16,944 - INFO - Epoch 1/3, Batch 1800/4933, Loss: 0.0586
2025-04-09 12:28:17,628 - INFO - Epoch 1/3, Batch 1840/4933, Loss: 0.0693
2025-04-09 12:28:18,344 - INFO - Epoch 1/3, Batch 1880/4933, Loss: 0.0218
2025-04-09 12:28:19,038 - INFO - Epoch 1/3, Batch 1920/4933, Loss: 0.0596
2025-04-09 12:28:19,751 - INFO - Epoch 1/3, Batch 1960/4933, Loss: 0.0716
2025-04-09 12:28:20,449 - INFO - Epoch 1/3, Batch 2000/4933, Loss: 0.0416
2025-04-09 12:28:21,151 - INFO - Epoch 1/3, Batch 2040/4933, Loss: 0.0380
2025-04-09 12:28:21,855 - INFO - Epoch 1/3, Batch 2080/4933, Loss: 0.0598
2025-04-09 12:28:22,561 - INFO - Epoch 1/3, Batch 2120/4933, Loss: 0.0331
2025-04-09 12:28:23,265 - INFO - Epoch 1/3, Batch 2160/4933, Loss: 0.0530
2025-04-09 12:28:23,981 - INFO - Epoch 1/3, Batch 2200/4933, Loss: 0.0371
2025-04-09 12:28:24,684 - INFO - Epoch 1/3, Batch 2240/4933, Loss: 0.0239
2025-04-09 12:28:25,399 - INFO - Epoch 1/3, Batch 2280/4933, Loss: 0.0400
2025-04-09 12:28:26,285 - INFO - Epoch 1/3, Batch 2320/4933, Loss: 0.0744
2025-04-09 12:28:27,262 - INFO - Epoch 1/3, Batch 2360/4933, Loss: 0.0152
2025-04-09 12:28:28,284 - INFO - Epoch 1/3, Batch 2400/4933, Loss: 0.0270
2025-04-09 12:28:29,312 - INFO - Epoch 1/3, Batch 2440/4933, Loss: 0.0365
2025-04-09 12:28:30,320 - INFO - Epoch 1/3, Batch 2480/4933, Loss: 0.0852
2025-04-09 12:28:31,355 - INFO - Epoch 1/3, Batch 2520/4933, Loss: 0.0565
2025-04-09 12:28:32,380 - INFO - Epoch 1/3, Batch 2560/4933, Loss: 0.0342
2025-04-09 12:28:33,418 - INFO - Epoch 1/3, Batch 2600/4933, Loss: 0.0339
2025-04-09 12:28:34,472 - INFO - Epoch 1/3, Batch 2640/4933, Loss: 0.0595
2025-04-09 12:28:35,513 - INFO - Epoch 1/3, Batch 2680/4933, Loss: 0.1326
2025-04-09 12:28:36,564 - INFO - Epoch 1/3, Batch 2720/4933, Loss: 0.0345
2025-04-09 12:28:37,632 - INFO - Epoch 1/3, Batch 2760/4933, Loss: 0.0582
2025-04-09 12:28:38,710 - INFO - Epoch 1/3, Batch 2800/4933, Loss: 0.0467
2025-04-09 12:28:39,800 - INFO - Epoch 1/3, Batch 2840/4933, Loss: 0.0288
2025-04-09 12:28:40,892 - INFO - Epoch 1/3, Batch 2880/4933, Loss: 0.0883
2025-04-09 12:28:41,986 - INFO - Epoch 1/3, Batch 2920/4933, Loss: 0.0419
2025-04-09 12:28:43,094 - INFO - Epoch 1/3, Batch 2960/4933, Loss: 0.0678
2025-04-09 12:28:44,213 - INFO - Epoch 1/3, Batch 3000/4933, Loss: 0.0869
2025-04-09 12:28:45,343 - INFO - Epoch 1/3, Batch 3040/4933, Loss: 0.0538
2025-04-09 12:28:46,498 - INFO - Epoch 1/3, Batch 3080/4933, Loss: 0.0616
2025-04-09 12:28:47,658 - INFO - Epoch 1/3, Batch 3120/4933, Loss: 0.1643
2025-04-09 12:28:48,836 - INFO - Epoch 1/3, Batch 3160/4933, Loss: 0.0180
2025-04-09 12:28:50,014 - INFO - Epoch 1/3, Batch 3200/4933, Loss: 0.0281
2025-04-09 12:28:51,210 - INFO - Epoch 1/3, Batch 3240/4933, Loss: 0.0557
2025-04-09 12:28:52,412 - INFO - Epoch 1/3, Batch 3280/4933, Loss: 0.0476
2025-04-09 12:28:53,607 - INFO - Epoch 1/3, Batch 3320/4933, Loss: 0.0303
2025-04-09 12:28:54,824 - INFO - Epoch 1/3, Batch 3360/4933, Loss: 0.0876
2025-04-09 12:28:56,051 - INFO - Epoch 1/3, Batch 3400/4933, Loss: 0.0538
2025-04-09 12:28:57,289 - INFO - Epoch 1/3, Batch 3440/4933, Loss: 0.1225
2025-04-09 12:28:58,505 - INFO - Epoch 1/3, Batch 3480/4933, Loss: 0.0721
2025-04-09 12:28:59,745 - INFO - Epoch 1/3, Batch 3520/4933, Loss: 0.0480
2025-04-09 12:29:00,994 - INFO - Epoch 1/3, Batch 3560/4933, Loss: 0.0170
2025-04-09 12:29:02,259 - INFO - Epoch 1/3, Batch 3600/4933, Loss: 0.0251
2025-04-09 12:29:03,501 - INFO - Epoch 1/3, Batch 3640/4933, Loss: 0.0281
2025-04-09 12:29:04,761 - INFO - Epoch 1/3, Batch 3680/4933, Loss: 0.1000
2025-04-09 12:29:06,030 - INFO - Epoch 1/3, Batch 3720/4933, Loss: 0.0207
2025-04-09 12:29:07,323 - INFO - Epoch 1/3, Batch 3760/4933, Loss: 0.0222
2025-04-09 12:29:08,620 - INFO - Epoch 1/3, Batch 3800/4933, Loss: 0.0369
2025-04-09 12:29:09,930 - INFO - Epoch 1/3, Batch 3840/4933, Loss: 0.0735
2025-04-09 12:29:11,257 - INFO - Epoch 1/3, Batch 3880/4933, Loss: 0.0343
2025-04-09 12:29:12,611 - INFO - Epoch 1/3, Batch 3920/4933, Loss: 0.0888
2025-04-09 12:29:13,959 - INFO - Epoch 1/3, Batch 3960/4933, Loss: 0.0234
2025-04-09 12:29:15,311 - INFO - Epoch 1/3, Batch 4000/4933, Loss: 0.0366
2025-04-09 12:29:16,681 - INFO - Epoch 1/3, Batch 4040/4933, Loss: 0.0286
2025-04-09 12:29:18,069 - INFO - Epoch 1/3, Batch 4080/4933, Loss: 0.0799
2025-04-09 12:29:19,446 - INFO - Epoch 1/3, Batch 4120/4933, Loss: 0.0797
2025-04-09 12:29:20,824 - INFO - Epoch 1/3, Batch 4160/4933, Loss: 0.0577
2025-04-09 12:29:22,216 - INFO - Epoch 1/3, Batch 4200/4933, Loss: 0.0521
2025-04-09 12:29:23,638 - INFO - Epoch 1/3, Batch 4240/4933, Loss: 0.0138
2025-04-09 12:29:25,035 - INFO - Epoch 1/3, Batch 4280/4933, Loss: 0.0150
2025-04-09 12:29:26,439 - INFO - Epoch 1/3, Batch 4320/4933, Loss: 0.0158
2025-04-09 12:29:27,859 - INFO - Epoch 1/3, Batch 4360/4933, Loss: 0.0946
2025-04-09 12:29:29,295 - INFO - Epoch 1/3, Batch 4400/4933, Loss: 0.0559
2025-04-09 12:29:30,720 - INFO - Epoch 1/3, Batch 4440/4933, Loss: 0.0578
2025-04-09 12:29:32,152 - INFO - Epoch 1/3, Batch 4480/4933, Loss: 0.0275
2025-04-09 12:29:33,615 - INFO - Epoch 1/3, Batch 4520/4933, Loss: 0.0551
2025-04-09 12:29:35,075 - INFO - Epoch 1/3, Batch 4560/4933, Loss: 0.0262
2025-04-09 12:29:36,541 - INFO - Epoch 1/3, Batch 4600/4933, Loss: 0.0226
2025-04-09 12:29:37,999 - INFO - Epoch 1/3, Batch 4640/4933, Loss: 0.0554
2025-04-09 12:29:39,468 - INFO - Epoch 1/3, Batch 4680/4933, Loss: 0.1250
2025-04-09 12:29:40,953 - INFO - Epoch 1/3, Batch 4720/4933, Loss: 0.0150
2025-04-09 12:29:42,447 - INFO - Epoch 1/3, Batch 4760/4933, Loss: 0.0956
2025-04-09 12:29:43,932 - INFO - Epoch 1/3, Batch 4800/4933, Loss: 0.0507
2025-04-09 12:29:45,447 - INFO - Epoch 1/3, Batch 4840/4933, Loss: 0.0550
2025-04-09 12:29:46,955 - INFO - Epoch 1/3, Batch 4880/4933, Loss: 0.0056
2025-04-09 12:29:48,486 - INFO - Epoch 1/3, Batch 4920/4933, Loss: 0.0633
2025-04-09 12:29:50,285 - INFO - Epoch 1/3, Validation mAP Action (sklearn): 0.2113
2025-04-09 12:29:50,285 - INFO - Epoch 1/3, Validation mAP Instrument (sklearn): 0.9687
2025-04-09 12:29:50,285 - INFO - Epoch 1/3, Train Loss: 0.0702
2025-04-09 12:29:58,582 - INFO - [TRAIN] instrument mean AP (ivt_metrics): 0.8405648481902791
2025-04-09 12:29:59,860 - INFO - [TRAIN] action mean AP (ivt_metrics): 0.2113117553532271
2025-04-09 12:29:59,860 - INFO - [TRAIN] Epoch 1/3, Train mAP Instrument (ivt metrics): 0.8406
2025-04-09 12:29:59,860 - INFO - [TRAIN] Epoch 1/3, Train mAP Action (ivt metrics): 0.2113
2025-04-09 12:30:00,397 - INFO - Video VID02 | Batch 0/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:02,289 - INFO - Video VID02 | Batch 40/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:02,469 - INFO - Video VID02 | Batch 80/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:02,632 - INFO - Video VID02 | Batch 120/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:02,801 - INFO - Video VID02 | Batch 160/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:02,957 - INFO - [TEST] Video VID02: Test mAP (sklearn) Action: 0.4493
2025-04-09 12:30:02,957 - INFO - [TEST] Video VID02: Test mAP (sklearn) Instrument: 0.9260
2025-04-09 12:30:03,159 - INFO - Video VID06 | Batch 0/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:03,316 - INFO - Video VID06 | Batch 40/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:03,484 - INFO - Video VID06 | Batch 80/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:03,644 - INFO - Video VID06 | Batch 120/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:03,768 - INFO - [TEST] Video VID06: Test mAP (sklearn) Action: 0.4698
2025-04-09 12:30:03,768 - INFO - [TEST] Video VID06: Test mAP (sklearn) Instrument: 0.9444
2025-04-09 12:30:03,951 - INFO - Video VID111 | Batch 0/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:04,109 - INFO - Video VID111 | Batch 40/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:04,266 - INFO - Video VID111 | Batch 80/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:04,422 - INFO - Video VID111 | Batch 120/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:04,554 - INFO - [TEST] Video VID111: Test mAP (sklearn) Action: 0.5238
2025-04-09 12:30:04,554 - INFO - [TEST] Video VID111: Test mAP (sklearn) Instrument: 0.9589
2025-04-09 12:30:04,737 - INFO - Video VID14 | Batch 0/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:04,885 - INFO - Video VID14 | Batch 40/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:05,046 - INFO - Video VID14 | Batch 80/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:05,221 - INFO - [TEST] Video VID14: Test mAP (sklearn) Action: 0.3619
2025-04-09 12:30:05,221 - INFO - [TEST] Video VID14: Test mAP (sklearn) Instrument: 0.8406
2025-04-09 12:30:05,404 - INFO - Video VID23 | Batch 0/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:05,555 - INFO - Video VID23 | Batch 40/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:05,711 - INFO - Video VID23 | Batch 80/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:05,862 - INFO - [TEST] Video VID23: Test mAP (sklearn) Action: 0.4567
2025-04-09 12:30:05,862 - INFO - [TEST] Video VID23: Test mAP (sklearn) Instrument: 0.8933
2025-04-09 12:30:06,046 - INFO - Video VID25 | Batch 0/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:06,201 - INFO - Video VID25 | Batch 40/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:06,357 - INFO - Video VID25 | Batch 80/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:06,515 - INFO - Video VID25 | Batch 120/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:06,636 - INFO - [TEST] Video VID25: Test mAP (sklearn) Action: 0.5830
2025-04-09 12:30:06,636 - INFO - [TEST] Video VID25: Test mAP (sklearn) Instrument: 0.9119
2025-04-09 12:30:06,817 - INFO - Video VID50 | Batch 0/69, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:06,971 - INFO - Video VID50 | Batch 40/69, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:07,146 - INFO - [TEST] Video VID50: Test mAP (sklearn) Action: 0.5400
2025-04-09 12:30:07,146 - INFO - [TEST] Video VID50: Test mAP (sklearn) Instrument: 0.9843
2025-04-09 12:30:07,338 - INFO - Video VID51 | Batch 0/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:07,501 - INFO - Video VID51 | Batch 40/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:07,680 - INFO - Video VID51 | Batch 80/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:07,845 - INFO - Video VID51 | Batch 120/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:08,015 - INFO - Video VID51 | Batch 160/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:08,181 - INFO - [TEST] Video VID51: Test mAP (sklearn) Action: 0.4873
2025-04-09 12:30:08,181 - INFO - [TEST] Video VID51: Test mAP (sklearn) Instrument: 0.9587
2025-04-09 12:30:08,361 - INFO - Video VID66 | Batch 0/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:08,526 - INFO - Video VID66 | Batch 40/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:08,678 - INFO - Video VID66 | Batch 80/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:08,889 - INFO - [TEST] Video VID66: Test mAP (sklearn) Action: 0.6078
2025-04-09 12:30:08,889 - INFO - [TEST] Video VID66: Test mAP (sklearn) Instrument: 0.9302
2025-04-09 12:30:09,103 - INFO - Video VID79 | Batch 0/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:09,261 - INFO - Video VID79 | Batch 40/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:09,428 - INFO - Video VID79 | Batch 80/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:09,596 - INFO - Video VID79 | Batch 120/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:09,760 - INFO - Video VID79 | Batch 160/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:09,928 - INFO - Video VID79 | Batch 200/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:30:10,065 - INFO - [TEST] Video VID79: Test mAP (sklearn) Action: 0.4142
2025-04-09 12:30:10,065 - INFO - [TEST] Video VID79: Test mAP (sklearn) Instrument: 0.9801
2025-04-09 12:30:12,812 - INFO - [TEST] Overall action mAP (sklearn): 0.4894
2025-04-09 12:30:12,813 - INFO - [TEST] Overall instrument mAP (sklearn): 0.9328
2025-04-09 12:30:12,813 - INFO - [TEST] Overall action mAP (ivt): 0.3575
2025-04-09 12:30:12,813 - INFO - [TEST] Overall instrument mAP (ivt): 0.9198
2025-04-09 12:30:12,813 - INFO - [TEST] Epoch 1: Validation mAP Action (sklearn): 0.4894
2025-04-09 12:30:12,813 - INFO - [TEST] Epoch 1: Validation mAP Instrument (sklearn): 0.9328
2025-04-09 12:30:12,813 - INFO - [TEST] Epoch 1: Validation mAP Action (ivt): 0.3575
2025-04-09 12:30:12,813 - INFO - [TEST] Epoch 1: Validation mAP Instrument (ivt): 0.9198
2025-04-09 12:30:12,945 - INFO - Saved new best model with mAP: 0.4894
2025-04-09 12:30:12,967 - INFO - Epoch 2/3, Batch 0/4933, Loss: 0.0085
2025-04-09 12:30:13,584 - INFO - Epoch 2/3, Batch 40/4933, Loss: 0.0610
2025-04-09 12:30:14,210 - INFO - Epoch 2/3, Batch 80/4933, Loss: 0.0271
2025-04-09 12:30:14,833 - INFO - Epoch 2/3, Batch 120/4933, Loss: 0.0320
2025-04-09 12:30:15,458 - INFO - Epoch 2/3, Batch 160/4933, Loss: 0.0852
2025-04-09 12:30:16,080 - INFO - Epoch 2/3, Batch 200/4933, Loss: 0.0513
2025-04-09 12:30:16,724 - INFO - Epoch 2/3, Batch 240/4933, Loss: 0.0184
2025-04-09 12:30:17,368 - INFO - Epoch 2/3, Batch 280/4933, Loss: 0.0578
2025-04-09 12:30:18,025 - INFO - Epoch 2/3, Batch 320/4933, Loss: 0.0904
2025-04-09 12:30:18,673 - INFO - Epoch 2/3, Batch 360/4933, Loss: 0.0506
2025-04-09 12:30:19,326 - INFO - Epoch 2/3, Batch 400/4933, Loss: 0.0668
2025-04-09 12:30:19,969 - INFO - Epoch 2/3, Batch 440/4933, Loss: 0.0821
2025-04-09 12:30:20,623 - INFO - Epoch 2/3, Batch 480/4933, Loss: 0.0592
2025-04-09 12:30:21,287 - INFO - Epoch 2/3, Batch 520/4933, Loss: 0.0213
2025-04-09 12:30:21,945 - INFO - Epoch 2/3, Batch 560/4933, Loss: 0.0517
2025-04-09 12:30:22,614 - INFO - Epoch 2/3, Batch 600/4933, Loss: 0.0168
2025-04-09 12:30:23,276 - INFO - Epoch 2/3, Batch 640/4933, Loss: 0.0350
2025-04-09 12:30:23,944 - INFO - Epoch 2/3, Batch 680/4933, Loss: 0.0476
2025-04-09 12:30:24,616 - INFO - Epoch 2/3, Batch 720/4933, Loss: 0.0114
2025-04-09 12:30:25,294 - INFO - Epoch 2/3, Batch 760/4933, Loss: 0.0496
2025-04-09 12:30:26,011 - INFO - Epoch 2/3, Batch 800/4933, Loss: 0.1247
2025-04-09 12:30:26,728 - INFO - Epoch 2/3, Batch 840/4933, Loss: 0.0527
2025-04-09 12:30:27,431 - INFO - Epoch 2/3, Batch 880/4933, Loss: 0.0274
2025-04-09 12:30:28,147 - INFO - Epoch 2/3, Batch 920/4933, Loss: 0.0738
2025-04-09 12:30:28,844 - INFO - Epoch 2/3, Batch 960/4933, Loss: 0.0158
2025-04-09 12:30:29,547 - INFO - Epoch 2/3, Batch 1000/4933, Loss: 0.0787
2025-04-09 12:30:30,255 - INFO - Epoch 2/3, Batch 1040/4933, Loss: 0.0460
2025-04-09 12:30:30,948 - INFO - Epoch 2/3, Batch 1080/4933, Loss: 0.1370
2025-04-09 12:30:31,609 - INFO - Epoch 2/3, Batch 1120/4933, Loss: 0.0538
2025-04-09 12:30:32,289 - INFO - Epoch 2/3, Batch 1160/4933, Loss: 0.0422
2025-04-09 12:30:32,959 - INFO - Epoch 2/3, Batch 1200/4933, Loss: 0.0286
2025-04-09 12:30:33,629 - INFO - Epoch 2/3, Batch 1240/4933, Loss: 0.0364
2025-04-09 12:30:34,300 - INFO - Epoch 2/3, Batch 1280/4933, Loss: 0.0104
2025-04-09 12:30:34,973 - INFO - Epoch 2/3, Batch 1320/4933, Loss: 0.0262
2025-04-09 12:30:35,649 - INFO - Epoch 2/3, Batch 1360/4933, Loss: 0.0550
2025-04-09 12:30:36,325 - INFO - Epoch 2/3, Batch 1400/4933, Loss: 0.0252
2025-04-09 12:30:37,005 - INFO - Epoch 2/3, Batch 1440/4933, Loss: 0.0103
2025-04-09 12:30:37,702 - INFO - Epoch 2/3, Batch 1480/4933, Loss: 0.0342
2025-04-09 12:30:38,390 - INFO - Epoch 2/3, Batch 1520/4933, Loss: 0.0606
2025-04-09 12:30:39,078 - INFO - Epoch 2/3, Batch 1560/4933, Loss: 0.0143
2025-04-09 12:30:39,778 - INFO - Epoch 2/3, Batch 1600/4933, Loss: 0.1168
2025-04-09 12:30:40,465 - INFO - Epoch 2/3, Batch 1640/4933, Loss: 0.0453
2025-04-09 12:30:41,157 - INFO - Epoch 2/3, Batch 1680/4933, Loss: 0.0518
2025-04-09 12:30:41,856 - INFO - Epoch 2/3, Batch 1720/4933, Loss: 0.0514
2025-04-09 12:30:42,563 - INFO - Epoch 2/3, Batch 1760/4933, Loss: 0.0165
2025-04-09 12:30:43,277 - INFO - Epoch 2/3, Batch 1800/4933, Loss: 0.0328
2025-04-09 12:30:43,979 - INFO - Epoch 2/3, Batch 1840/4933, Loss: 0.0367
2025-04-09 12:30:44,680 - INFO - Epoch 2/3, Batch 1880/4933, Loss: 0.0487
2025-04-09 12:30:45,400 - INFO - Epoch 2/3, Batch 1920/4933, Loss: 0.0326
2025-04-09 12:30:46,131 - INFO - Epoch 2/3, Batch 1960/4933, Loss: 0.0840
2025-04-09 12:30:46,842 - INFO - Epoch 2/3, Batch 2000/4933, Loss: 0.0380
2025-04-09 12:30:47,555 - INFO - Epoch 2/3, Batch 2040/4933, Loss: 0.0517
2025-04-09 12:30:48,299 - INFO - Epoch 2/3, Batch 2080/4933, Loss: 0.0658
2025-04-09 12:30:49,006 - INFO - Epoch 2/3, Batch 2120/4933, Loss: 0.0343
2025-04-09 12:30:49,724 - INFO - Epoch 2/3, Batch 2160/4933, Loss: 0.0445
2025-04-09 12:30:50,472 - INFO - Epoch 2/3, Batch 2200/4933, Loss: 0.0521
2025-04-09 12:30:51,210 - INFO - Epoch 2/3, Batch 2240/4933, Loss: 0.0385
2025-04-09 12:30:51,950 - INFO - Epoch 2/3, Batch 2280/4933, Loss: 0.0204
2025-04-09 12:30:52,708 - INFO - Epoch 2/3, Batch 2320/4933, Loss: 0.0295
2025-04-09 12:30:53,434 - INFO - Epoch 2/3, Batch 2360/4933, Loss: 0.0151
2025-04-09 12:30:54,161 - INFO - Epoch 2/3, Batch 2400/4933, Loss: 0.0569
2025-04-09 12:30:54,896 - INFO - Epoch 2/3, Batch 2440/4933, Loss: 0.0680
2025-04-09 12:30:55,643 - INFO - Epoch 2/3, Batch 2480/4933, Loss: 0.0632
2025-04-09 12:30:56,419 - INFO - Epoch 2/3, Batch 2520/4933, Loss: 0.0450
2025-04-09 12:30:57,176 - INFO - Epoch 2/3, Batch 2560/4933, Loss: 0.0235
2025-04-09 12:30:57,950 - INFO - Epoch 2/3, Batch 2600/4933, Loss: 0.0620
2025-04-09 12:30:58,813 - INFO - Epoch 2/3, Batch 2640/4933, Loss: 0.0571
2025-04-09 12:30:59,743 - INFO - Epoch 2/3, Batch 2680/4933, Loss: 0.0500
2025-04-09 12:31:00,664 - INFO - Epoch 2/3, Batch 2720/4933, Loss: 0.0355
2025-04-09 12:31:01,576 - INFO - Epoch 2/3, Batch 2760/4933, Loss: 0.0531
2025-04-09 12:31:02,520 - INFO - Epoch 2/3, Batch 2800/4933, Loss: 0.0626
2025-04-09 12:31:03,489 - INFO - Epoch 2/3, Batch 2840/4933, Loss: 0.0277
2025-04-09 12:31:04,441 - INFO - Epoch 2/3, Batch 2880/4933, Loss: 0.0469
2025-04-09 12:31:05,434 - INFO - Epoch 2/3, Batch 2920/4933, Loss: 0.0120
2025-04-09 12:31:06,459 - INFO - Epoch 2/3, Batch 2960/4933, Loss: 0.0286
2025-04-09 12:31:07,485 - INFO - Epoch 2/3, Batch 3000/4933, Loss: 0.0569
2025-04-09 12:31:08,532 - INFO - Epoch 2/3, Batch 3040/4933, Loss: 0.0361
2025-04-09 12:31:09,577 - INFO - Epoch 2/3, Batch 3080/4933, Loss: 0.0149
2025-04-09 12:31:10,624 - INFO - Epoch 2/3, Batch 3120/4933, Loss: 0.0511
2025-04-09 12:31:11,694 - INFO - Epoch 2/3, Batch 3160/4933, Loss: 0.0487
2025-04-09 12:31:12,798 - INFO - Epoch 2/3, Batch 3200/4933, Loss: 0.0397
2025-04-09 12:31:13,949 - INFO - Epoch 2/3, Batch 3240/4933, Loss: 0.0355
2025-04-09 12:31:15,064 - INFO - Epoch 2/3, Batch 3280/4933, Loss: 0.0327
2025-04-09 12:31:16,111 - INFO - Epoch 2/3, Batch 3320/4933, Loss: 0.0446
2025-04-09 12:31:17,185 - INFO - Epoch 2/3, Batch 3360/4933, Loss: 0.0384
2025-04-09 12:31:18,275 - INFO - Epoch 2/3, Batch 3400/4933, Loss: 0.0224
2025-04-09 12:31:19,358 - INFO - Epoch 2/3, Batch 3440/4933, Loss: 0.0499
2025-04-09 12:31:20,447 - INFO - Epoch 2/3, Batch 3480/4933, Loss: 0.0693
2025-04-09 12:31:21,579 - INFO - Epoch 2/3, Batch 3520/4933, Loss: 0.0304
2025-04-09 12:31:22,691 - INFO - Epoch 2/3, Batch 3560/4933, Loss: 0.0765
2025-04-09 12:31:23,821 - INFO - Epoch 2/3, Batch 3600/4933, Loss: 0.0441
2025-04-09 12:31:24,952 - INFO - Epoch 2/3, Batch 3640/4933, Loss: 0.0235
2025-04-09 12:31:26,150 - INFO - Epoch 2/3, Batch 3680/4933, Loss: 0.0679
2025-04-09 12:31:27,366 - INFO - Epoch 2/3, Batch 3720/4933, Loss: 0.0428
2025-04-09 12:31:28,640 - INFO - Epoch 2/3, Batch 3760/4933, Loss: 0.0201
2025-04-09 12:31:29,896 - INFO - Epoch 2/3, Batch 3800/4933, Loss: 0.0222
2025-04-09 12:31:31,084 - INFO - Epoch 2/3, Batch 3840/4933, Loss: 0.0256
2025-04-09 12:31:32,274 - INFO - Epoch 2/3, Batch 3880/4933, Loss: 0.0837
2025-04-09 12:31:33,455 - INFO - Epoch 2/3, Batch 3920/4933, Loss: 0.0279
2025-04-09 12:31:34,714 - INFO - Epoch 2/3, Batch 3960/4933, Loss: 0.0764
2025-04-09 12:31:36,079 - INFO - Epoch 2/3, Batch 4000/4933, Loss: 0.0397
2025-04-09 12:31:37,538 - INFO - Epoch 2/3, Batch 4040/4933, Loss: 0.0663
2025-04-09 12:31:39,163 - INFO - Epoch 2/3, Batch 4080/4933, Loss: 0.1614
2025-04-09 12:31:40,640 - INFO - Epoch 2/3, Batch 4120/4933, Loss: 0.0114
2025-04-09 12:31:42,114 - INFO - Epoch 2/3, Batch 4160/4933, Loss: 0.0648
2025-04-09 12:31:43,601 - INFO - Epoch 2/3, Batch 4200/4933, Loss: 0.0098
2025-04-09 12:31:45,139 - INFO - Epoch 2/3, Batch 4240/4933, Loss: 0.0124
2025-04-09 12:31:46,693 - INFO - Epoch 2/3, Batch 4280/4933, Loss: 0.0901
2025-04-09 12:31:48,186 - INFO - Epoch 2/3, Batch 4320/4933, Loss: 0.0297
2025-04-09 12:31:49,759 - INFO - Epoch 2/3, Batch 4360/4933, Loss: 0.0575
2025-04-09 12:31:51,261 - INFO - Epoch 2/3, Batch 4400/4933, Loss: 0.0122
2025-04-09 12:31:52,729 - INFO - Epoch 2/3, Batch 4440/4933, Loss: 0.0429
2025-04-09 12:31:54,187 - INFO - Epoch 2/3, Batch 4480/4933, Loss: 0.0606
2025-04-09 12:31:55,677 - INFO - Epoch 2/3, Batch 4520/4933, Loss: 0.0262
2025-04-09 12:31:57,174 - INFO - Epoch 2/3, Batch 4560/4933, Loss: 0.0590
2025-04-09 12:31:58,673 - INFO - Epoch 2/3, Batch 4600/4933, Loss: 0.1016
2025-04-09 12:32:00,167 - INFO - Epoch 2/3, Batch 4640/4933, Loss: 0.0436
2025-04-09 12:32:01,662 - INFO - Epoch 2/3, Batch 4680/4933, Loss: 0.0185
2025-04-09 12:32:03,168 - INFO - Epoch 2/3, Batch 4720/4933, Loss: 0.0338
2025-04-09 12:32:04,716 - INFO - Epoch 2/3, Batch 4760/4933, Loss: 0.0198
2025-04-09 12:32:06,248 - INFO - Epoch 2/3, Batch 4800/4933, Loss: 0.0214
2025-04-09 12:32:07,761 - INFO - Epoch 2/3, Batch 4840/4933, Loss: 0.0078
2025-04-09 12:32:09,287 - INFO - Epoch 2/3, Batch 4880/4933, Loss: 0.0690
2025-04-09 12:32:10,830 - INFO - Epoch 2/3, Batch 4920/4933, Loss: 0.0718
2025-04-09 12:32:12,922 - INFO - Epoch 2/3, Validation mAP Action (sklearn): 0.5677
2025-04-09 12:32:12,922 - INFO - Epoch 2/3, Validation mAP Instrument (sklearn): 0.9825
2025-04-09 12:32:12,922 - INFO - Epoch 2/3, Train Loss: 0.0470
2025-04-09 12:32:21,307 - INFO - [TRAIN] instrument mean AP (ivt_metrics): 0.9739066541125004
2025-04-09 12:32:22,616 - INFO - [TRAIN] action mean AP (ivt_metrics): 0.5677210565331307
2025-04-09 12:32:22,616 - INFO - [TRAIN] Epoch 2/3, Train mAP Instrument (ivt metrics): 0.9739
2025-04-09 12:32:22,616 - INFO - [TRAIN] Epoch 2/3, Train mAP Action (ivt metrics): 0.5677
2025-04-09 12:32:22,804 - INFO - Video VID02 | Batch 0/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:22,977 - INFO - Video VID02 | Batch 40/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:23,153 - INFO - Video VID02 | Batch 80/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:23,310 - INFO - Video VID02 | Batch 120/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:23,490 - INFO - Video VID02 | Batch 160/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:23,643 - INFO - [TEST] Video VID02: Test mAP (sklearn) Action: 0.4723
2025-04-09 12:32:23,643 - INFO - [TEST] Video VID02: Test mAP (sklearn) Instrument: 0.9214
2025-04-09 12:32:23,839 - INFO - Video VID06 | Batch 0/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:24,001 - INFO - Video VID06 | Batch 40/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:24,173 - INFO - Video VID06 | Batch 80/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:24,344 - INFO - Video VID06 | Batch 120/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:24,486 - INFO - [TEST] Video VID06: Test mAP (sklearn) Action: 0.5409
2025-04-09 12:32:24,486 - INFO - [TEST] Video VID06: Test mAP (sklearn) Instrument: 0.9493
2025-04-09 12:32:24,690 - INFO - Video VID111 | Batch 0/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:24,861 - INFO - Video VID111 | Batch 40/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:25,043 - INFO - Video VID111 | Batch 80/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:25,220 - INFO - Video VID111 | Batch 120/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:25,361 - INFO - [TEST] Video VID111: Test mAP (sklearn) Action: 0.5217
2025-04-09 12:32:25,362 - INFO - [TEST] Video VID111: Test mAP (sklearn) Instrument: 0.9498
2025-04-09 12:32:25,573 - INFO - Video VID14 | Batch 0/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:25,739 - INFO - Video VID14 | Batch 40/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:25,910 - INFO - Video VID14 | Batch 80/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:26,098 - INFO - [TEST] Video VID14: Test mAP (sklearn) Action: 0.3740
2025-04-09 12:32:26,098 - INFO - [TEST] Video VID14: Test mAP (sklearn) Instrument: 0.8406
2025-04-09 12:32:26,307 - INFO - Video VID23 | Batch 0/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:26,464 - INFO - Video VID23 | Batch 40/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:26,622 - INFO - Video VID23 | Batch 80/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:26,772 - INFO - [TEST] Video VID23: Test mAP (sklearn) Action: 0.4474
2025-04-09 12:32:26,772 - INFO - [TEST] Video VID23: Test mAP (sklearn) Instrument: 0.8777
2025-04-09 12:32:26,963 - INFO - Video VID25 | Batch 0/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:27,117 - INFO - Video VID25 | Batch 40/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:27,276 - INFO - Video VID25 | Batch 80/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:27,441 - INFO - Video VID25 | Batch 120/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:27,561 - INFO - [TEST] Video VID25: Test mAP (sklearn) Action: 0.5763
2025-04-09 12:32:27,562 - INFO - [TEST] Video VID25: Test mAP (sklearn) Instrument: 0.9426
2025-04-09 12:32:27,742 - INFO - Video VID50 | Batch 0/69, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:27,891 - INFO - Video VID50 | Batch 40/69, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:28,064 - INFO - [TEST] Video VID50: Test mAP (sklearn) Action: 0.5496
2025-04-09 12:32:28,065 - INFO - [TEST] Video VID50: Test mAP (sklearn) Instrument: 0.9759
2025-04-09 12:32:28,242 - INFO - Video VID51 | Batch 0/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:28,393 - INFO - Video VID51 | Batch 40/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:28,552 - INFO - Video VID51 | Batch 80/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:28,710 - INFO - Video VID51 | Batch 120/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:28,876 - INFO - Video VID51 | Batch 160/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:29,047 - INFO - [TEST] Video VID51: Test mAP (sklearn) Action: 0.4941
2025-04-09 12:32:29,047 - INFO - [TEST] Video VID51: Test mAP (sklearn) Instrument: 0.9628
2025-04-09 12:32:29,228 - INFO - Video VID66 | Batch 0/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:29,385 - INFO - Video VID66 | Batch 40/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:29,547 - INFO - Video VID66 | Batch 80/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:29,742 - INFO - [TEST] Video VID66: Test mAP (sklearn) Action: 0.6118
2025-04-09 12:32:29,742 - INFO - [TEST] Video VID66: Test mAP (sklearn) Instrument: 0.9365
2025-04-09 12:32:29,926 - INFO - Video VID79 | Batch 0/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:30,078 - INFO - Video VID79 | Batch 40/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:30,249 - INFO - Video VID79 | Batch 80/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:30,416 - INFO - Video VID79 | Batch 120/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:30,589 - INFO - Video VID79 | Batch 160/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:30,763 - INFO - Video VID79 | Batch 200/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:32:30,897 - INFO - [TEST] Video VID79: Test mAP (sklearn) Action: 0.4196
2025-04-09 12:32:30,897 - INFO - [TEST] Video VID79: Test mAP (sklearn) Instrument: 0.9746
2025-04-09 12:32:33,591 - INFO - [TEST] Overall action mAP (sklearn): 0.5008
2025-04-09 12:32:33,592 - INFO - [TEST] Overall instrument mAP (sklearn): 0.9331
2025-04-09 12:32:33,592 - INFO - [TEST] Overall action mAP (ivt): 0.3772
2025-04-09 12:32:33,592 - INFO - [TEST] Overall instrument mAP (ivt): 0.9215
2025-04-09 12:32:33,592 - INFO - [TEST] Epoch 2: Validation mAP Action (sklearn): 0.5008
2025-04-09 12:32:33,592 - INFO - [TEST] Epoch 2: Validation mAP Instrument (sklearn): 0.9331
2025-04-09 12:32:33,592 - INFO - [TEST] Epoch 2: Validation mAP Action (ivt): 0.3772
2025-04-09 12:32:33,592 - INFO - [TEST] Epoch 2: Validation mAP Instrument (ivt): 0.9215
2025-04-09 12:32:33,702 - INFO - Saved new best model with mAP: 0.5008
2025-04-09 12:32:33,722 - INFO - Epoch 3/3, Batch 0/4933, Loss: 0.0224
2025-04-09 12:32:34,329 - INFO - Epoch 3/3, Batch 40/4933, Loss: 0.0676
2025-04-09 12:32:34,933 - INFO - Epoch 3/3, Batch 80/4933, Loss: 0.0132
2025-04-09 12:32:35,541 - INFO - Epoch 3/3, Batch 120/4933, Loss: 0.0184
2025-04-09 12:32:36,187 - INFO - Epoch 3/3, Batch 160/4933, Loss: 0.0647
2025-04-09 12:32:36,811 - INFO - Epoch 3/3, Batch 200/4933, Loss: 0.0562
2025-04-09 12:32:37,453 - INFO - Epoch 3/3, Batch 240/4933, Loss: 0.0334
2025-04-09 12:32:38,101 - INFO - Epoch 3/3, Batch 280/4933, Loss: 0.0092
2025-04-09 12:32:38,735 - INFO - Epoch 3/3, Batch 320/4933, Loss: 0.0568
2025-04-09 12:32:39,369 - INFO - Epoch 3/3, Batch 360/4933, Loss: 0.0329
2025-04-09 12:32:40,007 - INFO - Epoch 3/3, Batch 400/4933, Loss: 0.0709
2025-04-09 12:32:40,652 - INFO - Epoch 3/3, Batch 440/4933, Loss: 0.0118
2025-04-09 12:32:41,313 - INFO - Epoch 3/3, Batch 480/4933, Loss: 0.0518
2025-04-09 12:32:41,969 - INFO - Epoch 3/3, Batch 520/4933, Loss: 0.0197
2025-04-09 12:32:42,629 - INFO - Epoch 3/3, Batch 560/4933, Loss: 0.0358
2025-04-09 12:32:43,288 - INFO - Epoch 3/3, Batch 600/4933, Loss: 0.0352
2025-04-09 12:32:43,955 - INFO - Epoch 3/3, Batch 640/4933, Loss: 0.0785
2025-04-09 12:32:44,628 - INFO - Epoch 3/3, Batch 680/4933, Loss: 0.0299
2025-04-09 12:32:45,300 - INFO - Epoch 3/3, Batch 720/4933, Loss: 0.0570
2025-04-09 12:32:45,977 - INFO - Epoch 3/3, Batch 760/4933, Loss: 0.0732
2025-04-09 12:32:46,667 - INFO - Epoch 3/3, Batch 800/4933, Loss: 0.0334
2025-04-09 12:32:47,360 - INFO - Epoch 3/3, Batch 840/4933, Loss: 0.0655
2025-04-09 12:32:48,054 - INFO - Epoch 3/3, Batch 880/4933, Loss: 0.0190
2025-04-09 12:32:48,744 - INFO - Epoch 3/3, Batch 920/4933, Loss: 0.0257
2025-04-09 12:32:49,438 - INFO - Epoch 3/3, Batch 960/4933, Loss: 0.0193
2025-04-09 12:32:50,125 - INFO - Epoch 3/3, Batch 1000/4933, Loss: 0.0167
2025-04-09 12:32:50,840 - INFO - Epoch 3/3, Batch 1040/4933, Loss: 0.0270
2025-04-09 12:32:51,525 - INFO - Epoch 3/3, Batch 1080/4933, Loss: 0.0248
2025-04-09 12:32:52,183 - INFO - Epoch 3/3, Batch 1120/4933, Loss: 0.0464
2025-04-09 12:32:52,869 - INFO - Epoch 3/3, Batch 1160/4933, Loss: 0.0327
2025-04-09 12:32:53,540 - INFO - Epoch 3/3, Batch 1200/4933, Loss: 0.1155
2025-04-09 12:32:54,216 - INFO - Epoch 3/3, Batch 1240/4933, Loss: 0.0225
2025-04-09 12:32:54,900 - INFO - Epoch 3/3, Batch 1280/4933, Loss: 0.0453
2025-04-09 12:32:55,581 - INFO - Epoch 3/3, Batch 1320/4933, Loss: 0.0755
2025-04-09 12:32:56,267 - INFO - Epoch 3/3, Batch 1360/4933, Loss: 0.0554
2025-04-09 12:32:56,953 - INFO - Epoch 3/3, Batch 1400/4933, Loss: 0.0603
2025-04-09 12:32:57,644 - INFO - Epoch 3/3, Batch 1440/4933, Loss: 0.0200
2025-04-09 12:32:58,333 - INFO - Epoch 3/3, Batch 1480/4933, Loss: 0.0237
2025-04-09 12:32:59,032 - INFO - Epoch 3/3, Batch 1520/4933, Loss: 0.0144
2025-04-09 12:32:59,742 - INFO - Epoch 3/3, Batch 1560/4933, Loss: 0.0914
2025-04-09 12:33:00,450 - INFO - Epoch 3/3, Batch 1600/4933, Loss: 0.0408
2025-04-09 12:33:01,176 - INFO - Epoch 3/3, Batch 1640/4933, Loss: 0.0754
2025-04-09 12:33:01,888 - INFO - Epoch 3/3, Batch 1680/4933, Loss: 0.0407
2025-04-09 12:33:02,659 - INFO - Epoch 3/3, Batch 1720/4933, Loss: 0.0210
2025-04-09 12:33:03,394 - INFO - Epoch 3/3, Batch 1760/4933, Loss: 0.0586
2025-04-09 12:33:04,115 - INFO - Epoch 3/3, Batch 1800/4933, Loss: 0.0405
2025-04-09 12:33:04,841 - INFO - Epoch 3/3, Batch 1840/4933, Loss: 0.0468
2025-04-09 12:33:05,568 - INFO - Epoch 3/3, Batch 1880/4933, Loss: 0.0321
2025-04-09 12:33:06,300 - INFO - Epoch 3/3, Batch 1920/4933, Loss: 0.0422
2025-04-09 12:33:07,022 - INFO - Epoch 3/3, Batch 1960/4933, Loss: 0.0556
2025-04-09 12:33:07,751 - INFO - Epoch 3/3, Batch 2000/4933, Loss: 0.0476
2025-04-09 12:33:08,483 - INFO - Epoch 3/3, Batch 2040/4933, Loss: 0.0692
2025-04-09 12:33:09,208 - INFO - Epoch 3/3, Batch 2080/4933, Loss: 0.0224
2025-04-09 12:33:09,938 - INFO - Epoch 3/3, Batch 2120/4933, Loss: 0.1240
2025-04-09 12:33:10,678 - INFO - Epoch 3/3, Batch 2160/4933, Loss: 0.0189
2025-04-09 12:33:11,429 - INFO - Epoch 3/3, Batch 2200/4933, Loss: 0.0328
2025-04-09 12:33:12,170 - INFO - Epoch 3/3, Batch 2240/4933, Loss: 0.0461
2025-04-09 12:33:12,915 - INFO - Epoch 3/3, Batch 2280/4933, Loss: 0.0364
2025-04-09 12:33:13,661 - INFO - Epoch 3/3, Batch 2320/4933, Loss: 0.0221
2025-04-09 12:33:14,409 - INFO - Epoch 3/3, Batch 2360/4933, Loss: 0.0282
2025-04-09 12:33:15,155 - INFO - Epoch 3/3, Batch 2400/4933, Loss: 0.0263
2025-04-09 12:33:15,905 - INFO - Epoch 3/3, Batch 2440/4933, Loss: 0.0648
2025-04-09 12:33:16,661 - INFO - Epoch 3/3, Batch 2480/4933, Loss: 0.0535
2025-04-09 12:33:17,433 - INFO - Epoch 3/3, Batch 2520/4933, Loss: 0.0554
2025-04-09 12:33:18,196 - INFO - Epoch 3/3, Batch 2560/4933, Loss: 0.0289
2025-04-09 12:33:18,951 - INFO - Epoch 3/3, Batch 2600/4933, Loss: 0.0190
2025-04-09 12:33:19,817 - INFO - Epoch 3/3, Batch 2640/4933, Loss: 0.0924
2025-04-09 12:33:20,782 - INFO - Epoch 3/3, Batch 2680/4933, Loss: 0.1207
2025-04-09 12:33:21,753 - INFO - Epoch 3/3, Batch 2720/4933, Loss: 0.1247
2025-04-09 12:33:22,747 - INFO - Epoch 3/3, Batch 2760/4933, Loss: 0.0166
2025-04-09 12:33:23,729 - INFO - Epoch 3/3, Batch 2800/4933, Loss: 0.0081
2025-04-09 12:33:24,706 - INFO - Epoch 3/3, Batch 2840/4933, Loss: 0.0317
2025-04-09 12:33:25,723 - INFO - Epoch 3/3, Batch 2880/4933, Loss: 0.0664
2025-04-09 12:33:26,749 - INFO - Epoch 3/3, Batch 2920/4933, Loss: 0.0194
2025-04-09 12:33:27,776 - INFO - Epoch 3/3, Batch 2960/4933, Loss: 0.0087
2025-04-09 12:33:28,794 - INFO - Epoch 3/3, Batch 3000/4933, Loss: 0.0169
2025-04-09 12:33:29,823 - INFO - Epoch 3/3, Batch 3040/4933, Loss: 0.0248
2025-04-09 12:33:30,857 - INFO - Epoch 3/3, Batch 3080/4933, Loss: 0.0247
2025-04-09 12:33:31,908 - INFO - Epoch 3/3, Batch 3120/4933, Loss: 0.0108
2025-04-09 12:33:32,955 - INFO - Epoch 3/3, Batch 3160/4933, Loss: 0.0605
2025-04-09 12:33:34,011 - INFO - Epoch 3/3, Batch 3200/4933, Loss: 0.0363
2025-04-09 12:33:35,072 - INFO - Epoch 3/3, Batch 3240/4933, Loss: 0.0497
2025-04-09 12:33:36,135 - INFO - Epoch 3/3, Batch 3280/4933, Loss: 0.0358
2025-04-09 12:33:37,187 - INFO - Epoch 3/3, Batch 3320/4933, Loss: 0.0801
2025-04-09 12:33:38,265 - INFO - Epoch 3/3, Batch 3360/4933, Loss: 0.0288
2025-04-09 12:33:39,346 - INFO - Epoch 3/3, Batch 3400/4933, Loss: 0.0612
2025-04-09 12:33:40,461 - INFO - Epoch 3/3, Batch 3440/4933, Loss: 0.0630
2025-04-09 12:33:41,560 - INFO - Epoch 3/3, Batch 3480/4933, Loss: 0.0325
2025-04-09 12:33:42,799 - INFO - Epoch 3/3, Batch 3520/4933, Loss: 0.0209
2025-04-09 12:33:44,072 - INFO - Epoch 3/3, Batch 3560/4933, Loss: 0.1075
2025-04-09 12:33:45,314 - INFO - Epoch 3/3, Batch 3600/4933, Loss: 0.0216
2025-04-09 12:33:46,556 - INFO - Epoch 3/3, Batch 3640/4933, Loss: 0.0184
2025-04-09 12:33:47,824 - INFO - Epoch 3/3, Batch 3680/4933, Loss: 0.0803
2025-04-09 12:33:49,090 - INFO - Epoch 3/3, Batch 3720/4933, Loss: 0.0760
2025-04-09 12:33:50,365 - INFO - Epoch 3/3, Batch 3760/4933, Loss: 0.0173
2025-04-09 12:33:51,623 - INFO - Epoch 3/3, Batch 3800/4933, Loss: 0.0203
2025-04-09 12:33:52,887 - INFO - Epoch 3/3, Batch 3840/4933, Loss: 0.0129
2025-04-09 12:33:54,195 - INFO - Epoch 3/3, Batch 3880/4933, Loss: 0.0194
2025-04-09 12:33:55,562 - INFO - Epoch 3/3, Batch 3920/4933, Loss: 0.0189
2025-04-09 12:33:56,927 - INFO - Epoch 3/3, Batch 3960/4933, Loss: 0.0423
2025-04-09 12:33:58,412 - INFO - Epoch 3/3, Batch 4000/4933, Loss: 0.0523
2025-04-09 12:33:59,942 - INFO - Epoch 3/3, Batch 4040/4933, Loss: 0.0065
2025-04-09 12:34:01,487 - INFO - Epoch 3/3, Batch 4080/4933, Loss: 0.0324
2025-04-09 12:34:03,036 - INFO - Epoch 3/3, Batch 4120/4933, Loss: 0.0164
2025-04-09 12:34:04,577 - INFO - Epoch 3/3, Batch 4160/4933, Loss: 0.0370
2025-04-09 12:34:06,109 - INFO - Epoch 3/3, Batch 4200/4933, Loss: 0.0532
2025-04-09 12:34:07,661 - INFO - Epoch 3/3, Batch 4240/4933, Loss: 0.0391
2025-04-09 12:34:09,253 - INFO - Epoch 3/3, Batch 4280/4933, Loss: 0.0575
2025-04-09 12:34:10,818 - INFO - Epoch 3/3, Batch 4320/4933, Loss: 0.0497
2025-04-09 12:34:12,395 - INFO - Epoch 3/3, Batch 4360/4933, Loss: 0.0255
2025-04-09 12:34:13,996 - INFO - Epoch 3/3, Batch 4400/4933, Loss: 0.0402
2025-04-09 12:34:15,544 - INFO - Epoch 3/3, Batch 4440/4933, Loss: 0.0341
2025-04-09 12:34:17,172 - INFO - Epoch 3/3, Batch 4480/4933, Loss: 0.0277
2025-04-09 12:34:18,728 - INFO - Epoch 3/3, Batch 4520/4933, Loss: 0.0356
2025-04-09 12:34:20,329 - INFO - Epoch 3/3, Batch 4560/4933, Loss: 0.0567
2025-04-09 12:34:21,894 - INFO - Epoch 3/3, Batch 4600/4933, Loss: 0.0205
2025-04-09 12:34:23,513 - INFO - Epoch 3/3, Batch 4640/4933, Loss: 0.0699
2025-04-09 12:34:25,174 - INFO - Epoch 3/3, Batch 4680/4933, Loss: 0.0829
2025-04-09 12:34:26,850 - INFO - Epoch 3/3, Batch 4720/4933, Loss: 0.0195
2025-04-09 12:34:28,470 - INFO - Epoch 3/3, Batch 4760/4933, Loss: 0.0174
2025-04-09 12:34:30,115 - INFO - Epoch 3/3, Batch 4800/4933, Loss: 0.0536
2025-04-09 12:34:31,772 - INFO - Epoch 3/3, Batch 4840/4933, Loss: 0.0133
2025-04-09 12:34:33,450 - INFO - Epoch 3/3, Batch 4880/4933, Loss: 0.0187
2025-04-09 12:34:35,130 - INFO - Epoch 3/3, Batch 4920/4933, Loss: 0.0101
2025-04-09 12:34:37,200 - INFO - Epoch 3/3, Validation mAP Action (sklearn): 0.6689
2025-04-09 12:34:37,200 - INFO - Epoch 3/3, Validation mAP Instrument (sklearn): 0.9861
2025-04-09 12:34:37,201 - INFO - Epoch 3/3, Train Loss: 0.0422
2025-04-09 12:34:45,956 - INFO - [TRAIN] instrument mean AP (ivt_metrics): 0.979080442306023
2025-04-09 12:34:47,249 - INFO - [TRAIN] action mean AP (ivt_metrics): 0.6689243790592171
2025-04-09 12:34:47,249 - INFO - [TRAIN] Epoch 3/3, Train mAP Instrument (ivt metrics): 0.9791
2025-04-09 12:34:47,249 - INFO - [TRAIN] Epoch 3/3, Train mAP Action (ivt metrics): 0.6689
2025-04-09 12:34:47,438 - INFO - Video VID02 | Batch 0/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:47,617 - INFO - Video VID02 | Batch 40/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:47,781 - INFO - Video VID02 | Batch 80/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:47,943 - INFO - Video VID02 | Batch 120/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:48,111 - INFO - Video VID02 | Batch 160/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:48,258 - INFO - [TEST] Video VID02: Test mAP (sklearn) Action: 0.4643
2025-04-09 12:34:48,258 - INFO - [TEST] Video VID02: Test mAP (sklearn) Instrument: 0.9414
2025-04-09 12:34:48,439 - INFO - Video VID06 | Batch 0/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:48,588 - INFO - Video VID06 | Batch 40/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:48,749 - INFO - Video VID06 | Batch 80/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:48,912 - INFO - Video VID06 | Batch 120/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:49,040 - INFO - [TEST] Video VID06: Test mAP (sklearn) Action: 0.5440
2025-04-09 12:34:49,040 - INFO - [TEST] Video VID06: Test mAP (sklearn) Instrument: 0.9553
2025-04-09 12:34:49,219 - INFO - Video VID111 | Batch 0/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:49,379 - INFO - Video VID111 | Batch 40/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:49,535 - INFO - Video VID111 | Batch 80/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:49,690 - INFO - Video VID111 | Batch 120/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:49,817 - INFO - [TEST] Video VID111: Test mAP (sklearn) Action: 0.5074
2025-04-09 12:34:49,817 - INFO - [TEST] Video VID111: Test mAP (sklearn) Instrument: 0.9615
2025-04-09 12:34:49,999 - INFO - Video VID14 | Batch 0/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:50,156 - INFO - Video VID14 | Batch 40/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:50,327 - INFO - Video VID14 | Batch 80/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:50,519 - INFO - [TEST] Video VID14: Test mAP (sklearn) Action: 0.3614
2025-04-09 12:34:50,520 - INFO - [TEST] Video VID14: Test mAP (sklearn) Instrument: 0.8410
2025-04-09 12:34:50,733 - INFO - Video VID23 | Batch 0/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:50,893 - INFO - Video VID23 | Batch 40/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:51,055 - INFO - Video VID23 | Batch 80/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:51,207 - INFO - [TEST] Video VID23: Test mAP (sklearn) Action: 0.4595
2025-04-09 12:34:51,207 - INFO - [TEST] Video VID23: Test mAP (sklearn) Instrument: 0.8687
2025-04-09 12:34:51,403 - INFO - Video VID25 | Batch 0/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:51,558 - INFO - Video VID25 | Batch 40/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:51,718 - INFO - Video VID25 | Batch 80/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:51,879 - INFO - Video VID25 | Batch 120/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:52,002 - INFO - [TEST] Video VID25: Test mAP (sklearn) Action: 0.5825
2025-04-09 12:34:52,002 - INFO - [TEST] Video VID25: Test mAP (sklearn) Instrument: 0.9549
2025-04-09 12:34:52,179 - INFO - Video VID50 | Batch 0/69, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:52,336 - INFO - Video VID50 | Batch 40/69, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:52,516 - INFO - [TEST] Video VID50: Test mAP (sklearn) Action: 0.5570
2025-04-09 12:34:52,516 - INFO - [TEST] Video VID50: Test mAP (sklearn) Instrument: 0.9812
2025-04-09 12:34:52,703 - INFO - Video VID51 | Batch 0/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:52,863 - INFO - Video VID51 | Batch 40/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:53,019 - INFO - Video VID51 | Batch 80/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:53,175 - INFO - Video VID51 | Batch 120/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:53,345 - INFO - Video VID51 | Batch 160/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:53,520 - INFO - [TEST] Video VID51: Test mAP (sklearn) Action: 0.4884
2025-04-09 12:34:53,520 - INFO - [TEST] Video VID51: Test mAP (sklearn) Instrument: 0.9643
2025-04-09 12:34:53,703 - INFO - Video VID66 | Batch 0/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:53,862 - INFO - Video VID66 | Batch 40/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:54,021 - INFO - Video VID66 | Batch 80/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:54,218 - INFO - [TEST] Video VID66: Test mAP (sklearn) Action: 0.6144
2025-04-09 12:34:54,218 - INFO - [TEST] Video VID66: Test mAP (sklearn) Instrument: 0.9473
2025-04-09 12:34:54,401 - INFO - Video VID79 | Batch 0/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:54,553 - INFO - Video VID79 | Batch 40/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:54,713 - INFO - Video VID79 | Batch 80/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:54,871 - INFO - Video VID79 | Batch 120/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:55,038 - INFO - Video VID79 | Batch 160/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:55,207 - INFO - Video VID79 | Batch 200/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:55,346 - INFO - [TEST] Video VID79: Test mAP (sklearn) Action: 0.4043
2025-04-09 12:34:55,346 - INFO - [TEST] Video VID79: Test mAP (sklearn) Instrument: 0.9782
2025-04-09 12:34:58,030 - INFO - [TEST] Overall action mAP (sklearn): 0.4983
2025-04-09 12:34:58,030 - INFO - [TEST] Overall instrument mAP (sklearn): 0.9394
2025-04-09 12:34:58,030 - INFO - [TEST] Overall action mAP (ivt): 0.3645
2025-04-09 12:34:58,030 - INFO - [TEST] Overall instrument mAP (ivt): 0.9272
2025-04-09 12:34:58,030 - INFO - [TEST] Epoch 3: Validation mAP Action (sklearn): 0.4983
2025-04-09 12:34:58,030 - INFO - [TEST] Epoch 3: Validation mAP Instrument (sklearn): 0.9394
2025-04-09 12:34:58,030 - INFO - [TEST] Epoch 3: Validation mAP Action (ivt): 0.3645
2025-04-09 12:34:58,030 - INFO - [TEST] Epoch 3: Validation mAP Instrument (ivt): 0.9272
2025-04-09 12:34:58,087 - INFO - Loaded best model with mAP: 0.5008
2025-04-09 12:34:58,128 - INFO - Saved trained model to saved_models/recognition_head_20250409_123458.pt
2025-04-09 12:34:58,128 - INFO - Running inference and evaluation...
2025-04-09 12:34:58,316 - INFO - Video VID02 | Batch 0/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:58,497 - INFO - Video VID02 | Batch 40/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:58,675 - INFO - Video VID02 | Batch 80/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:58,836 - INFO - Video VID02 | Batch 120/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:59,002 - INFO - Video VID02 | Batch 160/178, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:59,146 - INFO - [TEST] Video VID02: Test mAP (sklearn) Action: 0.4723
2025-04-09 12:34:59,146 - INFO - [TEST] Video VID02: Test mAP (sklearn) Instrument: 0.9214
2025-04-09 12:34:59,334 - INFO - Video VID06 | Batch 0/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:59,485 - INFO - Video VID06 | Batch 40/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:59,649 - INFO - Video VID06 | Batch 80/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:59,805 - INFO - Video VID06 | Batch 120/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:34:59,934 - INFO - [TEST] Video VID06: Test mAP (sklearn) Action: 0.5409
2025-04-09 12:34:59,934 - INFO - [TEST] Video VID06: Test mAP (sklearn) Instrument: 0.9493
2025-04-09 12:35:00,123 - INFO - Video VID111 | Batch 0/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:00,281 - INFO - Video VID111 | Batch 40/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:00,440 - INFO - Video VID111 | Batch 80/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:00,608 - INFO - Video VID111 | Batch 120/135, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:00,738 - INFO - [TEST] Video VID111: Test mAP (sklearn) Action: 0.5217
2025-04-09 12:35:00,738 - INFO - [TEST] Video VID111: Test mAP (sklearn) Instrument: 0.9498
2025-04-09 12:35:00,933 - INFO - Video VID14 | Batch 0/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:01,094 - INFO - Video VID14 | Batch 40/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:01,258 - INFO - Video VID14 | Batch 80/107, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:01,466 - INFO - [TEST] Video VID14: Test mAP (sklearn) Action: 0.3740
2025-04-09 12:35:01,467 - INFO - [TEST] Video VID14: Test mAP (sklearn) Instrument: 0.8406
2025-04-09 12:35:01,675 - INFO - Video VID23 | Batch 0/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:01,839 - INFO - Video VID23 | Batch 40/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:02,010 - INFO - Video VID23 | Batch 80/103, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:02,169 - INFO - [TEST] Video VID23: Test mAP (sklearn) Action: 0.4474
2025-04-09 12:35:02,169 - INFO - [TEST] Video VID23: Test mAP (sklearn) Instrument: 0.8777
2025-04-09 12:35:02,353 - INFO - Video VID25 | Batch 0/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:02,512 - INFO - Video VID25 | Batch 40/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:02,678 - INFO - Video VID25 | Batch 80/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:02,832 - INFO - Video VID25 | Batch 120/134, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:02,954 - INFO - [TEST] Video VID25: Test mAP (sklearn) Action: 0.5763
2025-04-09 12:35:02,954 - INFO - [TEST] Video VID25: Test mAP (sklearn) Instrument: 0.9426
2025-04-09 12:35:03,137 - INFO - Video VID50 | Batch 0/69, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:03,292 - INFO - Video VID50 | Batch 40/69, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:03,461 - INFO - [TEST] Video VID50: Test mAP (sklearn) Action: 0.5496
2025-04-09 12:35:03,461 - INFO - [TEST] Video VID50: Test mAP (sklearn) Instrument: 0.9759
2025-04-09 12:35:03,645 - INFO - Video VID51 | Batch 0/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:03,808 - INFO - Video VID51 | Batch 40/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:03,967 - INFO - Video VID51 | Batch 80/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:04,122 - INFO - Video VID51 | Batch 120/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:04,282 - INFO - Video VID51 | Batch 160/184, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:04,457 - INFO - [TEST] Video VID51: Test mAP (sklearn) Action: 0.4941
2025-04-09 12:35:04,457 - INFO - [TEST] Video VID51: Test mAP (sklearn) Instrument: 0.9628
2025-04-09 12:35:04,646 - INFO - Video VID66 | Batch 0/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:04,799 - INFO - Video VID66 | Batch 40/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:04,956 - INFO - Video VID66 | Batch 80/114, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:05,158 - INFO - [TEST] Video VID66: Test mAP (sklearn) Action: 0.6118
2025-04-09 12:35:05,158 - INFO - [TEST] Video VID66: Test mAP (sklearn) Instrument: 0.9365
2025-04-09 12:35:05,347 - INFO - Video VID79 | Batch 0/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:05,500 - INFO - Video VID79 | Batch 40/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:05,658 - INFO - Video VID79 | Batch 80/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:05,818 - INFO - Video VID79 | Batch 120/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:05,992 - INFO - Video VID79 | Batch 160/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:06,165 - INFO - Video VID79 | Batch 200/214, Predictions: torch.Size([16, 100]), Targets: torch.Size([16, 100])
2025-04-09 12:35:06,299 - INFO - [TEST] Video VID79: Test mAP (sklearn) Action: 0.4196
2025-04-09 12:35:06,299 - INFO - [TEST] Video VID79: Test mAP (sklearn) Instrument: 0.9746
2025-04-09 12:35:09,049 - INFO - [TEST] Overall action mAP (sklearn): 0.5008
2025-04-09 12:35:09,049 - INFO - [TEST] Overall instrument mAP (sklearn): 0.9331
2025-04-09 12:35:09,049 - INFO - [TEST] Overall action mAP (ivt): 0.3772
2025-04-09 12:35:09,049 - INFO - [TEST] Overall instrument mAP (ivt): 0.9215
2025-04-09 12:35:09,050 - INFO - [TEST] Test mAP Action (sklearn): 0.5008
2025-04-09 12:35:09,050 - INFO - [TEST] Test mAP Instrument (sklearn): 0.9331
2025-04-09 12:35:09,050 - INFO - [TEST] Test mAP Action (ivt): 0.3772
2025-04-09 12:35:09,050 - INFO - [TEST] Test mAP Instrument (ivt): 0.9215
2025-04-09 12:35:09,050 - INFO - Results: {'sklearn_mAP_a': 0.5008, 'sklearn_mAP_i': 0.9331, 'ivt_mAP_a': 0.3772, 'ivt_mAP_i': 0.9215}
