2025-06-03 20:36:25,854 - INFO - SuRL_139967289575936 - Shared experiment log directory: logs/2025-06-03_20-36
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - 🚀 SURGICAL RL COMPARISON INITIALIZED
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - Method 1: Imitation Learning (Baseline)
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - Method 2: RL with World Model Simulation
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - Method 3: RL with Offline Video Episodes
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - Device: cuda
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - Results will be saved to: logs/2025-06-03_20-36/surgical_rl_results
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - STEP 1: LOADING DATASET
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 20:36:25,856 - INFO - SuRL_139967289575936 - Loading train data from /nfs/home/mboels/datasets/CholecT50 with fold 0
2025-06-03 20:36:27,398 - INFO - SuRL_139967289575936 - [Train] Start processing metadata file /nfs/home/mboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 20:36:27,398 - INFO - SuRL_139967289575936 - [Train] Rewards extraction skipped, using metadata file /nfs/home/mboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 20:36:27,403 - INFO - SuRL_139967289575936 - [Train] Found 40 videos in metadata file
2025-06-03 20:36:27,403 - INFO - SuRL_139967289575936 - [Train] Loading data for 40 videos
2025-06-03 20:37:47,302 - INFO - SuRL_139967289575936 - Loading test data from /nfs/home/mboels/datasets/CholecT50 with fold 0
2025-06-03 20:37:47,757 - INFO - SuRL_139967289575936 - [Test] Start processing metadata file /nfs/home/mboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 20:37:47,758 - INFO - SuRL_139967289575936 - [Test] Rewards extraction skipped, using metadata file /nfs/home/mboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 20:37:47,759 - INFO - SuRL_139967289575936 - [Test] Found 10 videos in metadata file
2025-06-03 20:37:47,759 - INFO - SuRL_139967289575936 - [Test] Loading data for 10 videos
2025-06-03 20:38:07,278 - INFO - SuRL_139967289575936 - ✅ Loaded 40 training videos and 10 test videos
2025-06-03 20:38:07,279 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 20:38:07,280 - INFO - SuRL_139967289575936 - STEP 2: METHOD 1 - IMITATION LEARNING BASELINE
2025-06-03 20:38:07,280 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 20:38:07,280 - INFO - SuRL_139967289575936 - 🎓 Training Imitation Learning Baseline...
2025-06-03 20:38:07,280 - INFO - SuRL_139967289575936 - 📋 Approach: Supervised learning on expert demonstrations
2025-06-03 20:38:32,931 - INFO - SuRL_139967289575936 - Starting the Imitation Learning training for autoregressive action prediction
2025-06-03 20:38:34,593 - INFO - SuRL_139967289575936 - Batch 0/4933 | Loss: 3.2355
2025-06-03 20:38:38,094 - INFO - SuRL_139967289575936 - Batch 100/4933 | Loss: 0.8056
2025-06-03 20:38:41,419 - INFO - SuRL_139967289575936 - Batch 200/4933 | Loss: 0.5615
2025-06-03 20:38:44,768 - INFO - SuRL_139967289575936 - Batch 300/4933 | Loss: 0.5676
2025-06-03 20:38:48,441 - INFO - SuRL_139967289575936 - Batch 400/4933 | Loss: 0.5626
2025-06-03 20:38:52,069 - INFO - SuRL_139967289575936 - Batch 500/4933 | Loss: 0.4033
2025-06-03 20:38:55,619 - INFO - SuRL_139967289575936 - Batch 600/4933 | Loss: 0.4680
2025-06-03 20:38:59,214 - INFO - SuRL_139967289575936 - Batch 700/4933 | Loss: 0.3856
2025-06-03 20:39:02,610 - INFO - SuRL_139967289575936 - Batch 800/4933 | Loss: 0.3523
2025-06-03 20:39:06,061 - INFO - SuRL_139967289575936 - Batch 900/4933 | Loss: 0.2948
2025-06-03 20:39:09,406 - INFO - SuRL_139967289575936 - Batch 1000/4933 | Loss: 0.3657
2025-06-03 20:39:12,835 - INFO - SuRL_139967289575936 - Batch 1100/4933 | Loss: 0.2373
2025-06-03 20:39:16,353 - INFO - SuRL_139967289575936 - Batch 1200/4933 | Loss: 0.3108
2025-06-03 20:39:19,743 - INFO - SuRL_139967289575936 - Batch 1300/4933 | Loss: 0.4467
2025-06-03 20:39:23,045 - INFO - SuRL_139967289575936 - Batch 1400/4933 | Loss: 0.2635
2025-06-03 20:39:26,428 - INFO - SuRL_139967289575936 - Batch 1500/4933 | Loss: 0.2302
2025-06-03 20:39:29,810 - INFO - SuRL_139967289575936 - Batch 1600/4933 | Loss: 0.3083
2025-06-03 20:39:33,203 - INFO - SuRL_139967289575936 - Batch 1700/4933 | Loss: 0.2233
2025-06-03 20:39:36,646 - INFO - SuRL_139967289575936 - Batch 1800/4933 | Loss: 0.2382
2025-06-03 20:39:39,965 - INFO - SuRL_139967289575936 - Batch 1900/4933 | Loss: 0.2206
2025-06-03 20:39:43,255 - INFO - SuRL_139967289575936 - Batch 2000/4933 | Loss: 0.2320
2025-06-03 20:39:46,726 - INFO - SuRL_139967289575936 - Batch 2100/4933 | Loss: 0.2379
2025-06-03 20:39:50,230 - INFO - SuRL_139967289575936 - Batch 2200/4933 | Loss: 0.3813
2025-06-03 20:39:53,671 - INFO - SuRL_139967289575936 - Batch 2300/4933 | Loss: 0.2265
2025-06-03 20:39:57,264 - INFO - SuRL_139967289575936 - Batch 2400/4933 | Loss: 0.2232
2025-06-03 20:40:00,690 - INFO - SuRL_139967289575936 - Batch 2500/4933 | Loss: 0.3504
2025-06-03 20:40:04,049 - INFO - SuRL_139967289575936 - Batch 2600/4933 | Loss: 0.2675
2025-06-03 20:40:07,500 - INFO - SuRL_139967289575936 - Batch 2700/4933 | Loss: 0.1881
2025-06-03 20:40:11,227 - INFO - SuRL_139967289575936 - Batch 2800/4933 | Loss: 0.2263
2025-06-03 20:40:15,010 - INFO - SuRL_139967289575936 - Batch 2900/4933 | Loss: 0.2039
2025-06-03 20:40:18,469 - INFO - SuRL_139967289575936 - Batch 3000/4933 | Loss: 0.2400
2025-06-03 20:40:21,826 - INFO - SuRL_139967289575936 - Batch 3100/4933 | Loss: 0.2745
2025-06-03 20:40:25,318 - INFO - SuRL_139967289575936 - Batch 3200/4933 | Loss: 0.2331
2025-06-03 20:40:29,086 - INFO - SuRL_139967289575936 - Batch 3300/4933 | Loss: 0.1943
2025-06-03 20:40:32,759 - INFO - SuRL_139967289575936 - Batch 3400/4933 | Loss: 0.2272
2025-06-03 20:40:36,340 - INFO - SuRL_139967289575936 - Batch 3500/4933 | Loss: 0.2051
2025-06-03 20:40:39,974 - INFO - SuRL_139967289575936 - Batch 3600/4933 | Loss: 0.2272
2025-06-03 20:40:43,671 - INFO - SuRL_139967289575936 - Batch 3700/4933 | Loss: 0.1986
2025-06-03 20:40:47,545 - INFO - SuRL_139967289575936 - Batch 3800/4933 | Loss: 0.2037
2025-06-03 20:40:51,083 - INFO - SuRL_139967289575936 - Batch 3900/4933 | Loss: 0.1740
2025-06-03 20:40:54,707 - INFO - SuRL_139967289575936 - Batch 4000/4933 | Loss: 0.2595
2025-06-03 20:40:58,276 - INFO - SuRL_139967289575936 - Batch 4100/4933 | Loss: 0.1603
2025-06-03 20:41:01,710 - INFO - SuRL_139967289575936 - Batch 4200/4933 | Loss: 0.2096
2025-06-03 20:41:05,292 - INFO - SuRL_139967289575936 - Batch 4300/4933 | Loss: 0.2179
2025-06-03 20:41:08,843 - INFO - SuRL_139967289575936 - Batch 4400/4933 | Loss: 0.1767
2025-06-03 20:41:12,438 - INFO - SuRL_139967289575936 - Batch 4500/4933 | Loss: 0.2023
2025-06-03 20:41:16,113 - INFO - SuRL_139967289575936 - Batch 4600/4933 | Loss: 0.2213
2025-06-03 20:41:19,735 - INFO - SuRL_139967289575936 - Batch 4700/4933 | Loss: 0.1685
2025-06-03 20:41:23,211 - INFO - SuRL_139967289575936 - Batch 4800/4933 | Loss: 0.1925
2025-06-03 20:41:26,690 - INFO - SuRL_139967289575936 - Batch 4900/4933 | Loss: 0.1734
2025-06-03 21:08:31,410 - INFO - SuRL_139967289575936 - New best model saved: logs/2025-06-03_20-36/checkpoints/supervised_best_epoch_1.pt
2025-06-03 21:08:31,411 - INFO - SuRL_139967289575936 - Epoch 1/3 | Train Loss: 0.3115 | Val Loss: 0.2007 | Val Action Acc: 0.0000
2025-06-03 21:08:32,024 - INFO - SuRL_139967289575936 - Batch 0/4933 | Loss: 0.2141
2025-06-03 21:08:35,394 - INFO - SuRL_139967289575936 - Batch 100/4933 | Loss: 0.1721
2025-06-03 21:08:38,805 - INFO - SuRL_139967289575936 - Batch 200/4933 | Loss: 0.2211
2025-06-03 21:08:42,135 - INFO - SuRL_139967289575936 - Batch 300/4933 | Loss: 0.1474
2025-06-03 21:08:45,729 - INFO - SuRL_139967289575936 - Batch 400/4933 | Loss: 0.1741
2025-06-03 21:08:49,237 - INFO - SuRL_139967289575936 - Batch 500/4933 | Loss: 0.1718
2025-06-03 21:08:52,713 - INFO - SuRL_139967289575936 - Batch 600/4933 | Loss: 0.2529
2025-06-03 21:08:56,035 - INFO - SuRL_139967289575936 - Batch 700/4933 | Loss: 0.1841
2025-06-03 21:08:59,496 - INFO - SuRL_139967289575936 - Batch 800/4933 | Loss: 0.1624
2025-06-03 21:09:02,935 - INFO - SuRL_139967289575936 - Batch 900/4933 | Loss: 0.1568
2025-06-03 21:09:06,441 - INFO - SuRL_139967289575936 - Batch 1000/4933 | Loss: 0.1804
2025-06-03 21:09:10,048 - INFO - SuRL_139967289575936 - Batch 1100/4933 | Loss: 0.1618
2025-06-03 21:09:13,440 - INFO - SuRL_139967289575936 - Batch 1200/4933 | Loss: 0.1494
2025-06-03 21:09:17,058 - INFO - SuRL_139967289575936 - Batch 1300/4933 | Loss: 0.1639
2025-06-03 21:09:20,447 - INFO - SuRL_139967289575936 - Batch 1400/4933 | Loss: 0.2192
2025-06-03 21:09:23,751 - INFO - SuRL_139967289575936 - Batch 1500/4933 | Loss: 0.1906
2025-06-03 21:09:27,077 - INFO - SuRL_139967289575936 - Batch 1600/4933 | Loss: 0.1714
2025-06-03 21:09:30,563 - INFO - SuRL_139967289575936 - Batch 1700/4933 | Loss: 0.1637
2025-06-03 21:09:34,114 - INFO - SuRL_139967289575936 - Batch 1800/4933 | Loss: 0.2041
2025-06-03 21:09:37,508 - INFO - SuRL_139967289575936 - Batch 1900/4933 | Loss: 0.1621
2025-06-03 21:09:40,851 - INFO - SuRL_139967289575936 - Batch 2000/4933 | Loss: 0.1592
2025-06-03 21:09:44,294 - INFO - SuRL_139967289575936 - Batch 2100/4933 | Loss: 0.1893
2025-06-03 21:09:47,695 - INFO - SuRL_139967289575936 - Batch 2200/4933 | Loss: 0.1809
2025-06-03 21:09:51,296 - INFO - SuRL_139967289575936 - Batch 2300/4933 | Loss: 0.1389
2025-06-03 21:09:54,743 - INFO - SuRL_139967289575936 - Batch 2400/4933 | Loss: 0.1368
2025-06-03 21:09:58,183 - INFO - SuRL_139967289575936 - Batch 2500/4933 | Loss: 0.1713
2025-06-03 21:10:01,568 - INFO - SuRL_139967289575936 - Batch 2600/4933 | Loss: 0.1481
2025-06-03 21:10:04,909 - INFO - SuRL_139967289575936 - Batch 2700/4933 | Loss: 0.1421
2025-06-03 21:10:08,341 - INFO - SuRL_139967289575936 - Batch 2800/4933 | Loss: 0.1366
2025-06-03 21:10:11,754 - INFO - SuRL_139967289575936 - Batch 2900/4933 | Loss: 0.1652
2025-06-03 21:10:15,351 - INFO - SuRL_139967289575936 - Batch 3000/4933 | Loss: 0.1600
2025-06-03 21:10:18,839 - INFO - SuRL_139967289575936 - Batch 3100/4933 | Loss: 0.1353
2025-06-03 21:10:22,215 - INFO - SuRL_139967289575936 - Batch 3200/4933 | Loss: 0.1348
2025-06-03 21:10:25,624 - INFO - SuRL_139967289575936 - Batch 3300/4933 | Loss: 0.1443
2025-06-03 21:10:29,221 - INFO - SuRL_139967289575936 - Batch 3400/4933 | Loss: 0.1635
2025-06-03 21:10:32,693 - INFO - SuRL_139967289575936 - Batch 3500/4933 | Loss: 0.1319
2025-06-03 21:10:36,211 - INFO - SuRL_139967289575936 - Batch 3600/4933 | Loss: 0.1908
2025-06-03 21:10:39,633 - INFO - SuRL_139967289575936 - Batch 3700/4933 | Loss: 0.1491
2025-06-03 21:10:43,335 - INFO - SuRL_139967289575936 - Batch 3800/4933 | Loss: 0.2398
2025-06-03 21:10:47,122 - INFO - SuRL_139967289575936 - Batch 3900/4933 | Loss: 0.2269
2025-06-03 21:10:50,639 - INFO - SuRL_139967289575936 - Batch 4000/4933 | Loss: 0.2202
2025-06-03 21:10:54,210 - INFO - SuRL_139967289575936 - Batch 4100/4933 | Loss: 0.1964
2025-06-03 21:10:58,015 - INFO - SuRL_139967289575936 - Batch 4200/4933 | Loss: 0.1598
2025-06-03 21:11:01,402 - INFO - SuRL_139967289575936 - Batch 4300/4933 | Loss: 0.1316
2025-06-03 21:11:04,820 - INFO - SuRL_139967289575936 - Batch 4400/4933 | Loss: 0.1600
2025-06-03 21:11:08,194 - INFO - SuRL_139967289575936 - Batch 4500/4933 | Loss: 0.1306
2025-06-03 21:11:11,539 - INFO - SuRL_139967289575936 - Batch 4600/4933 | Loss: 0.1473
2025-06-03 21:11:14,858 - INFO - SuRL_139967289575936 - Batch 4700/4933 | Loss: 0.1900
2025-06-03 21:11:18,265 - INFO - SuRL_139967289575936 - Batch 4800/4933 | Loss: 0.1878
2025-06-03 21:11:21,503 - INFO - SuRL_139967289575936 - Batch 4900/4933 | Loss: 0.1239
2025-06-03 21:38:01,639 - INFO - SuRL_139967289575936 - New best model saved: logs/2025-06-03_20-36/checkpoints/supervised_best_epoch_2.pt
2025-06-03 21:38:01,639 - INFO - SuRL_139967289575936 - Epoch 2/3 | Train Loss: 0.1804 | Val Loss: 0.1955 | Val Action Acc: 0.0000
2025-06-03 21:38:02,383 - INFO - SuRL_139967289575936 - Batch 0/4933 | Loss: 0.1891
2025-06-03 21:38:05,560 - INFO - SuRL_139967289575936 - Batch 100/4933 | Loss: 0.1725
2025-06-03 21:38:08,731 - INFO - SuRL_139967289575936 - Batch 200/4933 | Loss: 0.2125
2025-06-03 21:38:11,918 - INFO - SuRL_139967289575936 - Batch 300/4933 | Loss: 0.1665
2025-06-03 21:38:15,095 - INFO - SuRL_139967289575936 - Batch 400/4933 | Loss: 0.1354
2025-06-03 21:38:18,315 - INFO - SuRL_139967289575936 - Batch 500/4933 | Loss: 0.1324
2025-06-03 21:38:21,373 - INFO - SuRL_139967289575936 - Batch 600/4933 | Loss: 0.1285
2025-06-03 21:38:24,544 - INFO - SuRL_139967289575936 - Batch 700/4933 | Loss: 0.1625
2025-06-03 21:38:27,758 - INFO - SuRL_139967289575936 - Batch 800/4933 | Loss: 0.1576
2025-06-03 21:38:30,925 - INFO - SuRL_139967289575936 - Batch 900/4933 | Loss: 0.1592
2025-06-03 21:38:34,281 - INFO - SuRL_139967289575936 - Batch 1000/4933 | Loss: 0.2618
2025-06-03 21:38:37,381 - INFO - SuRL_139967289575936 - Batch 1100/4933 | Loss: 0.1465
2025-06-03 21:38:40,538 - INFO - SuRL_139967289575936 - Batch 1200/4933 | Loss: 0.1805
2025-06-03 21:38:43,723 - INFO - SuRL_139967289575936 - Batch 1300/4933 | Loss: 0.1837
2025-06-03 21:38:46,839 - INFO - SuRL_139967289575936 - Batch 1400/4933 | Loss: 0.1725
2025-06-03 21:38:50,002 - INFO - SuRL_139967289575936 - Batch 1500/4933 | Loss: 0.1905
2025-06-03 21:38:53,236 - INFO - SuRL_139967289575936 - Batch 1600/4933 | Loss: 0.1515
2025-06-03 21:38:56,558 - INFO - SuRL_139967289575936 - Batch 1700/4933 | Loss: 0.2070
2025-06-03 21:38:59,770 - INFO - SuRL_139967289575936 - Batch 1800/4933 | Loss: 0.1545
2025-06-03 21:39:02,965 - INFO - SuRL_139967289575936 - Batch 1900/4933 | Loss: 0.1565
2025-06-03 21:39:06,116 - INFO - SuRL_139967289575936 - Batch 2000/4933 | Loss: 0.1737
2025-06-03 21:39:09,315 - INFO - SuRL_139967289575936 - Batch 2100/4933 | Loss: 0.2178
2025-06-03 21:39:12,426 - INFO - SuRL_139967289575936 - Batch 2200/4933 | Loss: 0.1743
2025-06-03 21:39:15,645 - INFO - SuRL_139967289575936 - Batch 2300/4933 | Loss: 0.1761
2025-06-03 21:39:19,049 - INFO - SuRL_139967289575936 - Batch 2400/4933 | Loss: 0.1441
2025-06-03 21:39:22,300 - INFO - SuRL_139967289575936 - Batch 2500/4933 | Loss: 0.1526
2025-06-03 21:39:25,655 - INFO - SuRL_139967289575936 - Batch 2600/4933 | Loss: 0.1339
2025-06-03 21:39:29,059 - INFO - SuRL_139967289575936 - Batch 2700/4933 | Loss: 0.1209
2025-06-03 21:39:32,378 - INFO - SuRL_139967289575936 - Batch 2800/4933 | Loss: 0.1519
2025-06-03 21:39:35,630 - INFO - SuRL_139967289575936 - Batch 2900/4933 | Loss: 0.1459
2025-06-03 21:39:38,785 - INFO - SuRL_139967289575936 - Batch 3000/4933 | Loss: 0.1529
2025-06-03 21:39:41,789 - INFO - SuRL_139967289575936 - Batch 3100/4933 | Loss: 0.1232
2025-06-03 21:39:44,860 - INFO - SuRL_139967289575936 - Batch 3200/4933 | Loss: 0.1329
2025-06-03 21:39:48,021 - INFO - SuRL_139967289575936 - Batch 3300/4933 | Loss: 0.1483
2025-06-03 21:39:51,154 - INFO - SuRL_139967289575936 - Batch 3400/4933 | Loss: 0.1544
2025-06-03 21:39:54,258 - INFO - SuRL_139967289575936 - Batch 3500/4933 | Loss: 0.1638
2025-06-03 21:39:57,416 - INFO - SuRL_139967289575936 - Batch 3600/4933 | Loss: 0.1534
2025-06-03 21:40:00,608 - INFO - SuRL_139967289575936 - Batch 3700/4933 | Loss: 0.1355
2025-06-03 21:40:03,711 - INFO - SuRL_139967289575936 - Batch 3800/4933 | Loss: 0.1796
2025-06-03 21:40:06,931 - INFO - SuRL_139967289575936 - Batch 3900/4933 | Loss: 0.1208
2025-06-03 21:40:10,074 - INFO - SuRL_139967289575936 - Batch 4000/4933 | Loss: 0.2047
2025-06-03 21:40:13,196 - INFO - SuRL_139967289575936 - Batch 4100/4933 | Loss: 0.1307
2025-06-03 21:40:16,224 - INFO - SuRL_139967289575936 - Batch 4200/4933 | Loss: 0.1616
2025-06-03 21:40:19,335 - INFO - SuRL_139967289575936 - Batch 4300/4933 | Loss: 0.1238
2025-06-03 21:40:22,485 - INFO - SuRL_139967289575936 - Batch 4400/4933 | Loss: 0.2601
2025-06-03 21:40:25,501 - INFO - SuRL_139967289575936 - Batch 4500/4933 | Loss: 0.1697
2025-06-03 21:40:28,808 - INFO - SuRL_139967289575936 - Batch 4600/4933 | Loss: 0.1849
2025-06-03 21:40:31,906 - INFO - SuRL_139967289575936 - Batch 4700/4933 | Loss: 0.1821
2025-06-03 21:40:35,021 - INFO - SuRL_139967289575936 - Batch 4800/4933 | Loss: 0.2206
2025-06-03 21:40:38,105 - INFO - SuRL_139967289575936 - Batch 4900/4933 | Loss: 0.1673
2025-06-03 22:05:51,712 - INFO - SuRL_139967289575936 - Epoch 3/3 | Train Loss: 0.1545 | Val Loss: 0.1956 | Val Action Acc: 0.0000
2025-06-03 22:05:52,629 - INFO - SuRL_139967289575936 - Training plots saved to logs/2025-06-03_20-36
2025-06-03 22:05:53,005 - INFO - SuRL_139967289575936 - Training completed. Best model: logs/2025-06-03_20-36/checkpoints/supervised_best_epoch_2.pt
2025-06-03 22:05:53,005 - INFO - SuRL_139967289575936 - Final model: logs/2025-06-03_20-36/checkpoints/final_model.pt
2025-06-03 22:06:38,036 - INFO - SuRL_139967289575936 - ✅ Method 1 (IL) completed successfully
2025-06-03 22:06:38,037 - INFO - SuRL_139967289575936 - 📊 IL mAP: 0.2480
2025-06-03 22:06:43,186 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 22:06:43,187 - INFO - SuRL_139967289575936 - STEP 3: METHOD 2 - RL WITH WORLD MODEL SIMULATION
2025-06-03 22:06:43,187 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 22:06:43,187 - INFO - SuRL_139967289575936 - 🌍 Training RL with World Model Simulation...
2025-06-03 22:06:43,187 - INFO - SuRL_139967289575936 - 📋 Approach: World model as RL environment simulator
2025-06-03 22:06:44,456 - INFO - SuRL_139967289575936 - ✅ Using world model from Method 1: logs/2025-06-03_20-36/checkpoints/supervised_best_epoch_2.pt
2025-06-03 22:06:44,458 - INFO - SuRL_139967289575936 - 🤖 Training PPO with world model simulation...
2025-06-03 22:07:11,250 - INFO - SuRL_139967289575936 - 🤖 Training A2C with world model simulation...
2025-06-03 22:07:29,555 - INFO - SuRL_139967289575936 - ✅ Method 2 (RL + World Model) completed successfully
2025-06-03 22:07:29,555 - INFO - SuRL_139967289575936 - 📊 Successful RL models: ['ppo', 'a2c']
2025-06-03 22:07:29,555 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 22:07:29,555 - INFO - SuRL_139967289575936 - STEP 4: METHOD 3 - RL WITH OFFLINE VIDEO EPISODES
2025-06-03 22:07:29,555 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 22:07:29,555 - INFO - SuRL_139967289575936 - 📹 Training RL with Offline Video Episodes...
2025-06-03 22:07:29,555 - INFO - SuRL_139967289575936 - 📋 Approach: Direct RL on video sequences (no world model)
2025-06-03 22:07:29,556 - INFO - SuRL_139967289575936 - 🧪 Testing Direct Video Environment...
2025-06-03 22:07:29,561 - INFO - SuRL_139967289575936 - 🚀 Training RL algorithms on direct video sequences for 10000 timesteps...
2025-06-03 22:08:14,334 - INFO - SuRL_139967289575936 - ✅ ppo Direct Video evaluation completed
2025-06-03 22:08:14,335 - INFO - SuRL_139967289575936 - ✅ a2c Direct Video evaluation completed
2025-06-03 22:08:14,335 - INFO - SuRL_139967289575936 - ✅ Method 3 (RL + Offline Videos) completed successfully
2025-06-03 22:08:14,335 - INFO - SuRL_139967289575936 - 📊 Successful Direct Video RL models: ['ppo', 'a2c']
2025-06-03 22:08:14,335 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 22:08:14,335 - INFO - SuRL_139967289575936 - STEP 5: COMPREHENSIVE EVALUATION AND COMPARISON
2025-06-03 22:08:14,335 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 22:08:14,335 - INFO - SuRL_139967289575936 - 📊 Running comprehensive evaluation...
2025-06-03 22:08:15,617 - INFO - SuRL_139967289575936 - ✅ Loaded IL model for evaluation
2025-06-03 22:08:15,657 - INFO - SuRL_139967289575936 - ✅ Loaded PPO model for evaluation
2025-06-03 22:08:15,706 - INFO - SuRL_139967289575936 - ✅ Loaded A2C model for evaluation
2025-06-03 22:08:17,035 - INFO - SuRL_139967289575936 - 🔧 Evaluation framework using device: cuda
2025-06-03 22:08:17,035 - INFO - SuRL_139967289575936 - 📊 Starting Comprehensive Dual Evaluation...
2025-06-03 22:08:17,035 - INFO - SuRL_139967289575936 - 🔍 Including BOTH traditional and outcome-based metrics
2025-06-03 22:08:17,035 - INFO - SuRL_139967289575936 - 🎓 Evaluating Imitation Learning...
2025-06-03 22:08:17,035 - INFO - SuRL_139967289575936 - 🔧 Model device: cuda:0
2025-06-03 22:08:17,036 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID02
2025-06-03 22:08:17,281 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:20,085 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID06
2025-06-03 22:08:20,335 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:22,420 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID111
2025-06-03 22:08:22,650 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:24,603 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID14
2025-06-03 22:08:24,793 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:26,422 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID23
2025-06-03 22:08:26,578 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:28,088 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID25
2025-06-03 22:08:28,316 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:30,363 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID50
2025-06-03 22:08:30,598 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:31,699 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID51
2025-06-03 22:08:32,411 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:35,289 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID66
2025-06-03 22:08:35,917 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:37,824 - INFO - SuRL_139967289575936 - 🔧 Evaluating video VID79
2025-06-03 22:08:38,499 - INFO - SuRL_139967289575936 - 🔧 Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 22:08:42,152 - INFO - SuRL_139967289575936 - 🔧 Final shapes - Predictions: (21885, 20, 100), Targets: (21885, 20, 100)
2025-06-03 22:10:47,255 - INFO - SuRL_139967289575936 - 🤖 Evaluating RL_WM_PPO...
2025-06-03 22:10:47,256 - INFO - SuRL_139967289575936 - 🔧 Model device: cuda
2025-06-03 22:11:04,550 - INFO - SuRL_139967289575936 - 🔧 Final shapes - Predictions: (10, 512, 100), Targets: (10, 512, 100)
2025-06-03 22:11:23,101 - INFO - SuRL_139967289575936 - 🤖 Evaluating RL_WM_A2C...
2025-06-03 22:11:23,102 - INFO - SuRL_139967289575936 - 🔧 Model device: cuda
2025-06-03 22:11:40,134 - INFO - SuRL_139967289575936 - 🔧 Final shapes - Predictions: (10, 512, 100), Targets: (10, 512, 100)
2025-06-03 22:11:57,199 - INFO - SuRL_139967289575936 - 🔍 Analyzing evaluation bias...
2025-06-03 22:11:57,200 - INFO - SuRL_139967289575936 - ⚖️ Creating comprehensive comparison...
2025-06-03 22:11:57,204 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 22:11:57,205 - INFO - SuRL_139967289575936 - STEP 6: GENERATING RESEARCH PAPER RESULTS
2025-06-03 22:11:57,205 - INFO - SuRL_139967289575936 - ============================================================
2025-06-03 22:11:57,205 - INFO - SuRL_139967289575936 - 📝 Generating research paper results...
2025-06-03 22:11:57,211 - INFO - SuRL_139967289575936 - 📄 Experiment summary saved to: logs/2025-06-03_20-36/surgical_rl_results/experiment_summary.md
2025-06-03 22:11:57,211 - INFO - SuRL_139967289575936 - 📄 Paper results saved to: logs/2025-06-03_20-36/surgical_rl_results/paper_results.json
2025-06-03 22:11:57,215 - INFO - SuRL_139967289575936 - 💾 Complete results saved to: logs/2025-06-03_20-36/surgical_rl_results/complete_surgical_rl_results.json
2025-06-03 22:11:57,215 - INFO - SuRL_139967289575936 - 📁 All results available in: logs/2025-06-03_20-36/surgical_rl_results
2025-06-03 22:11:57,215 - INFO - SuRL_139967289575936 - ✅ SURGICAL RL COMPARISON COMPLETED SUCCESSFULLY!
