2025-05-27 21:48:30,276 - INFO - Log file: logs/2025-05-27_21-48-30/dual_world_model.log
2025-05-27 21:48:30,276 - INFO - Starting Dual World Model experiment
2025-05-27 21:48:30,276 - INFO - Using device: cuda
2025-05-27 21:48:30,276 - INFO - Loading CholecT50 data...
2025-05-27 21:48:30,276 - INFO - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-27 21:48:30,679 - INFO - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 21:48:30,679 - INFO - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 21:48:30,681 - INFO - [Train] Found 2 videos in metadata file
2025-05-27 21:48:30,681 - INFO - [Train] Loading data for 2 videos
2025-05-27 21:48:30,819 - INFO - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-27 21:48:30,908 - INFO - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 21:48:30,908 - INFO - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-27 21:48:30,908 - INFO - [Test] Found 2 videos in metadata file
2025-05-27 21:48:30,908 - INFO - [Test] Loading data for 2 videos
2025-05-27 21:48:32,277 - INFO - Training samples: 3255
2025-05-27 21:48:32,277 - INFO - Test videos: 2
2025-05-27 21:48:32,277 - INFO - Initializing Dual World Model...
2025-05-27 21:48:32,907 - INFO - Total parameters: 48,924,145
2025-05-27 21:48:32,907 - INFO - Trainable parameters: 48,924,145
2025-05-27 21:48:32,908 - INFO - Training mode: supervised
2025-05-27 21:48:32,908 - INFO - Starting supervised training...
2025-05-27 21:48:32,909 - INFO - Starting supervised training for autoregressive action prediction
2025-05-27 21:48:33,307 - INFO - Batch 0/204 | Loss: 3.3123
2025-05-27 21:48:37,766 - INFO - Batch 100/204 | Loss: 0.5482
2025-05-27 21:48:42,180 - INFO - Batch 200/204 | Loss: 0.3687
2025-05-27 21:48:46,258 - INFO - New best model saved: logs/2025-05-27_21-48-30/checkpoints/supervised_best_epoch_1.pt
2025-05-27 21:48:46,258 - INFO - Epoch 1/2 | Train Loss: 0.7822 | Val Loss: 0.8200 | Val Action Acc: 0.9875
2025-05-27 21:48:46,408 - INFO - Batch 0/204 | Loss: 0.2909
2025-05-27 21:48:50,828 - INFO - Batch 100/204 | Loss: 0.2716
2025-05-27 21:48:55,274 - INFO - Batch 200/204 | Loss: 0.2435
2025-05-27 21:48:59,374 - INFO - New best model saved: logs/2025-05-27_21-48-30/checkpoints/supervised_best_epoch_2.pt
2025-05-27 21:48:59,374 - INFO - Epoch 2/2 | Train Loss: 0.2925 | Val Loss: 0.7301 | Val Action Acc: 0.9876
2025-05-27 21:48:59,870 - INFO - Training plots saved to logs/2025-05-27_21-48-30
2025-05-27 21:48:59,981 - INFO - Training completed. Best model: logs/2025-05-27_21-48-30/checkpoints/supervised_best_epoch_2.pt
2025-05-27 21:48:59,981 - INFO - Final model: logs/2025-05-27_21-48-30/checkpoints/final_model.pt
2025-05-27 21:48:59,981 - INFO - Supervised training completed. Model saved: logs/2025-05-27_21-48-30/checkpoints/supervised_best_epoch_2.pt
2025-05-27 21:48:59,981 - INFO - Starting model evaluation...
2025-05-27 21:48:59,981 - INFO - Evaluating supervised-trained model
2025-05-27 21:49:00,599 - INFO - Starting comprehensive evaluation of both modes
2025-05-27 21:49:00,599 - INFO - Starting supervised mode evaluation (autoregressive action prediction)
2025-05-27 21:49:00,600 - INFO - Evaluating video: VID02
2025-05-27 21:50:19,844 - INFO - Evaluating video: VID06
2025-05-27 21:51:28,880 - INFO - Supervised evaluation completed. Processed 4992 samples from 2 videos.
2025-05-27 21:51:28,881 - INFO - Starting RL mode evaluation (state and reward prediction)
2025-05-27 21:51:28,881 - INFO - Evaluating RL mode on video: VID02
2025-05-27 21:51:29,068 - ERROR - Evaluation failed: 'DualWorldModel' object has no attribute 'rl_state_prediction'
2025-05-27 21:51:29,069 - INFO - Starting RL environment experiments...
2025-05-27 21:51:29,069 - INFO - Setting up RL environment experiments
2025-05-27 21:51:29,070 - INFO - Testing random policy baseline...
2025-05-27 21:51:29,071 - ERROR - RL environment experiments failed: 'DualWorldModel' object has no attribute 'rl_state_prediction'
2025-05-27 21:51:29,072 - INFO - Generating summary report...
