2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - Shared experiment log directory: logs/0603_1800
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - üöÄ SURGICAL RL COMPARISON INITIALIZED
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - Method 1: Imitation Learning (Baseline)
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - Method 2: RL with World Model Simulation
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - Method 3: RL with Offline Video Episodes
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - Device: cuda
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - Results will be saved to: logs/0603_1800/surgical_rl_results
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - STEP 1: LOADING DATASET
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:00:40,112 - INFO - logger_surgical_rl_comparison_137581235276064 - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-03 18:00:40,554 - INFO - logger_surgical_rl_comparison_137581235276064 - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 18:00:40,554 - INFO - logger_surgical_rl_comparison_137581235276064 - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 18:00:40,556 - INFO - logger_surgical_rl_comparison_137581235276064 - [Train] Found 2 videos in metadata file
2025-06-03 18:00:40,556 - INFO - logger_surgical_rl_comparison_137581235276064 - [Train] Loading data for 2 videos
2025-06-03 18:00:40,812 - INFO - logger_surgical_rl_comparison_137581235276064 - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-03 18:00:40,898 - INFO - logger_surgical_rl_comparison_137581235276064 - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 18:00:40,898 - INFO - logger_surgical_rl_comparison_137581235276064 - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 18:00:40,898 - INFO - logger_surgical_rl_comparison_137581235276064 - [Test] Found 1 videos in metadata file
2025-06-03 18:00:40,898 - INFO - logger_surgical_rl_comparison_137581235276064 - [Test] Loading data for 1 videos
2025-06-03 18:00:41,005 - INFO - logger_surgical_rl_comparison_137581235276064 - ‚úÖ Loaded 2 training videos and 1 test videos
2025-06-03 18:00:41,005 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:00:41,005 - INFO - logger_surgical_rl_comparison_137581235276064 - STEP 2: METHOD 1 - IMITATION LEARNING BASELINE
2025-06-03 18:00:41,005 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:00:41,005 - INFO - logger_surgical_rl_comparison_137581235276064 - üéì Training Imitation Learning Baseline...
2025-06-03 18:00:41,005 - INFO - logger_surgical_rl_comparison_137581235276064 - üìã Approach: Supervised learning on expert demonstrations
2025-06-03 18:00:42,608 - INFO - logger_surgical_rl_comparison_137581235276064 - Starting the Imitation Learning training for autoregressive action prediction
2025-06-03 18:00:42,972 - INFO - logger_surgical_rl_comparison_137581235276064 - Batch 0/204 | Loss: 3.3123
2025-06-03 18:00:47,378 - INFO - logger_surgical_rl_comparison_137581235276064 - Batch 100/204 | Loss: 0.5414
2025-06-03 18:00:51,792 - INFO - logger_surgical_rl_comparison_137581235276064 - Batch 200/204 | Loss: 0.3646
2025-06-03 18:01:48,770 - INFO - logger_surgical_rl_comparison_137581235276064 - New best model saved: logs/0603_1800/checkpoints/supervised_best_epoch_1.pt
2025-06-03 18:01:48,770 - INFO - logger_surgical_rl_comparison_137581235276064 - Epoch 1/1 | Train Loss: 0.7761 | Val Loss: 0.4113 | Val Action Acc: 0.0000
2025-06-03 18:01:49,212 - INFO - logger_surgical_rl_comparison_137581235276064 - Training plots saved to logs/0603_1800
2025-06-03 18:01:49,349 - INFO - logger_surgical_rl_comparison_137581235276064 - Training completed. Best model: logs/0603_1800/checkpoints/supervised_best_epoch_1.pt
2025-06-03 18:01:49,349 - INFO - logger_surgical_rl_comparison_137581235276064 - Final model: logs/0603_1800/checkpoints/final_model.pt
2025-06-03 18:01:52,645 - INFO - logger_surgical_rl_comparison_137581235276064 - ‚úÖ Method 1 (IL) completed successfully
2025-06-03 18:01:52,645 - INFO - logger_surgical_rl_comparison_137581235276064 - üìä IL mAP: 0.2378
2025-06-03 18:01:52,714 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:01:52,715 - INFO - logger_surgical_rl_comparison_137581235276064 - STEP 3: METHOD 2 - RL WITH WORLD MODEL SIMULATION
2025-06-03 18:01:52,715 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:01:52,715 - INFO - logger_surgical_rl_comparison_137581235276064 - üåç Training RL with World Model Simulation...
2025-06-03 18:01:52,715 - INFO - logger_surgical_rl_comparison_137581235276064 - üìã Approach: World model as RL environment simulator
2025-06-03 18:01:53,313 - INFO - logger_surgical_rl_comparison_137581235276064 - ‚úÖ Using world model from Method 1: logs/0603_1800/checkpoints/supervised_best_epoch_1.pt
2025-06-03 18:01:53,313 - ERROR - logger_surgical_rl_comparison_137581235276064 - ‚ùå Method 2 (RL + World Model) failed: name 'SB3Trainer' is not defined
2025-06-03 18:01:53,313 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:01:53,314 - INFO - logger_surgical_rl_comparison_137581235276064 - STEP 4: METHOD 3 - RL WITH OFFLINE VIDEO EPISODES
2025-06-03 18:01:53,314 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:01:53,314 - INFO - logger_surgical_rl_comparison_137581235276064 - üìπ Training RL with Offline Video Episodes...
2025-06-03 18:01:53,314 - INFO - logger_surgical_rl_comparison_137581235276064 - üìã Approach: Direct RL on video sequences (no world model)
2025-06-03 18:01:53,314 - ERROR - logger_surgical_rl_comparison_137581235276064 - ‚ùå Method 3 (RL + Offline Videos) failed: cannot import name 'DirectVideoEnvironment' from 'environment' (unknown location)
2025-06-03 18:01:53,314 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:01:53,314 - INFO - logger_surgical_rl_comparison_137581235276064 - STEP 5: COMPREHENSIVE EVALUATION AND COMPARISON
2025-06-03 18:01:53,314 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:01:53,314 - INFO - logger_surgical_rl_comparison_137581235276064 - üìä Running comprehensive three-way evaluation...
2025-06-03 18:01:53,900 - INFO - logger_surgical_rl_comparison_137581235276064 - ‚úÖ Loaded IL model for evaluation
2025-06-03 18:01:54,491 - INFO - logger_surgical_rl_comparison_137581235276064 - üîß Evaluation framework using device: cuda
2025-06-03 18:01:54,491 - INFO - logger_surgical_rl_comparison_137581235276064 - üìä Starting Comprehensive Dual Evaluation...
2025-06-03 18:01:54,491 - INFO - logger_surgical_rl_comparison_137581235276064 - üîç Including BOTH traditional and outcome-based metrics
2025-06-03 18:01:54,491 - INFO - logger_surgical_rl_comparison_137581235276064 - üéì Evaluating Imitation Learning...
2025-06-03 18:01:54,491 - ERROR - logger_surgical_rl_comparison_137581235276064 - ‚ùå Comprehensive evaluation failed: 'DualWorldModel' object has no attribute 'get_parameters'
2025-06-03 18:01:54,492 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:01:54,492 - INFO - logger_surgical_rl_comparison_137581235276064 - STEP 6: GENERATING RESEARCH PAPER RESULTS
2025-06-03 18:01:54,492 - INFO - logger_surgical_rl_comparison_137581235276064 - ============================================================
2025-06-03 18:01:54,492 - INFO - logger_surgical_rl_comparison_137581235276064 - üìù Generating research paper results...
2025-06-03 18:01:54,492 - INFO - logger_surgical_rl_comparison_137581235276064 - üìÑ Experiment summary saved to: logs/0603_1800/surgical_rl_results/experiment_summary.md
2025-06-03 18:01:54,492 - INFO - logger_surgical_rl_comparison_137581235276064 - üìÑ Paper results saved to: logs/0603_1800/surgical_rl_results/paper_results.json
2025-06-03 18:01:54,493 - INFO - logger_surgical_rl_comparison_137581235276064 - üíæ Complete results saved to: logs/0603_1800/surgical_rl_results/complete_surgical_rl_results.json
2025-06-03 18:01:54,493 - INFO - logger_surgical_rl_comparison_137581235276064 - üìÅ All results available in: logs/0603_1800/surgical_rl_results
2025-06-03 18:01:54,493 - INFO - logger_surgical_rl_comparison_137581235276064 - ‚úÖ SURGICAL RL COMPARISON COMPLETED SUCCESSFULLY!
