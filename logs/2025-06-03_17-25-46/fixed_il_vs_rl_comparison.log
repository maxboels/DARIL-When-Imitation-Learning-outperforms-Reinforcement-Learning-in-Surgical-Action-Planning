2025-06-03 17:25:46,168 - INFO - Log file: logs/2025-06-03_17-25-46/fixed_il_vs_rl_comparison.log
2025-06-03 17:25:46,169 - INFO - ğŸš€ Starting FIXED IL vs RL Comparison Experiment
2025-06-03 17:25:46,169 - INFO - Device: cuda
2025-06-03 17:25:46,169 - INFO - Action Space: Continuous Box(0,1,(100,)) with binary thresholding
2025-06-03 17:25:46,169 - INFO - Results will be saved to: logs/2025-06-03_17-25-46/comparison_results
2025-06-03 17:25:46,169 - INFO - ğŸ“Š Loading dataset...
2025-06-03 17:25:46,169 - INFO - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-03 17:25:46,563 - INFO - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 17:25:46,563 - INFO - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 17:25:46,564 - INFO - [Train] Found 2 videos in metadata file
2025-06-03 17:25:46,564 - INFO - [Train] Loading data for 2 videos
2025-06-03 17:25:46,698 - INFO - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-03 17:25:46,773 - INFO - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 17:25:46,773 - INFO - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 17:25:46,774 - INFO - [Test] Found 1 videos in metadata file
2025-06-03 17:25:46,774 - INFO - [Test] Loading data for 1 videos
2025-06-03 17:25:46,883 - INFO - Loaded 2 training videos and 1 test videos
2025-06-03 17:25:46,883 - INFO - ğŸ“ Training Imitation Learning Model...
2025-06-03 17:25:46,883 - INFO - Training supervised imitation learning model
2025-06-03 17:25:48,402 - INFO - Model parameters: 48,924,145 total, 48,924,145 trainable
2025-06-03 17:25:48,403 - INFO - Starting supervised training for autoregressive action prediction
2025-06-03 17:25:48,784 - INFO - Batch 0/204 | Loss: 3.3123
2025-06-03 17:25:53,152 - INFO - Batch 100/204 | Loss: 0.5414
2025-06-03 17:25:57,559 - INFO - Batch 200/204 | Loss: 0.3646
2025-06-03 17:26:54,786 - INFO - New best model saved: logs/2025-06-03_17-25-46/checkpoints/supervised_best_epoch_1.pt
2025-06-03 17:26:54,787 - INFO - Epoch 1/1 | Train Loss: 0.7761 | Val Loss: 0.4113 | Val Action Acc: 0.0000
2025-06-03 17:26:55,257 - INFO - Training plots saved to logs/2025-06-03_17-25-46
2025-06-03 17:26:55,366 - INFO - Training completed. Best model: logs/2025-06-03_17-25-46/checkpoints/supervised_best_epoch_1.pt
2025-06-03 17:26:55,366 - INFO - Final model: logs/2025-06-03_17-25-46/checkpoints/final_model.pt
2025-06-03 17:26:55,366 - INFO - âœ… IL training completed. Model saved: logs/2025-06-03_17-25-46/checkpoints/supervised_best_epoch_1.pt
2025-06-03 17:26:55,434 - INFO - ğŸ¤– Training RL Models with WORKING Trainer...
2025-06-03 17:26:56,140 - INFO - âœ… Loaded world model from: logs/2025-06-03_17-25-46/checkpoints/supervised_best_epoch_1.pt
2025-06-03 17:26:56,140 - INFO - ğŸš€ Starting RL training with 10000 timesteps per algorithm
2025-06-03 17:26:56,140 - INFO - ğŸ“‹ Action Space: Continuous Box(0,1,(100,)) â†’ thresholded to binary
2025-06-03 17:26:56,140 - INFO - ğŸ¤– Training PPO (Final Fixed Version)...
2025-06-03 17:27:09,808 - INFO - âœ… PPO training successful: 102.233 Â± 22.719
2025-06-03 17:27:09,808 - INFO - ğŸ¤– Training A2C (Final Fixed Version)...
2025-06-03 17:27:19,619 - INFO - âœ… A2C training successful: 88.549 Â± 24.405
2025-06-03 17:27:19,619 - INFO - ğŸ“ˆ Running comprehensive evaluation...
2025-06-03 17:27:19,619 - INFO - ğŸ” Starting comprehensive evaluation...
2025-06-03 17:27:19,619 - INFO - ğŸ“¥ Loading models for evaluation...
2025-06-03 17:27:19,619 - INFO - ğŸ“¥ Loading IL model from: logs/2025-06-03_17-25-46/checkpoints/supervised_best_epoch_1.pt
2025-06-03 17:27:20,268 - INFO - âœ… IL model loaded successfully
2025-06-03 17:27:20,279 - INFO - âœ… Loaded PPO model from logs/2025-06-03_17-25-46/rl_training/ppo_model_final_fixed.zip
2025-06-03 17:27:20,287 - INFO - âœ… Loaded A2C model from logs/2025-06-03_17-25-46/rl_training/a2c_model_final_fixed.zip
2025-06-03 17:27:20,288 - INFO - ğŸ“¥ Loading IL model from: logs/2025-06-03_17-25-46/checkpoints/supervised_best_epoch_1.pt
2025-06-03 17:27:20,912 - INFO - âœ… IL model loaded successfully
2025-06-03 17:27:20,912 - INFO - ğŸ”§ Evaluation framework using device: cuda
2025-06-03 17:27:20,913 - INFO - ğŸ“Š Starting Comprehensive Dual Evaluation...
2025-06-03 17:27:20,913 - INFO - ğŸ” Including BOTH traditional and outcome-based metrics
2025-06-03 17:27:20,913 - INFO - ğŸ“ Evaluating Imitation Learning...
2025-06-03 17:27:20,913 - INFO - ğŸ”§ Model device: cuda:0
2025-06-03 17:27:20,913 - INFO - ğŸ”§ Evaluating video VID02
2025-06-03 17:27:21,417 - INFO - ğŸ”§ Batch shapes - States: torch.Size([16, 20, 1024]), Actions: torch.Size([16, 20, 100])
2025-06-03 17:27:23,323 - INFO - ğŸ”§ Final shapes - Predictions: (2839, 20, 100), Targets: (2839, 20, 100)
2025-06-03 17:27:29,514 - INFO - ğŸ¤– Evaluating ppo...
2025-06-03 17:27:29,514 - INFO - ğŸ”§ Model device: cuda
2025-06-03 17:27:30,282 - INFO - ğŸ”§ Final shapes - Predictions: (1, 512, 100), Targets: (1, 512, 100)
2025-06-03 17:27:31,054 - INFO - ğŸ¤– Evaluating a2c...
2025-06-03 17:27:31,054 - INFO - ğŸ”§ Model device: cuda
2025-06-03 17:27:31,808 - INFO - ğŸ”§ Final shapes - Predictions: (1, 512, 100), Targets: (1, 512, 100)
2025-06-03 17:27:32,614 - INFO - ğŸ” Analyzing evaluation bias...
2025-06-03 17:27:32,615 - INFO - âš–ï¸ Creating comprehensive comparison...
2025-06-03 17:27:32,615 - INFO - âœ… Dual evaluation completed successfully
2025-06-03 17:27:32,616 - INFO - ğŸ”¬ Performing statistical analysis...
2025-06-03 17:27:32,616 - INFO - ğŸ“ Generating reports and visualizations...
2025-06-03 17:27:32,616 - INFO - ğŸ“„ Fixed comparison report saved to: logs/2025-06-03_17-25-46/comparison_results/fixed_comparison_report.md
2025-06-03 17:27:32,617 - INFO - ğŸ’¾ Fixed results saved to: logs/2025-06-03_17-25-46/comparison_results/fixed_complete_comparison_results.json
2025-06-03 17:27:32,617 - INFO - âœ… Complete IL vs RL comparison finished successfully!
