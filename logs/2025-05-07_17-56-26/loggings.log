2025-05-07 17:56:26,922 - INFO - Log file: logs/2025-05-07_17-56-26/loggings.log
2025-05-07 17:56:26,922 - INFO - Starting CholecT50 experiment for Surgical Actions Prediction
2025-05-07 17:56:26,922 - INFO - Experiment configuration: {'max_videos': 5, 'recognition': {'train': False, 'inference': False, 'best_model_path': './best_checkpoints/best_model_epoch2_map0.5008.pt'}, 'pretrain_world_model': {'train': True, 'inference': False, 'best_model_path': None}, 'pretrain_reward_model': False, 'calculate_action_rewards': False, 'train_action_policy': False, 'run_tdmpc': False, 'analyze_results': False, 'run_evaluation': False}
2025-05-07 17:56:26,922 - INFO - Using device: cuda
2025-05-07 17:56:26,922 - INFO - Loading CholecT50 data...
2025-05-07 17:56:31,324 - INFO - [TRAINING] Starting world model training for 3 epochs
2025-05-07 17:56:31,544 - INFO - [TRAINING] Batch 0/555 | total_loss: 6.9717
2025-05-07 17:56:35,172 - INFO - [TRAINING] Batch 80/555 | total_loss: 4.1841
2025-05-07 17:56:38,789 - INFO - [TRAINING] Batch 160/555 | total_loss: 2.3650
2025-05-07 17:56:42,423 - INFO - [TRAINING] Batch 240/555 | total_loss: 1.7910
2025-05-07 17:56:46,074 - INFO - [TRAINING] Batch 320/555 | total_loss: 1.5124
2025-05-07 17:56:49,732 - INFO - [TRAINING] Batch 400/555 | total_loss: 1.1479
2025-05-07 17:56:53,379 - INFO - [TRAINING] Batch 480/555 | total_loss: 1.1570
2025-05-07 17:56:56,749 - INFO - [TRAINING] Epoch 1/3 completed in 25.42s | Train loss: 2.3435
2025-05-07 17:56:56,749 - INFO - [EVAL] Evaluating world model on 5 test videos
2025-05-07 17:56:56,749 - INFO - [EVAL] Video IDs: ['VID02', 'VID06', 'VID111', 'VID14', 'VID23']
2025-05-07 17:57:05,796 - INFO - [EVAL] Video VID02 | State Pred MSE: 0.3807 | Rollout MSE Mean: 1.1253 | Rollout MSE Growth: 1.8262
2025-05-07 17:57:12,650 - INFO - [EVAL] Video VID06 | State Pred MSE: 0.4185 | Rollout MSE Mean: 1.0944 | Rollout MSE Growth: 1.6881
2025-05-07 17:57:19,499 - INFO - [EVAL] Video VID111 | State Pred MSE: 0.3529 | Rollout MSE Mean: 1.2352 | Rollout MSE Growth: 2.1180
2025-05-07 17:57:24,963 - INFO - [EVAL] Video VID14 | State Pred MSE: 0.4217 | Rollout MSE Mean: 1.0726 | Rollout MSE Growth: 1.5540
2025-05-07 17:57:30,200 - INFO - [EVAL] Video VID23 | State Pred MSE: 0.4788 | Rollout MSE Mean: 1.1740 | Rollout MSE Growth: 1.9925
2025-05-07 17:57:30,201 - INFO - [EVAL] Validation | Loss: 1.8322 | State Pred MSE: 0.4105 | Rollout MSE Mean: 1.1403 | Rollout MSE Growth: 1.8358 | Action Pred Accuracy: 0.0000
2025-05-07 17:57:30,311 - INFO - New best model saved at logs/2025-05-07_17-56-26/checkpoints/world_model_best_epoch_1.pt
2025-05-07 17:57:30,453 - INFO - [TRAINING] Batch 0/555 | total_loss: 0.9999
2025-05-07 17:57:34,123 - INFO - [TRAINING] Batch 80/555 | total_loss: 1.1000
2025-05-07 17:57:37,816 - INFO - [TRAINING] Batch 160/555 | total_loss: 0.9262
2025-05-07 17:57:41,500 - INFO - [TRAINING] Batch 240/555 | total_loss: 0.8767
2025-05-07 17:57:45,182 - INFO - [TRAINING] Batch 320/555 | total_loss: 0.7872
2025-05-07 17:57:48,878 - INFO - [TRAINING] Batch 400/555 | total_loss: 0.5367
2025-05-07 17:57:52,565 - INFO - [TRAINING] Batch 480/555 | total_loss: 0.6171
2025-05-07 17:57:55,947 - INFO - [TRAINING] Epoch 2/3 completed in 25.54s | Train loss: 0.6864
2025-05-07 17:57:55,948 - INFO - [EVAL] Evaluating world model on 5 test videos
2025-05-07 17:57:55,948 - INFO - [EVAL] Video IDs: ['VID02', 'VID06', 'VID111', 'VID14', 'VID23']
2025-05-07 17:58:04,999 - INFO - [EVAL] Video VID02 | State Pred MSE: 0.2497 | Rollout MSE Mean: 1.3505 | Rollout MSE Growth: 2.4642
2025-05-07 17:58:11,855 - INFO - [EVAL] Video VID06 | State Pred MSE: 0.2474 | Rollout MSE Mean: 1.2703 | Rollout MSE Growth: 2.3393
2025-05-07 17:58:18,712 - INFO - [EVAL] Video VID111 | State Pred MSE: 0.2450 | Rollout MSE Mean: 1.5112 | Rollout MSE Growth: 2.8608
2025-05-07 17:58:24,187 - INFO - [EVAL] Video VID14 | State Pred MSE: 0.2824 | Rollout MSE Mean: 1.2155 | Rollout MSE Growth: 1.9683
2025-05-07 17:58:29,434 - INFO - [EVAL] Video VID23 | State Pred MSE: 0.2812 | Rollout MSE Mean: 1.4464 | Rollout MSE Growth: 2.7521
2025-05-07 17:58:29,435 - INFO - [EVAL] Validation | Loss: 1.9073 | State Pred MSE: 0.2611 | Rollout MSE Mean: 1.3588 | Rollout MSE Growth: 2.4769 | Action Pred Accuracy: 0.0000
2025-05-07 17:58:29,626 - INFO - [TRAINING] Batch 0/555 | total_loss: 0.4949
2025-05-07 17:58:33,315 - INFO - [TRAINING] Batch 80/555 | total_loss: 0.3697
2025-05-07 17:58:37,009 - INFO - [TRAINING] Batch 160/555 | total_loss: 0.3671
2025-05-07 17:58:40,694 - INFO - [TRAINING] Batch 240/555 | total_loss: 0.4034
2025-05-07 17:58:44,374 - INFO - [TRAINING] Batch 320/555 | total_loss: 0.3652
2025-05-07 17:58:48,066 - INFO - [TRAINING] Batch 400/555 | total_loss: 0.2992
2025-05-07 17:58:51,745 - INFO - [TRAINING] Batch 480/555 | total_loss: 0.4014
2025-05-07 17:58:55,144 - INFO - [TRAINING] Epoch 3/3 completed in 25.56s | Train loss: 0.3980
2025-05-07 17:58:55,144 - INFO - [EVAL] Evaluating world model on 5 test videos
2025-05-07 17:58:55,144 - INFO - [EVAL] Video IDs: ['VID02', 'VID06', 'VID111', 'VID14', 'VID23']
2025-05-07 17:59:04,167 - INFO - [EVAL] Video VID02 | State Pred MSE: 0.2281 | Rollout MSE Mean: 1.3759 | Rollout MSE Growth: 2.7612
2025-05-07 17:59:11,063 - INFO - [EVAL] Video VID06 | State Pred MSE: 0.2287 | Rollout MSE Mean: 1.2960 | Rollout MSE Growth: 2.4577
2025-05-07 17:59:17,912 - INFO - [EVAL] Video VID111 | State Pred MSE: 0.2259 | Rollout MSE Mean: 1.4970 | Rollout MSE Growth: 3.4148
2025-05-07 17:59:23,380 - INFO - [EVAL] Video VID14 | State Pred MSE: 0.2536 | Rollout MSE Mean: 1.2325 | Rollout MSE Growth: 2.0893
2025-05-07 17:59:28,674 - INFO - [EVAL] Video VID23 | State Pred MSE: 0.2525 | Rollout MSE Mean: 1.4336 | Rollout MSE Growth: 2.7997
2025-05-07 17:59:28,675 - INFO - [EVAL] Validation | Loss: 1.9617 | State Pred MSE: 0.2377 | Rollout MSE Mean: 1.3670 | Rollout MSE Growth: 2.7045 | Action Pred Accuracy: 0.0000
2025-05-07 17:59:29,364 - INFO - Training completed. Best model saved at logs/2025-05-07_17-56-26/checkpoints/world_model_best_epoch_1.pt
