2025-05-28 10:58:30,732 - INFO - Log file: logs/2025-05-28_10-58-30/dual_world_model.log
2025-05-28 10:58:30,732 - INFO - Starting Dual World Model experiment
2025-05-28 10:58:30,732 - INFO - Using device: cuda
2025-05-28 10:58:30,732 - INFO - Loading CholecT50 data...
2025-05-28 10:58:30,732 - INFO - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-28 10:58:31,205 - INFO - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 10:58:31,205 - INFO - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 10:58:31,207 - INFO - [Train] Found 2 videos in metadata file
2025-05-28 10:58:31,207 - INFO - [Train] Loading data for 2 videos
2025-05-28 10:58:31,353 - INFO - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-28 10:58:31,479 - INFO - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 10:58:31,480 - INFO - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 10:58:31,480 - INFO - [Test] Found 2 videos in metadata file
2025-05-28 10:58:31,480 - INFO - [Test] Loading data for 2 videos
2025-05-28 10:58:33,238 - INFO - Max training videos: 2
2025-05-28 10:58:33,238 - INFO - Max test videos: 2
2025-05-28 10:58:33,238 - INFO - Training samples: 3255
2025-05-28 10:58:33,238 - INFO - Test videos: 2
2025-05-28 10:58:33,238 - INFO - Initializing Dual World Model...
2025-05-28 10:58:33,876 - INFO - Total parameters: 48,924,145
2025-05-28 10:58:33,876 - INFO - Trainable parameters: 48,924,145
2025-05-28 10:58:33,876 - INFO - Training mode: supervised
2025-05-28 10:58:33,876 - INFO - Starting supervised training...
2025-05-28 10:58:33,879 - INFO - Starting supervised training for autoregressive action prediction
2025-05-28 10:58:34,259 - INFO - Batch 0/204 | Loss: 3.3123
2025-05-28 10:58:38,701 - INFO - Batch 100/204 | Loss: 0.5482
2025-05-28 10:58:43,151 - INFO - Batch 200/204 | Loss: 0.3687
2025-05-28 10:58:47,460 - INFO - New best model saved: logs/2025-05-28_10-58-30/checkpoints/supervised_best_epoch_1.pt
2025-05-28 10:58:47,461 - INFO - Epoch 1/2 | Train Loss: 0.7822 | Val Loss: 0.8200 | Val Action Acc: 0.9875
2025-05-28 10:58:47,576 - INFO - Batch 0/204 | Loss: 0.2909
2025-05-28 10:58:52,051 - INFO - Batch 100/204 | Loss: 0.2716
2025-05-28 10:58:56,555 - INFO - Batch 200/204 | Loss: 0.2435
2025-05-28 10:59:00,874 - INFO - New best model saved: logs/2025-05-28_10-58-30/checkpoints/supervised_best_epoch_2.pt
2025-05-28 10:59:00,874 - INFO - Epoch 2/2 | Train Loss: 0.2925 | Val Loss: 0.7301 | Val Action Acc: 0.9876
2025-05-28 10:59:01,432 - INFO - Training plots saved to logs/2025-05-28_10-58-30
2025-05-28 10:59:01,556 - INFO - Training completed. Best model: logs/2025-05-28_10-58-30/checkpoints/supervised_best_epoch_2.pt
2025-05-28 10:59:01,556 - INFO - Final model: logs/2025-05-28_10-58-30/checkpoints/final_model.pt
2025-05-28 10:59:01,557 - INFO - Supervised training completed. Model saved: logs/2025-05-28_10-58-30/checkpoints/supervised_best_epoch_2.pt
2025-05-28 10:59:01,557 - INFO - Starting model evaluation...
2025-05-28 10:59:01,557 - INFO - Evaluating supervised-trained model
2025-05-28 10:59:02,254 - INFO - Starting comprehensive evaluation of both modes
2025-05-28 10:59:02,255 - INFO - Starting supervised mode evaluation (autoregressive action prediction)
2025-05-28 10:59:02,255 - INFO - Evaluating 2 videos with horizons [1, 3, 5, 10, 15] and top-k [1, 3, 5, 10]
2025-05-28 10:59:02,255 - INFO - Evaluating video: VID02 (1/2)
2025-05-28 11:00:23,051 - INFO - Evaluating video: VID06 (2/2)
2025-05-28 11:01:35,592 - INFO - Supervised evaluation completed. Processed 4992 samples from 2 videos.
2025-05-28 11:01:35,593 - INFO - Starting RL mode evaluation (state and reward prediction)
2025-05-28 11:01:35,594 - INFO - Evaluating RL mode on video: VID02
2025-05-28 11:01:38,488 - INFO - Evaluating RL mode on video: VID06
2025-05-28 11:01:40,648 - INFO - RL evaluation completed. Processed 4992 samples from 2 videos.
2025-05-28 11:01:41,721 - INFO - Supervised evaluation results saved to logs/2025-05-28_10-58-30/evaluation_results
2025-05-28 11:01:42,047 - INFO - RL evaluation results saved to logs/2025-05-28_10-58-30/evaluation_results
2025-05-28 11:01:42,413 - INFO - Comparison visualizations saved to logs/2025-05-28_10-58-30/evaluation_results
2025-05-28 11:01:42,414 - INFO - Comprehensive evaluation completed
2025-05-28 11:01:42,414 - INFO - Evaluation completed successfully
2025-05-28 11:01:42,414 - INFO - Action prediction accuracy: 0.3168
2025-05-28 11:01:42,414 - INFO - State prediction MSE: 0.4098
2025-05-28 11:01:42,414 - INFO - RL state prediction MSE: 0.4087
2025-05-28 11:01:42,414 - INFO - Generating summary report...
2025-05-28 11:01:42,414 - INFO - === EXPERIMENT SUMMARY ===
2025-05-28 11:01:42,414 - INFO - ✓ Supervised training completed successfully
2025-05-28 11:01:42,414 - INFO - ⚠ Low action prediction performance, check data quality and model architecture
2025-05-28 11:01:42,414 - INFO - → Rl mode performs better for state prediction
2025-05-28 11:01:42,414 - INFO - Experiment completed! Summary saved to: logs/2025-05-28_10-58-30/experiment_summary.json
