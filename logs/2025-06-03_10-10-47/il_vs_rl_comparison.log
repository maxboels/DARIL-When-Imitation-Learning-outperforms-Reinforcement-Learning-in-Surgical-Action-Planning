2025-06-03 10:10:47,700 - INFO - Log file: logs/2025-06-03_10-10-47/il_vs_rl_comparison.log
2025-06-03 10:10:47,701 - INFO - üöÄ Starting IL vs RL Comparison Experiment
2025-06-03 10:10:47,701 - INFO - Device: cuda
2025-06-03 10:10:47,701 - INFO - Results will be saved to: logs/2025-06-03_10-10-47/comparison_results
2025-06-03 10:10:47,701 - INFO - üìä Loading dataset...
2025-06-03 10:10:47,701 - INFO - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-03 10:10:48,144 - INFO - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 10:10:48,144 - INFO - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 10:10:48,146 - INFO - [Train] Found 2 videos in metadata file
2025-06-03 10:10:48,146 - INFO - [Train] Loading data for 2 videos
2025-06-03 10:10:48,285 - INFO - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-06-03 10:10:48,390 - INFO - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 10:10:48,391 - INFO - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-06-03 10:10:48,391 - INFO - [Test] Found 2 videos in metadata file
2025-06-03 10:10:48,391 - INFO - [Test] Loading data for 2 videos
2025-06-03 10:10:48,582 - INFO - Loaded 2 training videos and 2 test videos
2025-06-03 10:10:48,582 - INFO - üéì Training Imitation Learning Model...
2025-06-03 10:10:48,582 - INFO - Training supervised imitation learning model
2025-06-03 10:10:50,589 - INFO - Model parameters: 48,924,145 total, 48,924,145 trainable
2025-06-03 10:10:50,591 - INFO - Starting supervised training for autoregressive action prediction
2025-06-03 10:10:50,954 - INFO - Batch 0/204 | Loss: 3.3123
2025-06-03 10:10:55,350 - INFO - Batch 100/204 | Loss: 0.5414
2025-06-03 10:10:59,776 - INFO - Batch 200/204 | Loss: 0.3646
2025-06-03 10:12:41,053 - INFO - New best model saved: logs/2025-06-03_10-10-47/checkpoints/supervised_best_epoch_1.pt
2025-06-03 10:12:41,053 - INFO - Epoch 1/1 | Train Loss: 0.7761 | Val Loss: 0.5147 | Val Action Acc: 0.0000
2025-06-03 10:12:41,488 - INFO - Training plots saved to logs/2025-06-03_10-10-47
2025-06-03 10:12:41,594 - INFO - Training completed. Best model: logs/2025-06-03_10-10-47/checkpoints/supervised_best_epoch_1.pt
2025-06-03 10:12:41,594 - INFO - Final model: logs/2025-06-03_10-10-47/checkpoints/final_model.pt
2025-06-03 10:12:41,595 - INFO - ‚úÖ IL training completed. Model saved: logs/2025-06-03_10-10-47/checkpoints/supervised_best_epoch_1.pt
2025-06-03 10:12:41,687 - INFO - ü§ñ Training RL Models...
2025-06-03 10:12:41,770 - INFO - ‚úÖ PPO training completed
2025-06-03 10:12:41,774 - INFO - ‚úÖ DQN training completed
2025-06-03 10:12:41,775 - INFO - üìà Running comprehensive evaluation...
2025-06-03 10:12:41,775 - INFO - üîç Starting comprehensive evaluation...
2025-06-03 10:12:41,775 - INFO - üì• Loading models for evaluation...
2025-06-03 10:12:41,775 - INFO - üì• Loading IL model from: logs/2025-06-03_10-10-47/checkpoints/supervised_best_epoch_1.pt
2025-06-03 10:12:42,524 - INFO - ‚úÖ IL model loaded successfully
2025-06-03 10:12:42,524 - WARNING - ‚ö†Ô∏è No RL models found to load
2025-06-03 10:12:42,524 - WARNING - ‚ö†Ô∏è No RL models available for comparison
2025-06-03 10:12:42,524 - INFO - üì• Loading IL model from: logs/2025-06-03_10-10-47/checkpoints/supervised_best_epoch_1.pt
2025-06-03 10:12:43,176 - INFO - ‚úÖ IL model loaded successfully
2025-06-03 10:12:43,182 - INFO - üîß Evaluation framework using device: cuda
2025-06-03 10:12:43,182 - INFO - üìä Starting Comprehensive Dual Evaluation...
2025-06-03 10:12:43,182 - INFO - üîç Including BOTH traditional and outcome-based metrics
2025-06-03 10:12:43,182 - INFO - üéì Evaluating Imitation Learning...
2025-06-03 10:12:43,386 - ERROR - ‚ùå Comparison experiment failed: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

