2025-04-14 17:45:12,780 - INFO - Log file: logs/2025-04-14_17-45-12/loggings.log
2025-04-14 17:45:12,781 - INFO - Starting CholecT50 experiment for Surgical Actions Prediction
2025-04-14 17:45:12,781 - INFO - Experiment configuration: {'max_videos': 2, 'recognition': {'train': True, 'inference': True, 'best_model_path': './best_checkpoints/best_model_epoch2_map0.5008.pt'}, 'pretrain_next_frame': {'train': False, 'inference': False, 'best_model_path': 'best_model_epoch1_valloss1.190734.pt'}, 'pretrain_reward_model': False, 'calculate_action_rewards': False, 'train_action_policy': False, 'run_tdmpc': False, 'analyze_results': False, 'run_evaluation': False}
2025-04-14 17:45:12,781 - INFO - Using device: cuda
2025-04-14 17:45:12,781 - INFO - Loading CholecT50 data...
2025-04-14 17:45:18,678 - INFO - Starting model training...
2025-04-14 17:45:18,679 - INFO - Clamping pct_start from 1.2255 to 1.0 (warmup_steps=1000, total_steps=816)
2025-04-14 17:45:18,679 - INFO - Initialized OneCycleLR scheduler with pct_start=1.0000, warmup steps: 1000
2025-04-14 17:45:18,878 - INFO - [TRAIN] Epoch 1/4, Batch 0/204, Loss: 1.4355
2025-04-14 17:45:20,054 - INFO - [TRAIN] Epoch 1/4, Batch 80/204, Loss: 1.1627
2025-04-14 17:45:21,243 - INFO - [TRAIN] Epoch 1/4, Batch 160/204, Loss: 0.8836
2025-04-14 17:45:21,920 - INFO - [TRAIN] Epoch 1/4, Train mAP: Instrument (sklearn): 0.3415
2025-04-14 17:45:21,920 - INFO - [TRAIN] Epoch 1/4, Train mAP: Action (sklearn): 0.0786
2025-04-14 17:45:21,920 - INFO - [TRAIN] Epoch 1/4, Train Loss: 1.0864
2025-04-14 17:45:22,296 - INFO - [TRAIN] Epoch 1/4, Train mAP: Instrument (ivt metrics): 0.2320
2025-04-14 17:45:22,296 - INFO - [TRAIN] Epoch 1/4, Train mAP: Action (ivt metrics): 0.0786
2025-04-14 17:45:22,385 - INFO - [VALIDATION] Video VID02 | Batch 0/178
2025-04-14 17:45:22,674 - INFO - [VALIDATION] Video VID02 | Batch 80/178
2025-04-14 17:45:22,977 - INFO - [VALIDATION] Video VID02 | Batch 160/178
2025-04-14 17:45:23,080 - INFO - [VALIDATION] Video VID02: Test mAP (sklearn) Action: 0.1003
2025-04-14 17:45:23,080 - INFO - [VALIDATION] Video VID02: Test mAP (sklearn) Instrument: 0.7730
2025-04-14 17:45:23,164 - INFO - [VALIDATION] Video VID06 | Batch 0/135
2025-04-14 17:45:23,463 - INFO - [VALIDATION] Video VID06 | Batch 80/135
2025-04-14 17:45:23,701 - INFO - [VALIDATION] Video VID06: Test mAP (sklearn) Action: 0.1257
2025-04-14 17:45:23,702 - INFO - [VALIDATION] Video VID06: Test mAP (sklearn) Instrument: 0.6931
2025-04-14 17:45:24,290 - INFO - [VALIDATION] Overall action mAP (sklearn): 0.1130
2025-04-14 17:45:24,290 - INFO - [VALIDATION] Overall instrument mAP (sklearn): 0.7330
2025-04-14 17:45:24,290 - INFO - [VALIDATION] Overall action mAP (ivt): 0.1040
2025-04-14 17:45:24,290 - INFO - [VALIDATION] Overall instrument mAP (ivt): 0.3014
2025-04-14 17:45:24,290 - INFO - [VALIDATION] Epoch 1: mAP Action (sklearn): 0.1130
2025-04-14 17:45:24,290 - INFO - [VALIDATION] Epoch 1: mAP Instrument (sklearn): 0.7330
2025-04-14 17:45:24,290 - INFO - [VALIDATION] Epoch 1: mAP Action (ivt): 0.1040
2025-04-14 17:45:24,290 - INFO - [VALIDATION] Epoch 1: mAP Instrument (ivt): 0.3014
2025-04-14 17:45:24,408 - INFO - Saved new best model with mAP: 0.1040
2025-04-14 17:45:24,424 - INFO - [TRAIN] Epoch 2/4, Batch 0/204, Loss: 0.7449
2025-04-14 17:45:25,606 - INFO - [TRAIN] Epoch 2/4, Batch 80/204, Loss: 0.4639
2025-04-14 17:45:26,824 - INFO - [TRAIN] Epoch 2/4, Batch 160/204, Loss: 0.2272
2025-04-14 17:45:27,501 - INFO - [TRAIN] Epoch 2/4, Train mAP: Instrument (sklearn): 0.8418
2025-04-14 17:45:27,501 - INFO - [TRAIN] Epoch 2/4, Train mAP: Action (sklearn): 0.0917
2025-04-14 17:45:27,501 - INFO - [TRAIN] Epoch 2/4, Train Loss: 0.4149
2025-04-14 17:45:27,890 - INFO - [TRAIN] Epoch 2/4, Train mAP: Instrument (ivt metrics): 0.2636
2025-04-14 17:45:27,890 - INFO - [TRAIN] Epoch 2/4, Train mAP: Action (ivt metrics): 0.0917
2025-04-14 17:45:27,974 - INFO - [VALIDATION] Video VID02 | Batch 0/178
2025-04-14 17:45:28,266 - INFO - [VALIDATION] Video VID02 | Batch 80/178
2025-04-14 17:45:28,585 - INFO - [VALIDATION] Video VID02 | Batch 160/178
2025-04-14 17:45:28,697 - INFO - [VALIDATION] Video VID02: Test mAP (sklearn) Action: 0.1317
2025-04-14 17:45:28,697 - INFO - [VALIDATION] Video VID02: Test mAP (sklearn) Instrument: 0.8651
2025-04-14 17:45:28,773 - INFO - [VALIDATION] Video VID06 | Batch 0/135
2025-04-14 17:45:29,060 - INFO - [VALIDATION] Video VID06 | Batch 80/135
2025-04-14 17:45:29,307 - INFO - [VALIDATION] Video VID06: Test mAP (sklearn) Action: 0.1171
2025-04-14 17:45:29,307 - INFO - [VALIDATION] Video VID06: Test mAP (sklearn) Instrument: 0.8530
2025-04-14 17:45:29,926 - INFO - [VALIDATION] Overall action mAP (sklearn): 0.1244
2025-04-14 17:45:29,926 - INFO - [VALIDATION] Overall instrument mAP (sklearn): 0.8590
2025-04-14 17:45:29,926 - INFO - [VALIDATION] Overall action mAP (ivt): 0.1076
2025-04-14 17:45:29,926 - INFO - [VALIDATION] Overall instrument mAP (ivt): 0.5666
2025-04-14 17:45:29,926 - INFO - [VALIDATION] Epoch 2: mAP Action (sklearn): 0.1244
2025-04-14 17:45:29,926 - INFO - [VALIDATION] Epoch 2: mAP Instrument (sklearn): 0.8590
2025-04-14 17:45:29,926 - INFO - [VALIDATION] Epoch 2: mAP Action (ivt): 0.1076
2025-04-14 17:45:29,926 - INFO - [VALIDATION] Epoch 2: mAP Instrument (ivt): 0.5666
2025-04-14 17:45:30,040 - INFO - Saved new best model with mAP: 0.1076
2025-04-14 17:45:30,057 - INFO - [TRAIN] Epoch 3/4, Batch 0/204, Loss: 0.1886
2025-04-14 17:45:31,241 - INFO - [TRAIN] Epoch 3/4, Batch 80/204, Loss: 0.0865
2025-04-14 17:45:32,468 - INFO - [TRAIN] Epoch 3/4, Batch 160/204, Loss: 0.1281
2025-04-14 17:45:33,152 - INFO - [TRAIN] Epoch 3/4, Train mAP: Instrument (sklearn): 0.9706
2025-04-14 17:45:33,152 - INFO - [TRAIN] Epoch 3/4, Train mAP: Action (sklearn): 0.2733
2025-04-14 17:45:33,152 - INFO - [TRAIN] Epoch 3/4, Train Loss: 0.1146
2025-04-14 17:45:33,542 - INFO - [TRAIN] Epoch 3/4, Train mAP: Instrument (ivt metrics): 0.6946
2025-04-14 17:45:33,543 - INFO - [TRAIN] Epoch 3/4, Train mAP: Action (ivt metrics): 0.2733
2025-04-14 17:45:33,621 - INFO - [VALIDATION] Video VID02 | Batch 0/178
2025-04-14 17:45:33,925 - INFO - [VALIDATION] Video VID02 | Batch 80/178
2025-04-14 17:45:34,235 - INFO - [VALIDATION] Video VID02 | Batch 160/178
2025-04-14 17:45:34,348 - INFO - [VALIDATION] Video VID02: Test mAP (sklearn) Action: 0.1577
2025-04-14 17:45:34,348 - INFO - [VALIDATION] Video VID02: Test mAP (sklearn) Instrument: 0.8925
2025-04-14 17:45:34,433 - INFO - [VALIDATION] Video VID06 | Batch 0/135
2025-04-14 17:45:34,728 - INFO - [VALIDATION] Video VID06 | Batch 80/135
2025-04-14 17:45:34,972 - INFO - [VALIDATION] Video VID06: Test mAP (sklearn) Action: 0.1599
2025-04-14 17:45:34,973 - INFO - [VALIDATION] Video VID06: Test mAP (sklearn) Instrument: 0.9266
2025-04-14 17:45:35,568 - INFO - [VALIDATION] Overall action mAP (sklearn): 0.1588
2025-04-14 17:45:35,568 - INFO - [VALIDATION] Overall instrument mAP (sklearn): 0.9095
2025-04-14 17:45:35,568 - INFO - [VALIDATION] Overall action mAP (ivt): 0.1349
2025-04-14 17:45:35,568 - INFO - [VALIDATION] Overall instrument mAP (ivt): 0.7771
2025-04-14 17:45:35,568 - INFO - [VALIDATION] Epoch 3: mAP Action (sklearn): 0.1588
2025-04-14 17:45:35,568 - INFO - [VALIDATION] Epoch 3: mAP Instrument (sklearn): 0.9095
2025-04-14 17:45:35,568 - INFO - [VALIDATION] Epoch 3: mAP Action (ivt): 0.1349
2025-04-14 17:45:35,568 - INFO - [VALIDATION] Epoch 3: mAP Instrument (ivt): 0.7771
2025-04-14 17:45:35,678 - INFO - Saved new best model with mAP: 0.1349
2025-04-14 17:45:35,693 - INFO - [TRAIN] Epoch 4/4, Batch 0/204, Loss: 0.0858
2025-04-14 17:45:36,884 - INFO - [TRAIN] Epoch 4/4, Batch 80/204, Loss: 0.0934
2025-04-14 17:45:38,087 - INFO - [TRAIN] Epoch 4/4, Batch 160/204, Loss: 0.1282
