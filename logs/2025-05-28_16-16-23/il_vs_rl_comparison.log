2025-05-28 16:16:23,640 - INFO - Log file: logs/2025-05-28_16-16-23/il_vs_rl_comparison.log
2025-05-28 16:16:23,640 - INFO - üöÄ Starting IL vs RL Comparison Experiment
2025-05-28 16:16:23,640 - INFO - Device: cuda
2025-05-28 16:16:23,641 - INFO - Results will be saved to: logs/2025-05-28_16-16-23/comparison_results
2025-05-28 16:16:23,641 - INFO - üìä Loading dataset...
2025-05-28 16:16:23,641 - INFO - Loading train data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-28 16:16:24,027 - INFO - [Train] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 16:16:24,027 - INFO - [Train] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_train_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 16:16:24,028 - INFO - [Train] Found 1 videos in metadata file
2025-05-28 16:16:24,028 - INFO - [Train] Loading data for 1 videos
2025-05-28 16:16:24,102 - INFO - Loading test data from /home/maxboels/datasets/CholecT50 with fold 0
2025-05-28 16:16:24,187 - INFO - [Test] Start processing metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 16:16:24,187 - INFO - [Test] Rewards extraction skipped, using metadata file /home/maxboels/datasets/CholecT50/embeddings_test_set/fold0/embeddings_f0_swin_bas_129_phase_complet_phase_transit_prog_prob_action_risk_glob_outcome.csv
2025-05-28 16:16:24,188 - INFO - [Test] Found 1 videos in metadata file
2025-05-28 16:16:24,188 - INFO - [Test] Loading data for 1 videos
2025-05-28 16:16:24,293 - INFO - Loaded 1 training videos and 1 test videos
2025-05-28 16:16:24,293 - INFO - üéì Training Imitation Learning Model...
2025-05-28 16:16:24,293 - INFO - Training supervised imitation learning model
2025-05-28 16:16:25,662 - INFO - Model parameters: 48,924,145 total, 48,924,145 trainable
2025-05-28 16:16:25,664 - INFO - Starting supervised training for autoregressive action prediction
2025-05-28 16:16:26,057 - INFO - Batch 0/109 | Loss: 3.3153
2025-05-28 16:16:30,443 - INFO - Batch 100/109 | Loss: 0.5771
2025-05-28 16:17:27,139 - INFO - New best model saved: logs/2025-05-28_16-16-23/checkpoints/supervised_best_epoch_1.pt
2025-05-28 16:17:27,139 - INFO - Epoch 1/2 | Train Loss: 1.0436 | Val Loss: 0.5192 | Val Action Acc: 0.0000
2025-05-28 16:17:27,308 - INFO - Batch 0/109 | Loss: 0.5085
2025-05-28 16:17:31,715 - INFO - Batch 100/109 | Loss: 0.3063
2025-05-28 16:18:28,608 - INFO - New best model saved: logs/2025-05-28_16-16-23/checkpoints/supervised_best_epoch_2.pt
2025-05-28 16:18:28,608 - INFO - Epoch 2/2 | Train Loss: 0.3539 | Val Loss: 0.4213 | Val Action Acc: 0.0000
2025-05-28 16:18:29,069 - INFO - Training plots saved to logs/2025-05-28_16-16-23
2025-05-28 16:18:29,196 - INFO - Training completed. Best model: logs/2025-05-28_16-16-23/checkpoints/supervised_best_epoch_2.pt
2025-05-28 16:18:29,196 - INFO - Final model: logs/2025-05-28_16-16-23/checkpoints/final_model.pt
2025-05-28 16:18:29,197 - INFO - ‚úÖ IL training completed. Model saved: logs/2025-05-28_16-16-23/checkpoints/supervised_best_epoch_2.pt
2025-05-28 16:18:29,255 - INFO - ü§ñ Training RL Models...
2025-05-28 16:18:29,897 - INFO - Loaded world model for RL training: logs/2025-05-28_16-16-23/checkpoints/supervised_best_epoch_2.pt
2025-05-28 16:18:29,897 - INFO - üî• Training PPO agent...
2025-05-28 16:18:29,917 - ERROR - ‚ùå PPO training failed: a Tensor with 20 elements cannot be converted to Scalar
2025-05-28 16:18:29,917 - INFO - üî• Training SAC agent...
2025-05-28 16:18:29,932 - ERROR - ‚ùå SAC training failed: a Tensor with 20 elements cannot be converted to Scalar
2025-05-28 16:18:29,933 - INFO - üìà Running comprehensive evaluation...
2025-05-28 16:18:29,933 - INFO - üìä Evaluating Imitation Learning model...
2025-05-28 16:18:31,019 - INFO - Starting comprehensive evaluation of both modes
2025-05-28 16:18:31,019 - INFO - Starting supervised mode evaluation (autoregressive action prediction)
2025-05-28 16:18:31,019 - INFO - Evaluating 1 videos with horizons [1, 3, 5, 10, 15] and top-k [1, 3, 5, 10]
2025-05-28 16:18:31,019 - INFO - Evaluating video: VID02 (1/1)
