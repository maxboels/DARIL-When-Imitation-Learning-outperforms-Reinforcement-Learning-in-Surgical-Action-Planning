2025-04-23 16:37:33,888 - INFO - Log file: logs/2025-04-23_16-37-33/loggings.log
2025-04-23 16:37:33,888 - INFO - Starting CholecT50 experiment for Surgical Actions Prediction
2025-04-23 16:37:33,888 - INFO - Experiment configuration: {'max_videos': 10, 'recognition': {'train': False, 'inference': False, 'best_model_path': './best_checkpoints/best_model_epoch2_map0.5008.pt'}, 'pretrain_world_model': {'train': True, 'inference': False, 'best_model_path': None}, 'pretrain_reward_model': False, 'calculate_action_rewards': False, 'train_action_policy': False, 'run_tdmpc': False, 'analyze_results': False, 'run_evaluation': False}
2025-04-23 16:37:33,888 - INFO - Using device: cuda
2025-04-23 16:37:33,888 - INFO - Loading CholecT50 data...
2025-04-23 16:37:43,908 - INFO - [TRAINING] Starting world model training for 3 epochs
2025-04-23 16:37:44,104 - INFO - [TRAINING] Batch 0/1087 | _z_loss: 1.6870
2025-04-23 16:37:44,105 - INFO - [TRAINING] Batch 0/1087 | loss: 1.6870
2025-04-23 16:37:47,599 - INFO - [TRAINING] Batch 80/1087 | _z_loss: 1.1067
2025-04-23 16:37:47,600 - INFO - [TRAINING] Batch 80/1087 | loss: 1.1067
2025-04-23 16:37:51,099 - INFO - [TRAINING] Batch 160/1087 | _z_loss: 0.7510
2025-04-23 16:37:51,099 - INFO - [TRAINING] Batch 160/1087 | loss: 0.7510
2025-04-23 16:37:54,616 - INFO - [TRAINING] Batch 240/1087 | _z_loss: 0.5367
2025-04-23 16:37:54,616 - INFO - [TRAINING] Batch 240/1087 | loss: 0.5367
2025-04-23 16:37:58,136 - INFO - [TRAINING] Batch 320/1087 | _z_loss: 0.4367
2025-04-23 16:37:58,136 - INFO - [TRAINING] Batch 320/1087 | loss: 0.4367
2025-04-23 16:38:01,675 - INFO - [TRAINING] Batch 400/1087 | _z_loss: 0.3304
2025-04-23 16:38:01,675 - INFO - [TRAINING] Batch 400/1087 | loss: 0.3304
2025-04-23 16:38:05,222 - INFO - [TRAINING] Batch 480/1087 | _z_loss: 0.3060
2025-04-23 16:38:05,222 - INFO - [TRAINING] Batch 480/1087 | loss: 0.3060
2025-04-23 16:38:08,773 - INFO - [TRAINING] Batch 560/1087 | _z_loss: 0.2056
2025-04-23 16:38:08,773 - INFO - [TRAINING] Batch 560/1087 | loss: 0.2056
2025-04-23 16:38:12,333 - INFO - [TRAINING] Batch 640/1087 | _z_loss: 0.2142
2025-04-23 16:38:12,333 - INFO - [TRAINING] Batch 640/1087 | loss: 0.2142
2025-04-23 16:38:15,890 - INFO - [TRAINING] Batch 720/1087 | _z_loss: 0.1979
2025-04-23 16:38:15,890 - INFO - [TRAINING] Batch 720/1087 | loss: 0.1979
2025-04-23 16:38:19,444 - INFO - [TRAINING] Batch 800/1087 | _z_loss: 0.1926
2025-04-23 16:38:19,444 - INFO - [TRAINING] Batch 800/1087 | loss: 0.1926
2025-04-23 16:38:22,998 - INFO - [TRAINING] Batch 880/1087 | _z_loss: 0.1567
2025-04-23 16:38:22,998 - INFO - [TRAINING] Batch 880/1087 | loss: 0.1567
2025-04-23 16:38:26,570 - INFO - [TRAINING] Batch 960/1087 | _z_loss: 0.1423
2025-04-23 16:38:26,570 - INFO - [TRAINING] Batch 960/1087 | loss: 0.1423
2025-04-23 16:38:30,150 - INFO - [TRAINING] Batch 1040/1087 | _z_loss: 0.1267
2025-04-23 16:38:30,150 - INFO - [TRAINING] Batch 1040/1087 | loss: 0.1267
2025-04-23 16:38:32,201 - INFO - [TRAINING] Epoch 1/3 completed in 48.29s | Train loss: 0.4321
2025-04-23 16:38:32,202 - INFO - [EVAL] Evaluating world model on 10 test videos
2025-04-23 16:38:32,202 - INFO - [EVAL] Video IDs: ['VID02', 'VID06', 'VID111', 'VID14', 'VID23', 'VID25', 'VID50', 'VID51', 'VID66', 'VID79']
2025-04-23 16:38:46,056 - INFO - [EVAL] Video VID02 | State Pred Error: 0.1898 | Rollout Error Mean: 1.3773 | Rollout Error Growth: 3.1040
2025-04-23 16:38:56,575 - INFO - [EVAL] Video VID06 | State Pred Error: 0.2034 | Rollout Error Mean: 1.2938 | Rollout Error Growth: 2.4821
2025-04-23 16:39:07,072 - INFO - [EVAL] Video VID111 | State Pred Error: 0.1701 | Rollout Error Mean: 1.4858 | Rollout Error Growth: 3.4474
2025-04-23 16:39:15,408 - INFO - [EVAL] Video VID14 | State Pred Error: 0.2097 | Rollout Error Mean: 1.3196 | Rollout Error Growth: 2.2724
2025-04-23 16:39:23,446 - INFO - [EVAL] Video VID23 | State Pred Error: 0.2175 | Rollout Error Mean: 1.3806 | Rollout Error Growth: 2.6703
2025-04-23 16:39:33,867 - INFO - [EVAL] Video VID25 | State Pred Error: 0.1906 | Rollout Error Mean: 1.4476 | Rollout Error Growth: 3.0695
2025-04-23 16:39:39,275 - INFO - [EVAL] Video VID50 | State Pred Error: 0.1794 | Rollout Error Mean: 1.3885 | Rollout Error Growth: 2.0962
2025-04-23 16:39:53,565 - INFO - [EVAL] Video VID51 | State Pred Error: 0.1848 | Rollout Error Mean: 1.1198 | Rollout Error Growth: 2.0841
2025-04-23 16:40:02,492 - INFO - [EVAL] Video VID66 | State Pred Error: 0.1961 | Rollout Error Mean: 1.1482 | Rollout Error Growth: 1.8704
2025-04-23 16:40:19,147 - INFO - [EVAL] Video VID79 | State Pred Error: 0.2091 | Rollout Error Mean: 1.3719 | Rollout Error Growth: 2.5355
2025-04-23 16:40:19,147 - INFO - [EVAL] Validation | Loss: 0.1950 | State Pred Error: 0.1950 | Rollout Error Mean: 1.3333 | Rollout Error Growth: 2.5632 | Action Pred Accuracy: 0.0000
2025-04-23 16:40:19,279 - INFO - New best model saved at logs/2025-04-23_16-37-33/world_model_best_epoch_1.pt
2025-04-23 16:40:19,432 - INFO - [TRAINING] Batch 0/1087 | _z_loss: 0.1650
2025-04-23 16:40:19,432 - INFO - [TRAINING] Batch 0/1087 | loss: 0.1650
2025-04-23 16:40:23,033 - INFO - [TRAINING] Batch 80/1087 | _z_loss: 0.1326
2025-04-23 16:40:23,033 - INFO - [TRAINING] Batch 80/1087 | loss: 0.1326
2025-04-23 16:40:26,625 - INFO - [TRAINING] Batch 160/1087 | _z_loss: 0.1051
2025-04-23 16:40:26,625 - INFO - [TRAINING] Batch 160/1087 | loss: 0.1051
2025-04-23 16:40:30,227 - INFO - [TRAINING] Batch 240/1087 | _z_loss: 0.1358
2025-04-23 16:40:30,227 - INFO - [TRAINING] Batch 240/1087 | loss: 0.1358
2025-04-23 16:40:33,801 - INFO - [TRAINING] Batch 320/1087 | _z_loss: 0.1272
2025-04-23 16:40:33,802 - INFO - [TRAINING] Batch 320/1087 | loss: 0.1272
2025-04-23 16:40:37,395 - INFO - [TRAINING] Batch 400/1087 | _z_loss: 0.1073
2025-04-23 16:40:37,395 - INFO - [TRAINING] Batch 400/1087 | loss: 0.1073
2025-04-23 16:40:41,012 - INFO - [TRAINING] Batch 480/1087 | _z_loss: 0.1124
2025-04-23 16:40:41,012 - INFO - [TRAINING] Batch 480/1087 | loss: 0.1124
2025-04-23 16:40:44,590 - INFO - [TRAINING] Batch 560/1087 | _z_loss: 0.1266
2025-04-23 16:40:44,590 - INFO - [TRAINING] Batch 560/1087 | loss: 0.1266
2025-04-23 16:40:48,177 - INFO - [TRAINING] Batch 640/1087 | _z_loss: 0.1099
2025-04-23 16:40:48,177 - INFO - [TRAINING] Batch 640/1087 | loss: 0.1099
2025-04-23 16:40:51,755 - INFO - [TRAINING] Batch 720/1087 | _z_loss: 0.1026
2025-04-23 16:40:51,756 - INFO - [TRAINING] Batch 720/1087 | loss: 0.1026
2025-04-23 16:40:55,334 - INFO - [TRAINING] Batch 800/1087 | _z_loss: 0.1065
2025-04-23 16:40:55,335 - INFO - [TRAINING] Batch 800/1087 | loss: 0.1065
2025-04-23 16:40:58,927 - INFO - [TRAINING] Batch 880/1087 | _z_loss: 0.1230
2025-04-23 16:40:58,927 - INFO - [TRAINING] Batch 880/1087 | loss: 0.1230
2025-04-23 16:41:02,519 - INFO - [TRAINING] Batch 960/1087 | _z_loss: 0.0890
2025-04-23 16:41:02,520 - INFO - [TRAINING] Batch 960/1087 | loss: 0.0890
2025-04-23 16:41:06,107 - INFO - [TRAINING] Batch 1040/1087 | _z_loss: 0.1118
2025-04-23 16:41:06,107 - INFO - [TRAINING] Batch 1040/1087 | loss: 0.1118
2025-04-23 16:41:08,176 - INFO - [TRAINING] Epoch 2/3 completed in 48.79s | Train loss: 0.1152
2025-04-23 16:41:08,177 - INFO - [EVAL] Evaluating world model on 10 test videos
2025-04-23 16:41:08,177 - INFO - [EVAL] Video IDs: ['VID02', 'VID06', 'VID111', 'VID14', 'VID23', 'VID25', 'VID50', 'VID51', 'VID66', 'VID79']
2025-04-23 16:41:22,044 - INFO - [EVAL] Video VID02 | State Pred Error: 0.1729 | Rollout Error Mean: 1.3803 | Rollout Error Growth: 3.8370
2025-04-23 16:41:32,714 - INFO - [EVAL] Video VID06 | State Pred Error: 0.1854 | Rollout Error Mean: 1.4392 | Rollout Error Growth: 2.9978
2025-04-23 16:41:43,269 - INFO - [EVAL] Video VID111 | State Pred Error: 0.1492 | Rollout Error Mean: 1.4429 | Rollout Error Growth: 3.8898
2025-04-23 16:41:51,826 - INFO - [EVAL] Video VID14 | State Pred Error: 0.1882 | Rollout Error Mean: 1.4993 | Rollout Error Growth: 2.4465
2025-04-23 16:41:59,936 - INFO - [EVAL] Video VID23 | State Pred Error: 0.1924 | Rollout Error Mean: 1.4538 | Rollout Error Growth: 3.7391
2025-04-23 16:42:10,368 - INFO - [EVAL] Video VID25 | State Pred Error: 0.1722 | Rollout Error Mean: 1.4212 | Rollout Error Growth: 3.9559
2025-04-23 16:42:15,959 - INFO - [EVAL] Video VID50 | State Pred Error: 0.1590 | Rollout Error Mean: 1.4609 | Rollout Error Growth: 2.6521
2025-04-23 16:42:30,248 - INFO - [EVAL] Video VID51 | State Pred Error: 0.1647 | Rollout Error Mean: 1.3670 | Rollout Error Growth: 2.6220
2025-04-23 16:42:39,123 - INFO - [EVAL] Video VID66 | State Pred Error: 0.1746 | Rollout Error Mean: 1.6661 | Rollout Error Growth: 2.7108
2025-04-23 16:42:55,635 - INFO - [EVAL] Video VID79 | State Pred Error: 0.1851 | Rollout Error Mean: 1.5749 | Rollout Error Growth: 3.2825
2025-04-23 16:42:55,636 - INFO - [EVAL] Validation | Loss: 0.1744 | State Pred Error: 0.1744 | Rollout Error Mean: 1.4706 | Rollout Error Growth: 3.2134 | Action Pred Accuracy: 0.0000
2025-04-23 16:42:55,750 - INFO - New best model saved at logs/2025-04-23_16-37-33/world_model_best_epoch_2.pt
2025-04-23 16:42:55,934 - INFO - [TRAINING] Batch 0/1087 | _z_loss: 0.0856
2025-04-23 16:42:55,934 - INFO - [TRAINING] Batch 0/1087 | loss: 0.0856
2025-04-23 16:42:59,511 - INFO - [TRAINING] Batch 80/1087 | _z_loss: 0.0995
2025-04-23 16:42:59,511 - INFO - [TRAINING] Batch 80/1087 | loss: 0.0995
2025-04-23 16:43:03,075 - INFO - [TRAINING] Batch 160/1087 | _z_loss: 0.0863
2025-04-23 16:43:03,076 - INFO - [TRAINING] Batch 160/1087 | loss: 0.0863
2025-04-23 16:43:06,643 - INFO - [TRAINING] Batch 240/1087 | _z_loss: 0.0981
2025-04-23 16:43:06,644 - INFO - [TRAINING] Batch 240/1087 | loss: 0.0981
2025-04-23 16:43:10,214 - INFO - [TRAINING] Batch 320/1087 | _z_loss: 0.0947
2025-04-23 16:43:10,214 - INFO - [TRAINING] Batch 320/1087 | loss: 0.0947
2025-04-23 16:43:13,779 - INFO - [TRAINING] Batch 400/1087 | _z_loss: 0.0828
2025-04-23 16:43:13,779 - INFO - [TRAINING] Batch 400/1087 | loss: 0.0828
2025-04-23 16:43:17,350 - INFO - [TRAINING] Batch 480/1087 | _z_loss: 0.0904
2025-04-23 16:43:17,351 - INFO - [TRAINING] Batch 480/1087 | loss: 0.0904
2025-04-23 16:43:20,912 - INFO - [TRAINING] Batch 560/1087 | _z_loss: 0.0952
2025-04-23 16:43:20,913 - INFO - [TRAINING] Batch 560/1087 | loss: 0.0952
2025-04-23 16:43:24,483 - INFO - [TRAINING] Batch 640/1087 | _z_loss: 0.0980
2025-04-23 16:43:24,484 - INFO - [TRAINING] Batch 640/1087 | loss: 0.0980
2025-04-23 16:43:28,049 - INFO - [TRAINING] Batch 720/1087 | _z_loss: 0.0859
2025-04-23 16:43:28,049 - INFO - [TRAINING] Batch 720/1087 | loss: 0.0859
2025-04-23 16:43:31,626 - INFO - [TRAINING] Batch 800/1087 | _z_loss: 0.0881
2025-04-23 16:43:31,627 - INFO - [TRAINING] Batch 800/1087 | loss: 0.0881
2025-04-23 16:43:35,195 - INFO - [TRAINING] Batch 880/1087 | _z_loss: 0.0918
2025-04-23 16:43:35,195 - INFO - [TRAINING] Batch 880/1087 | loss: 0.0918
2025-04-23 16:43:38,765 - INFO - [TRAINING] Batch 960/1087 | _z_loss: 0.0645
2025-04-23 16:43:38,766 - INFO - [TRAINING] Batch 960/1087 | loss: 0.0645
2025-04-23 16:43:42,340 - INFO - [TRAINING] Batch 1040/1087 | _z_loss: 0.0838
2025-04-23 16:43:42,340 - INFO - [TRAINING] Batch 1040/1087 | loss: 0.0838
2025-04-23 16:43:44,395 - INFO - [TRAINING] Epoch 3/3 completed in 48.50s | Train loss: 0.0958
2025-04-23 16:43:44,395 - INFO - [EVAL] Evaluating world model on 10 test videos
2025-04-23 16:43:44,395 - INFO - [EVAL] Video IDs: ['VID02', 'VID06', 'VID111', 'VID14', 'VID23', 'VID25', 'VID50', 'VID51', 'VID66', 'VID79']
2025-04-23 16:43:58,161 - INFO - [EVAL] Video VID02 | State Pred Error: 0.1741 | Rollout Error Mean: 1.3539 | Rollout Error Growth: 3.6539
2025-04-23 16:44:08,611 - INFO - [EVAL] Video VID06 | State Pred Error: 0.1874 | Rollout Error Mean: 1.3660 | Rollout Error Growth: 2.9378
2025-04-23 16:44:19,065 - INFO - [EVAL] Video VID111 | State Pred Error: 0.1485 | Rollout Error Mean: 1.6649 | Rollout Error Growth: 4.4580
2025-04-23 16:44:27,363 - INFO - [EVAL] Video VID14 | State Pred Error: 0.1885 | Rollout Error Mean: 1.6512 | Rollout Error Growth: 2.5744
2025-04-23 16:44:35,384 - INFO - [EVAL] Video VID23 | State Pred Error: 0.1910 | Rollout Error Mean: 1.5488 | Rollout Error Growth: 4.2806
2025-04-23 16:44:45,726 - INFO - [EVAL] Video VID25 | State Pred Error: 0.1775 | Rollout Error Mean: 1.7947 | Rollout Error Growth: 4.7224
2025-04-23 16:44:51,138 - INFO - [EVAL] Video VID50 | State Pred Error: 0.1571 | Rollout Error Mean: 1.6057 | Rollout Error Growth: 2.8567
2025-04-23 16:45:05,425 - INFO - [EVAL] Video VID51 | State Pred Error: 0.1687 | Rollout Error Mean: 1.4949 | Rollout Error Growth: 2.5512
2025-04-23 16:45:14,266 - INFO - [EVAL] Video VID66 | State Pred Error: 0.1725 | Rollout Error Mean: 1.7320 | Rollout Error Growth: 2.6945
2025-04-23 16:45:30,770 - INFO - [EVAL] Video VID79 | State Pred Error: 0.1860 | Rollout Error Mean: 1.4944 | Rollout Error Growth: 3.1863
2025-04-23 16:45:30,770 - INFO - [EVAL] Validation | Loss: 0.1751 | State Pred Error: 0.1751 | Rollout Error Mean: 1.5706 | Rollout Error Growth: 3.3916 | Action Pred Accuracy: 0.0000
2025-04-23 16:45:31,451 - INFO - Training completed. Best model saved at logs/2025-04-23_16-37-33/world_model_best_epoch_2.pt
